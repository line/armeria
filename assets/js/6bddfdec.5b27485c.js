"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[6041],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(96540);const r={},t=i.createContext(r);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:n},e.children)}},41722:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"0.90.0","title":"v0.90.0","description":"New features","source":"@site/src/content/release-notes/0.90.0.mdx","sourceDirName":".","slug":"/0.90.0","permalink":"/release-notes/0.90.0","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site-new/src/content/release-notes/0.90.0.mdx","tags":[],"version":"current","frontMatter":{"date":"2019-08-12T00:00:00.000Z"},"sidebar":"defaultSidebar","previous":{"title":"v0.90.1","permalink":"/release-notes/0.90.1"},"next":{"title":"v0.89.1","permalink":"/release-notes/0.89.1"}}');var r=s(74848),t=s(28453);const a={date:new Date("2019-08-12T00:00:00.000Z")},l="v0.90.0",c={},o=[{value:"New features",id:"new-features",level:2},{value:"Bug fixes",id:"bug-fixes",level:2},{value:"Deprecations",id:"deprecations",level:2},{value:"Breaking changes",id:"breaking-changes",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Thank you",id:"thank-you",level:2}];function h(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components},{ThankYou:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ThankYou",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.header,{children:[(0,r.jsx)(n.h1,{id:"v0900",children:"v0.90.0"}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:"August 12, 2019"})})]}),"\n",(0,r.jsx)(n.h2,{id:"new-features",children:"New features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["You can now send an HTTP request to an absolute URI, which means you don't need to create different ",(0,r.jsx)(n.code,{children:"HttpClient"}),"s for different hosts. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1143",children:"#1143"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1343",children:"#1343"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1961",children:"#1961"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'HttpClient client = HttpClient.of(); // No base URI specified.\nclient.get("http://foo.com").aggregate().join();\nclient.execute(RequestHeaders.of(HttpMethod.GET, "http://bar.com")).aggregate().join();\n\nHttpClient client = HttpClient.of("http://baz.com"); // Base URI specified.\nclient.get("/index.html").aggregate().join();\nclient.get("http://qux.com").aggregate().join(); // Can override the base URI.\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"HealthCheckedEndpointGroup"})," has been revamped and now supports long-polling when used with Armeria's ",(0,r.jsx)(n.code,{children:"HealthCheckService"}),". ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1948",children:"#1948"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1977",children:"#1977"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1982",children:"#1982"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Long-polling support enables ",(0,r.jsx)(n.code,{children:"HealthCheckedEndpointGroup"})," to detect the server health changes immediately with much fewer number of health check requests."]}),"\n",(0,r.jsxs)(n.li,{children:["Long-polling support is auto-detected based on a special HTTP header ",(0,r.jsx)(n.code,{children:"armeria-lphc"}),", so it is fully backward-compatible with ordinary non-Armeria health check services."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'EndpointGroup group =\n    HealthCheckedEndpointGroup.of(\n        new StaticEndpointGroup(Endpoint.of("foo.com", 8080),\n                                Endpoint.of("bar.com", 8080)),\n        "/internal/l7check");\nEndpointGroupRegistry.register("myGroup", group,\n                               EndpointSelectionStrategy.WEIGHTED_ROUND_ROBIN);\nHttpClient client = HttpClient.of("http://group:myGroup");\nclient.get("/").aggregate().join();\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["You can now send a delayed response easily using ",(0,r.jsx)(n.code,{children:"HttpResponse.delayed()"}),", which may be useful when simulating a slow server. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1935",children:"#1935"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'Server server = new ServerBuilder()\n    .service("/delayed", (ctx, req) -> HttpResponse.delayed(HttpResponse.of(200),\n                                                            Duration.ofSeconds(3)))\n    .build();\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["You can now write a mock HTTP server using ",(0,r.jsx)(n.code,{children:"MockWebServerExtension"})," and JUnit 5. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1884",children:"#1884"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1935",children:"#1935"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'class MyTest {\n    @RegisterExtension\n    static MockWebServerExtension server = new MockWebServerExtension();\n\n    @Test\n    void test() {\n        server.enqueue(HttpResponse.of(200));\n        HttpResponse actualRes = HttpClient.of(server.httpUri("/")).get("/");\n        assertThat(actualRes.aggregate().join().status().code()).isEqualTo(200);\n    }\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AsyncCloseable"})," has been added to provide an asynchronous close operation. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1948",children:"#1948"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class IAmCloseable implements AutoCloseable, AsyncCloseable {\n    @Override\n    public CompletableFuture<?> closeAsync() {\n        ...\n    }\n\n    @Override\n    public void close() {\n        closeAsync().join();\n    }\n}\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["You can now specify an ",(0,r.jsx)(n.code,{children:"EventExecutor"})," when using ",(0,r.jsx)(n.code,{children:"HttpResponse.from()"}),". ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1937",children:"#1937"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["You can now suppress the false warnings from ",(0,r.jsx)(n.code,{children:"RequestContextCurrentTraceContext"})," by using ",(0,r.jsx)(n.code,{children:"setCurrentThreadNotRequestThread()"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1971",children:"#1971"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1980",children:"#1980"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["For example, you could prevent warnings from the administrative threads controlled by ",(0,r.jsx)(n.code,{children:"ThreadFactory"})," like the following:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"ThreadFactory factory = (runnable) -> new Thread(new Runnable() {\n    @Override\n    public void run() {\n        RequestContextCurrentTraceContext.setCurrentThreadNotRequestThread(true);\n        runnable.run();\n    }\n\n    @Override\n    public String toString() {\n        return runnable.toString();\n    }\n});\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n","\n",(0,r.jsx)(n.h2,{id:"bug-fixes",children:"Bug fixes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RequestLog.responseCause()"})," is now recorded correctly for client requests. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1977",children:"#1977"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RetryingClient"})," now respects the ",(0,r.jsx)(n.code,{children:"Endpoint"})," selection order, which was broken since 0.89.0. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1973",children:"#1973"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1974",children:"#1974"})]}),"\n",(0,r.jsxs)(n.li,{children:["The health checked requests sent by ",(0,r.jsx)(n.code,{children:"HealthCheckedEndpointGroup"})," are now sent at the correct interval, even if an endpoint is not responsive. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1948",children:"#1948"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ClosedPublisherException"})," is not raised anymore when ",(0,r.jsx)(n.code,{children:"HttpResponse"})," is aborted by the client who issued the request. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1962",children:"#1962"})]}),"\n",(0,r.jsxs)(n.li,{children:["Armeria gRPC client now sends the ",(0,r.jsx)(n.code,{children:"TE"})," header, whose absence caused interoperability issues with some gRPC servers, such as Python gRPC server. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1963",children:"#1963"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1965",children:"#1965"})]}),"\n",(0,r.jsxs)(n.li,{children:["Armeria HTTP client does not send more than two ",(0,r.jsx)(n.code,{children:"Host"})," headers for HTTP/1 anymore. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1942",children:"#1942"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"HealthCheckedEndpointGroup"})," now waits until the initial ",(0,r.jsx)(n.code,{children:"Endpoint"}),"s are available from its delegate group. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1940",children:"#1940"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"deprecations",children:"Deprecations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"HealthCheckedEndpointGroupBuilder.retryInterval()"})," has been un-deprecated. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1948",children:"#1948"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"HealthCheckedEndpointGroupBuilder.healthCheckPort()"})," has been deprecated in favor of ",(0,r.jsx)(n.code,{children:"port()"}),". ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1948",children:"#1948"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"CircuitBreakerBuilder.circuitBreakerMapping()"})," has been deprecated in favor of ",(0,r.jsx)(n.code,{children:"mapping()"}),". ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1970",children:"#1970"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"breaking-changes",children:"Breaking changes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"HttpHealthCheckedEndpointGroup"})," has been renamed to ",(0,r.jsx)(n.code,{children:"HealthCheckedEndpointGroup"}),".","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The old ",(0,r.jsx)(n.code,{children:"HealthCheckedEndpointGroup"})," has been renamed to ",(0,r.jsx)(n.code,{children:"AbstractHealthCheckedEndpointGroup"}),", and is now extensible enough for you to implement your own health-checking mechanism, such as sending a gRPC/Thrift call."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Caffeine 2.7.0 -> 2.8.0"}),"\n",(0,r.jsx)(n.li,{children:"fastutil 8.2.3 -> 8.3.0"}),"\n",(0,r.jsx)(n.li,{children:"Project Reactor 3.2.10 -> 3.2.11"}),"\n",(0,r.jsx)(n.li,{children:"Retrofit 2.6.0 -> 2.6.1"}),"\n",(0,r.jsx)(n.li,{children:"RxJava 2.2.10 -> 2.2.11"}),"\n",(0,r.jsx)(n.li,{children:"SLF4J 1.7.26 -> 1.7.27"}),"\n",(0,r.jsx)(n.li,{children:"Spring Boot 2.1.6 -> 2.1.7, 1.5.21 -> 1.5.22"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"thank-you",children:"Thank you"}),"\n",(0,r.jsx)(s,{usernames:["anuraaga","codefromthecrypt","dawnbreaks","ikhoon","imasahiro","minwoox","mpaltun","trustin"]})]})}function d(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);