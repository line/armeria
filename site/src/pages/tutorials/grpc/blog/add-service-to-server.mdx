---
menuTitle: "Run blog service on server"
order: 3
type: step
tags:
  - docservice
  - annotated-services
level: basic
---

# Running blog service on a server

In this step, we'll create a server instance and to it add the service we implemented in [Step 2. Implementing a gRPC service](/tutorials/grpc/blog/implement-grpc-service). Also, we'll run Armeria's [Documentation service](/docs/server-docservice) along with our blog service to test our service.

<TutorialSteps current={3} />

## What you need

You need to have the blog service [defined](/tutorials/grpc/blog/define-service) and [implemented](/tutorials/grpc/blog/implement-grpc-service).

## 1. Create a Main class

Create a `Main` class. You can see the full version of the file [here](https://github.com/line/armeria-examples/blob/master/tutorials/rest-api-annotated-service/src/main/java/example/armeria/server/blog/Main.java).

```java filename=Main.java
package example.armeria.server.blog;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public final class Main {
  private static final Logger logger = LoggerFactory.getLogger(Main.class);

  public static void main(String[] args) throws Exception {
      final Server server = newServer(8080);

      Runtime.getRuntime().addShutdownHook(new Thread(() -> {
          server.stop().join();
          logger.info("Server has been stopped.");
      }));

      server.start().join();
  }
}
```

## 2. Build a blog service

In the `newServer()` method, build our blog service using Armeria's <type://GrpcServiceBuilder>. Create and add the blog service we implemented.

```java filename=Main.java
static Server newServer(int port) {
  final GrpcService grpcService =
                GrpcService.builder()
                           .addService(new BlogService())
                           .build();
}
```

Make our service support requests that are not framed in gRPC wire format, by calling `enableUnframedRequests()`.

```java filename=Main.java
static Server newServer(int port) {
  final GrpcService grpcService =
                GrpcService.builder()
                           .addService(new BlogService())
                           .enableUnframedRequests(true)
                           .build();
}
```

Map the exceptions our blog service throws to grPC status by calling `exceptionMapping()` with the exception handler we defined.

```java filename=Main.java
static Server newServer(int port) {
  final GrpcService grpcService =
                GrpcService.builder()
                           .addService(new BlogService())
                           .enableUnframedRequests(true)
                           .exceptionMapping(new GrpcExceptionHandler())
                           .build();
}
```

## 3. Add Doc service

To test our service works, add Armeria's [Documentation service](/docs/server-docservice). You may skip this step.

In the `newServer()` method, first create a request example which is displayed in the DocService page. Feel free to add more examples for other service methods.

```java filename=Main.java highlight=1,6-13
import com.linecorp.armeria.server.docs.DocService;

public final class Main {
  static Server newServer(int port) {
    final BlogPost exampleRequest = BlogPost.newBuilder()
                                            .setTitle("My first blog")
                                            .setContent("Hello Armeria!")
                                            .build();

    final DocService docService = DocService.builder()
                                            .exampleRequests(BlogServiceGrpc.SERVICE_NAME,
                                                            "CreateBlogPost", exampleRequest)
                                            .exclude(DocServiceFilter.ofServiceName(
                                                    ServerReflectionGrpc.SERVICE_NAME))
                                            .build();
  }
}
```

To easily access the DocService page, add a log message at the end of the `main()` method.

```java filename=Main.java highlight=2
public static void main(String[] args) throws Exception {
  ...
  logger.info("Server has been started. Serving DocService at http://127.0.0.1:{}/docs",
                server.activeLocalPort());
}
```

## 4. Add services to server

As the last part of the `newServer()` method, add the gRPC service and DocService to the server.

```java filename=Main.java
static Server newServer(int port) {
  ...
  return Server.builder()
               .http(port)
               .service(grpcService)
               .serviceUnder("/docs", docService) // Optional
               .build();
}
```

## 5. Run service

To run the service, build the service first.
// TW question: Is this right?

```bash
./gradlew build
```

Run the service by running the `main()` method or using Gradle.

// TW: This should work right..? Mine doesn't work if I run this on a terminal, but it does if I run it from IDE.

```bash
./gradlew run
```

The server and services are launched successfully if you see this message.

```bash
 Server has been started. Serving DocService at http://127.0.0.1:8080/docs
```

## 6. Test DocService

Let's test and call our service operations, using Armeria's Documentation service.

Click the URL `http://127.0.0.1:8080/docs` from the log message or open the URL on a web browser. If you see the Document service page, you've launched the <type://DocService> and server successfully.

// TODO: Add screenshot

Note that in the **REQUEST BODY** section that the values specified in the `exampleRequest` are automatically displayed on the page.

```java filename=Main.java highlight=5-8
static Server newServer(int port) {
  final BlogPost exampleRequest = BlogPost.newBuilder()
                                      .setTitle("My first blog")
                                      .setContent("Hello Armeria!")
                                      .build();
```

Click the **SUBMIT** button, and you'll see the blog post information returned in the right panel.

// TODO: Add image

## What's next?

In this step, we've created a server instance and added our gRPC blog service to the server.

Next, at [Step N. ----](/tutorials/grpc/blog/develop-grpc-client), we'll implement a gRPC client.

<TutorialSteps current={3} />
