"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[1186],{28453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>a});var s=r(96540);const i={},t=s.createContext(i);function c(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(t.Provider,{value:n},e.children)}},66689:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"0.94.0","title":"v0.94.0","description":"New features","source":"@site/src/content/release-notes/0.94.0.mdx","sourceDirName":".","slug":"/0.94.0","permalink":"/release-notes/0.94.0","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site/src/content/release-notes/0.94.0.mdx","tags":[],"version":"current","frontMatter":{"date":"2019-10-04T00:00:00.000Z"},"sidebar":"defaultSidebar","previous":{"title":"v0.95.0","permalink":"/release-notes/0.95.0"},"next":{"title":"v0.93.0","permalink":"/release-notes/0.93.0"}}');var i=r(74848),t=r(28453);const c={date:new Date("2019-10-04T00:00:00.000Z")},a="v0.94.0",l={},d=[{value:"New features",id:"new-features",level:2},{value:"Improvement",id:"improvement",level:2},{value:"Bug fixes",id:"bug-fixes",level:2},{value:"Deprecations",id:"deprecations",level:2},{value:"Breaking changes",id:"breaking-changes",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Thank you",id:"thank-you",level:2}];function o(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components},{ThankYou:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ThankYou",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.header,{children:[(0,i.jsx)(n.h1,{id:"v0940",children:"v0.94.0"}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"October 4, 2019"})})]}),"\n",(0,i.jsx)(n.h2,{id:"new-features",children:"New features"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You can now decorate multiple services by path mapping. See the ",(0,i.jsx)(n.a,{href:"https://armeria.dev/docs/server-decorator#decorating-multiple-services-by-path-mapping",children:"documentation"})," for more information. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/582",children:"#582"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2040",children:"#2040"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2057",children:"#2057"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'ServerBuilder sb = new ServerBuilder();\n// Register vipService and memberService under \'/users\' path\nsb.annotatedService("/users/vip", vipService)\n  .annotatedService("/users/members", memberService);\n\n// Decorate all services under \'/users\' path\nsb.decoratorUnder("/users", (delegate, ctx, req) -> {\n    if (!authenticate(req)) {\n        return HttpResponse.of(HttpStatus.UNAUTHORIZED);\n    }\n    return delegate.serve(ctx, req);\n});\n'})}),"\n",(0,i.jsxs)(n.p,{children:["You can also use fluent route builder with ",(0,i.jsx)(n.code,{children:"routeDecorator()"})," to decorate more than one service by path mapping."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"// Decorate services under '/users' path with fluent route builder\nsb.routeDecorator()\n  .pathPrefix(\"/users\")\n  .build((delegate, ctx, req) -> {\n      if (!authenticate(req)) {\n          return HttpResponse.of(HttpStatus.UNAUTHORIZED);\n      }\n      return delegate.serve(ctx, req);\n  });\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You can now get the current ",(0,i.jsx)(n.code,{children:"HttpRequest"})," and ",(0,i.jsx)(n.code,{children:"RpcRequest"})," from ",(0,i.jsx)(n.code,{children:"RequestContext"})," so you don\u2019t need to downcast ",(0,i.jsx)(n.code,{children:"Request"})," to ",(0,i.jsx)(n.code,{children:"HttpRequest"})," or ",(0,i.jsx)(n.code,{children:"RpcRequest"}),". ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2089",children:"#2089"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2120",children:"#2120"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"// Before:\nRequest req = ctx.request();\nif (req instanceof HttpRequest) {\n    RequestHeaders headers = (HttpRequest) req).headers();\n}\n// After:\nRequestHeaders headers = ctx.request().headers();\n\n// Before:\nif (req instanceof RpcRequest) {\n    String rpcMethod = (RpcRequest) requestContent).method();\n}\n// After:\n// `rpcRequest()` method will return `null` when the request being handled is not\n// an RPC request or not decoded into an RPC request yet.\nString rpcMethod = ctx.rpcRequest().method();\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You can now set example headers when using ",(0,i.jsx)(n.code,{children:"{Annotated,Grpc,Thrift}ServiceRegisrationBean"})," for Spring Boot integration. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2100",children:"#2100"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Bean\npublic AnnotatedServiceRegistrationBean annotatedService() {\n    return new AnnotatedServiceRegistrationBean()\n               .setServiceName("annotatedService")\n               .setService(new AnnotatedService())\n               // Add example headers for annotated service\n               .addExampleHeaders("x-additional-header", "headerVal")\n               .addExampleHeaders("get", "x-additional-header", "headerVal");\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You can now create the following classes using the ",(0,i.jsx)(n.code,{children:"builder()"})," method instead of their ",(0,i.jsx)(n.code,{children:"*Builder"})," constructors. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1719",children:"#1719"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2085",children:"#2085"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"CircuitBreaker"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"CircuitBreakerHttpClient"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"CircuitBreakerRpcClient"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"DnsAddressEndpointGroup"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"DnsServiceEndpointGroup"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"DnsTextEndpointGroup"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"GrpcService"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Server"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"RetryingHttpClient"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RetryingRpcClient"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// Before:\nServer server = new ServerBuilder()\n                      .service("/hello", (ctx, req) -> HttpResponse.of(OK))\n                      .build();\n// After:\nServer server = Server.builder()\n                      .service("/hello", (ctx, req) -> HttpResponse.of(OK))\n                      .build();\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n","\n",(0,i.jsx)(n.h2,{id:"improvement",children:"Improvement"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["You can use Java 9 version specific ",(0,i.jsx)(n.code,{children:"RequestContextAwareFuture"})," for ",(0,i.jsx)(n.a,{href:"https://www.baeldung.com/java-9-completablefuture",children:"the recent changes of CompletableFuture API"}),", thanks to the ",(0,i.jsx)(n.a,{href:"https://openjdk.java.net/jeps/238",children:"Multi-Release JAR Files"}),". ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1991",children:"#1991"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2052",children:"#2052"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2127",children:"#2127"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"bug-fixes",children:"Bug fixes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ResponseTimeoutException"})," is not logged more than once anymore when the response has been timed out. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2000",children:"#2000"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2138",children:"#2138"})]}),"\n",(0,i.jsxs)(n.li,{children:["You no longer see ",(0,i.jsx)(n.code,{children:"AbortedStreamException"})," while sending long-lived requests with ",(0,i.jsx)(n.code,{children:"RetryingHttpClient"}),". ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2134",children:"#2134"})]}),"\n",(0,i.jsxs)(n.li,{children:["You can now see a warning message when JSON request conversion fails in an annotated service. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2041",children:"#2041"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2131",children:"#2131"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"deprecations",children:"Deprecations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AbstractBindingBuilder.pathUnder(String prefix)"})," has been deprecated in favor of ",(0,i.jsx)(n.code,{children:"pathPrefix(String prefix)"}),". ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2040",children:"#2040"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RouteBuilder.prefix(String prefix, ...)"})," has been deprecated in favor of ",(0,i.jsx)(n.code,{children:"pathPrefix(String prefix, ...)"}),". ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2040",children:"#2040"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RouteBuilder.pathWithPrefix(String prefix, String pathPattern)"})," has been deprecated in favor of ",(0,i.jsx)(n.code,{children:"path(String prefix, String pathPattern)"}),". ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2040",children:"#2040"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"new *Builder()"})," constructors which are mentioned in 'New Features' have been deprecated in favor of ",(0,i.jsx)(n.code,{children:"*.builder()"}),". ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1719",children:"#1719"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2085",children:"#2085"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"breaking-changes",children:"Breaking changes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"armeria-zipkin"})," has been removed for further clean-up. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2120",children:"#2120"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RequestContext.request()"})," returns ",(0,i.jsx)(n.code,{children:"HttpRequest"})," instead of ",(0,i.jsx)(n.code,{children:"Request"}),". ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2120",children:"#2120"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RequestContext.updateRequest()"})," always updates an ",(0,i.jsx)(n.code,{children:"HttpRequest"}),". It returns ",(0,i.jsx)(n.code,{children:"void"})," now because it never fails, unless ",(0,i.jsx)(n.code,{children:"null"})," is specified."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RequestContext.newDerivedContext(Request)"})," now requires both ",(0,i.jsx)(n.code,{children:"HttpRequest"})," and ",(0,i.jsx)(n.code,{children:"RpcRequest"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["A default virtual host service can serve any virtual host requests. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2057",children:"#2057"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2040",children:"#2040"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Before: If a custom virtual host fails to match the given request to a service, it returns ",(0,i.jsx)(n.code,{children:"NOT_FOUND"})," status."]}),"\n",(0,i.jsx)(n.li,{children:"After: If a custom virtual host fails to match the given request to a service, looking up a default virtual host services to match the request."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AbstractStreamMessageDuplicator.close()"})," does not abort all children ",(0,i.jsx)(n.code,{children:"StreamMessage"}),"s. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2134",children:"#2134"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["You should use ",(0,i.jsx)(n.code,{children:"AbstractStreamMessageDuplicator.abort()"})," to abort all children ",(0,i.jsx)(n.code,{children:"StreamMessage"}),"s anymore."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"gRPC 1.23.0 -> 1.24.0"}),"\n",(0,i.jsx)(n.li,{children:"Dropwizard Metrics 4.0.0 -> 4.1.0"}),"\n",(0,i.jsx)(n.li,{children:"Jetty 9.4.20.v20190813 -> 9.4.21.v20190926"}),"\n",(0,i.jsx)(n.li,{children:"Jackson 2.9.9.20190807 -> 2.10.0"}),"\n",(0,i.jsx)(n.li,{children:"Java JWT 3.8.2 -> 3.8.3"}),"\n",(0,i.jsx)(n.li,{children:"Micrometer 1.2.1 -> 1.3.0"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"thank-you",children:"Thank you"}),"\n",(0,i.jsx)(r,{usernames:["4whomtbts","anuraaga","codefromthecrypt","heowc","ikhoon","kojilin","minwoox","moonchanyong","sivaalli","trustin","young891221"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);