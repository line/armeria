"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[8084],{24500:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"0.98.3","title":"v0.98.3","description":"\ud83c\udf1f New features","source":"@site/src/content/release-notes/0.98.3.mdx","sourceDirName":".","slug":"/0.98.3","permalink":"/release-notes/0.98.3","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site/src/content/release-notes/0.98.3.mdx","tags":[],"version":"current","frontMatter":{"date":"2020-02-25T00:00:00.000Z"},"sidebar":"defaultSidebar","previous":{"title":"v0.98.4","permalink":"/release-notes/0.98.4"},"next":{"title":"v0.98.2","permalink":"/release-notes/0.98.2"}}');var r=i(74848),t=i(28453);const o={date:new Date("2020-02-25T00:00:00.000Z")},l="v0.98.3",c={},a=[{value:"\ud83c\udf1f New features",id:"-new-features",level:2},{value:"\ud83d\udcc8 Improvements",id:"-improvements",level:2},{value:"\ud83d\udee0\ufe0f Bug fixes",id:"\ufe0f-bug-fixes",level:2},{value:"\u2622\ufe0f Breaking changes",id:"\ufe0f-breaking-changes",level:2},{value:"\u26d3 Dependencies",id:"-dependencies",level:2},{value:"\ud83d\ude47 Thank you",id:"-thank-you",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components},{ThankYou:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ThankYou",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.header,{children:[(0,r.jsx)(n.h1,{id:"v0983",children:"v0.98.3"}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:"February 25, 2020"})})]}),"\n",(0,r.jsx)(n.h2,{id:"-new-features",children:"\ud83c\udf1f New features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RequestContextExporter"})," and ",(0,r.jsx)(n.code,{children:"RequestContextExportingAppender"})," for Logback can now export the current request ID into MDC. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2511",children:"#2511"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<configuration>\n  <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">\n    <encoder>\n      <pattern>%d{HH:mm:ss.SSS} %X{req.id} %msg%n</pattern>\n    </encoder>\n  </appender>\n  <appender name="RCEA" class="com.linecorp.armeria.common.logback.RequestContextExportingAppender">\n    <appender-ref ref="CONSOLE" />\n    <export>req.id</export>\n  </appender>\n</configuration>\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Client-side options API (",(0,r.jsx)(n.code,{children:"ClientOption"})," and ",(0,r.jsx)(n.code,{children:"ClientFactoryOption"}),") has been revamped. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2523",children:"#2523"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ClientOptions.get()"})," and ",(0,r.jsx)(n.code,{children:"ClientFactoryOptions.get()"})," never throw an exception. A default value is returned for an unspecified option. Therefore, other getter methods such as ",(0,r.jsx)(n.code,{children:"getOrElse()"})," have been removed."]}),"\n"]}),"\n"]}),"\n"]}),"\n","\n",(0,r.jsx)(n.h2,{id:"-improvements",children:"\ud83d\udcc8 Improvements"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["You'll now get a ",(0,r.jsx)(n.code,{children:"ClosedStreamException"})," instead of ",(0,r.jsx)(n.code,{children:"Http2Exception"})," when your HTTP/2 connection was closed due to an ",(0,r.jsx)(n.code,{children:"RST_STREAM"})," frame. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2508",children:"#2508"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-bug-fixes",children:"\ud83d\udee0\ufe0f Bug fixes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"*ClientBuilder.options(ClientOptions)"})," now overrides only the specified options. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2516",children:"#2516"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'ClientFactory factory = ClientFactory.insecure();\nClientOptions options = ClientOptions.builder()\n                                     .responseTimeMillis(5000)\n                                     .build();\nWebClient client = WebClient.builder("http://foo.com")\n                            .factory(factory)\n                            .options(options)\n                            .build();\n// This assertion does not fail anymore.\nassert client.options().factory() == ClientFactory.insecure();\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Fixed a bug where ",(0,r.jsx)(n.code,{children:"DocService"})," throws the ",(0,r.jsx)(n.code,{children:"java.lang.IllegalStateException: zip file closed"})," exception while starting up. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2518",children:"#2518"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2519",children:"#2519"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MetricCollectingClient"})," does not count the request that failed initially due to a ",(0,r.jsx)(n.code,{children:"connection refused"})," error and then succeeded after a retry as failure anymore. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2517",children:"#2517"})]}),"\n",(0,r.jsxs)(n.li,{children:["Fixed a bug where ",(0,r.jsx)(n.code,{children:"LoggingClient"})," and ",(0,r.jsx)(n.code,{children:"LoggingSerivce"})," does not push the current context when logging. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2528",children:"#2528"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RequestContextExporter"})," and ",(0,r.jsx)(n.code,{children:"RequestContextExportingAppender"})," can now export a single custom attribute into multiple MDC properties. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2521",children:"#2521"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RequestContextExporter"})," and ",(0,r.jsx)(n.code,{children:"RequestContextExportingAppender"})," does not export outdated custom attributes anymore. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2520",children:"#2520"})]}),"\n",(0,r.jsxs)(n.li,{children:["Renamed incorrect meter ID ",(0,r.jsx)(n.code,{children:"armeria.server.pendingResponses"})," into ",(0,r.jsx)(n.code,{children:"armeria.server.pending.responses"}),". ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2506",children:"#2506"})]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.code,{children:"Date"})," header is now encoded properly even when ",(0,r.jsx)(n.code,{children:"System.nanoTime()"})," returns a negative value. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2530",children:"#2530"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GrpcStatus.fromThrowable()"})," now treats ",(0,r.jsx)(n.code,{children:"ContentTooLargeException"})," as ",(0,r.jsx)(n.code,{children:"RESOURCE_EXHAUSTED"})," rather than ",(0,r.jsx)(n.code,{children:"INTERNAL_ERROR"}),". ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2523",children:"#2523"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-breaking-changes",children:"\u2622\ufe0f Breaking changes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ClientOptions.getOrElse()"})," and ",(0,r.jsx)(n.code,{children:"getOrNull()"})," have been removed. ",(0,r.jsx)(n.code,{children:"get()"})," always returns a non-null value now. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2523",children:"#2523"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ClientOptions.asMap()"})," and ",(0,r.jsx)(n.code,{children:"ClientFactoryOptions.asMap()"})," now return only the options overridden by a user. You can get the ",(0,r.jsx)(n.code,{children:"Set"})," of available options using ",(0,r.jsx)(n.code,{children:"ClientOptions.allOptions()"})," or ",(0,r.jsx)(n.code,{children:"ClientFactoryOptions.allOptions()"}),": ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2516",children:"#2516"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2523",children:"#2523"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"ClientOptions myOptions = ...;\nMap<ClientOption<?>, Object> map = new IdentityHashMap<>();\nfor (ClientOption o : ClientOptions.allOptions()) {\n    map.put(myOptions.get(o));\n}\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ClientOptions.valueOf()"})," and ",(0,r.jsx)(n.code,{children:"ClientFactoryOptions.valueOf()"})," have been split into two methods: ",(0,r.jsx)(n.code,{children:"define()"})," and ",(0,r.jsx)(n.code,{children:"of()"})," ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2523",children:"#2523"}),".","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"of()"})," if you're getting an existing option."]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"define()"})," if you're defining a new option."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["You might need to adjust your monitoring system if you were watching ",(0,r.jsx)(n.code,{children:"armeria.server.pendingResponses"}),", which has been renamed to ",(0,r.jsx)(n.code,{children:"armeria.server.pending.responses"})," in this release. ",(0,r.jsx)(n.a,{href:"https://github.com/line/armeria/issues/2506",children:"#2506"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"-dependencies",children:"\u26d3 Dependencies"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Dropwizard 1.3.18 \u2192 1.3.19"}),"\n",(0,r.jsx)(n.li,{children:"Dropwizard Metrics 4.1.2 \u2192 4.1.3"}),"\n",(0,r.jsx)(n.li,{children:"java-jwt 3.9.0 \u2192 3.10.0"}),"\n",(0,r.jsx)(n.li,{children:"RxJava 2.2.17 \u2192 2.2.18"}),"\n",(0,r.jsxs)(n.li,{children:["Shaded dependencies","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reflections 0.9.12 \u2192 0.9.11 (Downgrade)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"-thank-you",children:"\ud83d\ude47 Thank you"}),"\n",(0,r.jsx)(i,{usernames:["andrewoma","andrey-tpt","anuraaga","Boozilla","ikhoon","jrhee17","JunoJunho","minwoox","trustin"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(96540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);