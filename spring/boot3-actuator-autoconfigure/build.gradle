import com.linecorp.armeria.conventions.spring.SpringBuildUtil

dependencies {
    api libs.spring.boot3.actuator.autoconfigure
    api libs.jakarta.inject
    compileOnly libs.jakarta.validation

    optionalApi project(':prometheus1')
    optionalApi libs.micrometer.prometheus.legacy
    optionalApi libs.dropwizard.metrics.json

    implementation libs.spring.boot3.autoconfigure
    optionalImplementation libs.reactor.core

    testImplementation project(':spring:boot3-autoconfigure')
    testImplementation libs.spring.boot3.starter.actuator
    testImplementation libs.spring.boot3.starter.test
    testImplementation libs.micrometer.prometheus
    // Added for sharing test suites with boot2
    testImplementation libs.javax.inject
}

def boot4Actuator = "boot4-actuator-autoconfigure"
SpringBuildUtil.useTestSources(project(":spring:${boot4Actuator}"), project) {
    exclude '**/EnableTestMetrics.java'
    exclude '**/SettableHealthIndicator.java'
}

SpringBuildUtil.useMainSources(project(":spring:${boot4Actuator}"), project) {
    exclude "**/HealthConfiguration.java"
    exclude "**/package-info.java"
}
