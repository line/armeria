"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[8730],{28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>l});var r=i(96540);const n={},s=r.createContext(n);function o(e){const t=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),r.createElement(s.Provider,{value:t},e.children)}},62647:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"tutorials/thrift/define-service","title":"Defining a blog service","description":"Let\'s begin by defining our blog service in a Thrift file.","source":"@site/src/content/docs/tutorials/thrift/01-define-service.mdx","sourceDirName":"tutorials/thrift","slug":"/tutorials/thrift/define-service","permalink":"/docs/tutorials/thrift/define-service","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site-new/src/content/docs/tutorials/thrift/01-define-service.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"1. Define a service","category":"thrift","type":"step","targetLang":"java"},"sidebar":"docsSidebar","previous":{"title":"Thrift tutorial introduction","permalink":"/docs/tutorials/thrift/"},"next":{"title":"2. Run a service","permalink":"/docs/tutorials/thrift/run-service"}}');var n=i(74848),s=i(28453);const o={sidebar_label:"1. Define a service",category:"thrift",type:"step",targetLang:"java"},l="Defining a blog service",a={},c=[{value:"What you need",id:"what-you-need",level:2},{value:"1. Create a Thrift file",id:"1-create-a-thrift-file",level:2},{value:"2. Define a service",id:"2-define-a-service",level:2},{value:"3. Compile the Thrift file",id:"3-compile-the-thrift-file",level:2},{value:"Next step",id:"next-step",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components},{TutorialSteps:i}=t;return i||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("TutorialSteps",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"defining-a-blog-service",children:"Defining a blog service"})}),"\n",(0,n.jsx)(t.p,{children:"Let's begin by defining our blog service in a Thrift file."}),"\n",(0,n.jsx)(i,{current:1}),"\n",(0,n.jsx)(t.h2,{id:"what-you-need",children:"What you need"}),"\n",(0,n.jsxs)(t.p,{children:["No preparation is required for this step. Do check that you've prepared the ",(0,n.jsx)(t.a,{href:"/docs/tutorials/thrift/#prerequisites",children:"prerequisites"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"1-create-a-thrift-file",children:"1. Create a Thrift file"}),"\n",(0,n.jsxs)(t.p,{children:["Create a Thrift file, ",(0,n.jsx)(t.code,{children:"blog.thrift"})," in the ",(0,n.jsx)(t.code,{children:"{project_root}/src/main/thrift"})," folder as follows.\nYou can see the full version of the file ",(0,n.jsx)(t.a,{href:"https://github.com/line/armeria-examples/blob/main/tutorials/thrift/src/main/thrift/blog.thrift",children:"here"}),"."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cpp",metastring:'title="blog.thrift"',children:"namespace java example.armeria.blog.thrift\n"})}),"\n",(0,n.jsx)(t.admonition,{type:"tip",children:(0,n.jsxs)(t.p,{children:["See ",(0,n.jsx)(t.a,{href:"/docs/tutorials/thrift#sample-service",children:"Sample service structure"})," for the overall folder structure."]})}),"\n",(0,n.jsx)(t.h2,{id:"2-define-a-service",children:"2. Define a service"}),"\n",(0,n.jsxs)(t.p,{children:["Let's define our blog service in the ",(0,n.jsx)(t.code,{children:"blog.thrift"})," file.\nWe'll add structs, an exception, and service methods."]}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Add the ",(0,n.jsx)(t.code,{children:"BlogPost"})," struct."]}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cpp",metastring:'title="blog.thrift"',children:"struct BlogPost {\n  1: i32 id;\n  2: string title;\n  3: string content;\n  4: i64 createdAt;\n  5: i64 modifiedAt;\n}\n"})}),"\n",(0,n.jsxs)(t.ol,{start:"2",children:["\n",(0,n.jsx)(t.li,{children:"Add structs for request and response objects as follows."}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cpp",metastring:'title="blog.thrift"',children:"struct CreateBlogPostRequest {\n  1: string title;\n  2: string content;\n}\n\nstruct GetBlogPostRequest {\n  1: i32 id;\n}\n\nstruct ListBlogPostsRequest {\n  1: bool descending;\n}\n\nstruct ListBlogPostsResponse {\n  1: list<BlogPost> blogs;\n}\n\nstruct UpdateBlogPostRequest {\n  1: i32 id;\n  2: string title;\n  3: string content;\n}\n\nstruct DeleteBlogPostRequest {\n  1: i32 id;\n}\n"})}),"\n",(0,n.jsxs)(t.ol,{start:"3",children:["\n",(0,n.jsxs)(t.li,{children:["Add the ",(0,n.jsx)(t.code,{children:"BlogNotFoundException"}),"."]}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cpp",metastring:'title="blog.thrift"',children:"exception BlogNotFoundException {\n  1: string reason\n}\n"})}),"\n",(0,n.jsxs)(t.ol,{start:"4",children:["\n",(0,n.jsx)(t.li,{children:"Add a service with methods for create, read, update, and delete operations."}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-cpp",metastring:'title="blog.thrift"',children:"service BlogService {\n  BlogPost createBlogPost(1:CreateBlogPostRequest request),\n\n  BlogPost getBlogPost(1:GetBlogPostRequest request) throws (1:BlogNotFoundException e),\n\n  ListBlogPostsResponse listBlogPosts(1:ListBlogPostsRequest request),\n\n  BlogPost updateBlogPost(1:UpdateBlogPostRequest request) throws (1:BlogNotFoundException e),\n\n  void deleteBlogPost(1:DeleteBlogPostRequest request) throws (1:BlogNotFoundException e),\n}\n"})}),"\n",(0,n.jsx)(t.h2,{id:"3-compile-the-thrift-file",children:"3. Compile the Thrift file"}),"\n",(0,n.jsxs)(t.p,{children:["Compile the ",(0,n.jsx)(t.code,{children:"blog.thrift"})," file to generate Java code.\nYou can refer to the full ",(0,n.jsx)(t.a,{href:"https://github.com/line/armeria-examples/tree/main/tutorials/thrift/build.gradle",children:"build.gradle"})," file for generating code with ",(0,n.jsx)(t.a,{href:"https://github.com/jruyi/thrift-gradle-plugin",children:"Gradle Thrift Plugin"}),"."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"./gradlew compileThrift\n"})}),"\n",(0,n.jsxs)(t.p,{children:["You'll see the generated Java code in the ",(0,n.jsx)(t.code,{children:"{project_root}/build/generated-sources/thrift/gen-java/example/armeria/blog/thrift/"})," folder."]}),"\n",(0,n.jsx)(t.h2,{id:"next-step",children:"Next step"}),"\n",(0,n.jsxs)(t.p,{children:["In this step, we've defined a Thrift file for our service and generated Java code.\nNext, we'll ",(0,n.jsx)(t.a,{href:"/docs/tutorials/thrift/run-service",children:"run a service"})," and test the connection."]}),"\n",(0,n.jsx)(i,{current:1})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}}}]);