"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[515],{28453:(e,r,s)=>{s.d(r,{R:()=>n,x:()=>c});var t=s(96540);const i={},a=t.createContext(i);function n(e){const r=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:n(e.components),t.createElement(a.Provider,{value:r},e.children)}},31333:(e,r,s)=>{s.d(r,{A:()=>t});const t=s.p+"assets/images/tutorial_blogservice_return-8797a24c1d22a8e6de5a3f6ba7d58c5c.png"},55917:(e,r,s)=>{s.d(r,{A:()=>t});const t=s.p+"assets/images/tutorial_blogservice_docservice_start-cade0536df555e8102e8e247c4b910e9.png"},63952:(e,r,s)=>{s.d(r,{A:()=>t});const t=s.p+"assets/images/tutorial_blogservice_reqex-07cb8d43ee19db00c825be0aa7f8456f.png"},75910:(e,r,s)=>{s.d(r,{A:()=>t});const t=s.p+"assets/images/tutorial_blogservice_docservice_end-48ef3a4c2f8d1cefc2cec611c514b644.png"},91191:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>n,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"tutorials/rest/add-services-to-server","title":"Adding services to a server","description":"In this step, we\'ll add an empty blog service to the server we created in Step 1. Create a server. Also, we\'ll add Armeria\'s Documentation service for testing our blog service.","source":"@site/src/content/docs/tutorials/rest/03-add-services-to-server.mdx","sourceDirName":"tutorials/rest","slug":"/tutorials/rest/add-services-to-server","permalink":"/docs/tutorials/rest/add-services-to-server","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site/src/content/docs/tutorials/rest/03-add-services-to-server.mdx","tags":[{"inline":true,"label":"docservice","permalink":"/docs/tags/docservice"},{"inline":true,"label":"annotated-services","permalink":"/docs/tags/annotated-services"}],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_label":"3. Add services to a server","type":"step","tags":["docservice","annotated-services"],"level":"basic"},"sidebar":"docsSidebar","previous":{"title":"2. Prepare a data object","permalink":"/docs/tutorials/rest/prepare-data-object"},"next":{"title":"4. Implement CREATE","permalink":"/docs/tutorials/rest/implement-create"}}');var i=s(74848),a=s(28453);const n={sidebar_label:"3. Add services to a server",type:"step",tags:["docservice","annotated-services"],level:"basic"},c="Adding services to a server",o={},l=[{value:"What you need",id:"what-you-need",level:2},{value:"1. Create a service file",id:"1-create-a-service-file",level:2},{value:"2. Add a blog service to server",id:"2-add-a-blog-service-to-server",level:2},{value:"3. Add the Documentation service",id:"3-add-the-documentation-service",level:2},{value:"4. Run the server and services",id:"4-run-the-server-and-services",level:2},{value:"5. Check DocService page",id:"5-check-docservice-page",level:2},{value:"Using DocService after adding service methods",id:"using-docservice-after-adding-service-methods",level:3},{value:"What&#39;s next?",id:"whats-next",level:2}];function d(e){const r={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components},{TutorialSteps:t}=r;return t||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("TutorialSteps",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"adding-services-to-a-server",children:"Adding services to a server"})}),"\n",(0,i.jsxs)(r.p,{children:["In this step, we'll add an empty blog service to the server we created in ",(0,i.jsx)(r.a,{href:"/docs/tutorials/rest/create-server",children:"Step 1. Create a server"}),". Also, we'll add Armeria's ",(0,i.jsx)(r.a,{href:"/docs/server/docservice",children:"Documentation service"})," for testing our blog service."]}),"\n",(0,i.jsx)(t,{current:3}),"\n",(0,i.jsx)(r.h2,{id:"what-you-need",children:"What you need"}),"\n",(0,i.jsxs)(r.p,{children:["You need to have the following file obtained from previous steps.\nYou can always ",(0,i.jsx)(r.a,{href:"https://github.com/line/armeria-examples/blob/main/tutorials/rest-api-annotated-service/src/main/java/example/armeria/server/blog/",children:"download"})," the full version, instead of creating one yourself."]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"Main.java"})}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"1-create-a-service-file",children:"1. Create a service file"}),"\n",(0,i.jsxs)(r.p,{children:["Create a service file, ",(0,i.jsx)(r.code,{children:"BlogService.java"}),". You can see the full version of the file ",(0,i.jsx)(r.a,{href:"https://github.com/line/armeria-examples/blob/main/tutorials/rest-api-annotated-service/src/main/java/example/armeria/server/blog/BlogService.java",children:"here"}),". We'll add on service methods in this class in later steps."]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",metastring:'title="BlogService.java"',children:"package example.armeria.server.blog;\n\nimport java.util.Map;\nimport java.util.concurrent.ConcurrentHashMap;\n\npublic final class BlogService {\n  private final Map<Integer, BlogPost> blogPosts = new ConcurrentHashMap<>();\n}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"2-add-a-blog-service-to-server",children:"2. Add a blog service to server"}),"\n",(0,i.jsxs)(r.p,{children:["In ",(0,i.jsx)(r.a,{href:"/docs/tutorials/rest/create-server",children:"Step 1. Create a server"}),", we added a dummy service just to check that a server is launched. Now, let's remove the dummy service and add an empty blog service, instead."]}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:["From ",(0,i.jsx)(r.code,{children:"Main.java"}),", remove the dummy service at line 4."]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",metastring:'title="Main.java" {4} showLineNumbers',children:'static Server newServer(int port) {\n  ...\n  return sb.http(port)\n           .service("/", (ctx, req) -> HttpResponse.of("Hello, Armeria!")) // Remove this\n           .build();\n'})}),"\n",(0,i.jsxs)(r.ol,{start:"2",children:["\n",(0,i.jsx)(r.li,{children:"Add our service by adding line 4."}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",metastring:'title="Main.java" {4} showLineNumbers',children:"static Server newServer(int port) {\n  ...\n  return sb.http(port)\n           .annotatedService(new BlogService())   // Add this\n           .build();\n}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"3-add-the-documentation-service",children:"3. Add the Documentation service"}),"\n",(0,i.jsxs)(r.p,{children:["This time, we'll add Armeria's ",(0,i.jsx)(r.a,{href:"/docs/server/docservice",children:"Documentation service"}),":"]}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:["In the ",(0,i.jsx)(r.code,{children:"newServer()"})," method, add a ",(0,i.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})," and a request example for ",(0,i.jsx)(r.a,{href:"/docs/tutorials/rest/implement-create",children:"creating blog posts"}),",\nusing ",(0,i.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocServiceBuilder.html#exampleRequests(java.lang.Class,java.lang.String,java.lang.Iterable)",children:"DocServiceBuilder#exampleRequests(Class,String,Iterable)"}),". Feel free to add more examples for other service methods."]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",metastring:'title="Main.java" {1,6-13}',children:'import com.linecorp.armeria.server.docs.DocService;\n\npublic final class Main {\n  static Server newServer(int port) {\n    ServerBuilder sb = Server.builder();\n    DocService docService =\n            DocService.builder()\n                      .exampleRequests(BlogService.class,\n                          "createBlogPost", // Name of service method\n                          "{\\"title\\":\\"My first blog\\", \\"content\\":\\"Hello Armeria!\\"}")\n                      .build();\n'})}),"\n",(0,i.jsxs)(r.ol,{start:"2",children:["\n",(0,i.jsxs)(r.li,{children:["Inside the ",(0,i.jsx)(r.code,{children:"newServer()"})," method, add the ",(0,i.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})," to our server builder."]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",metastring:'title="Main.java" {5}',children:'static Server newServer(int port) {\n  ...\n  return sb.http(port)\n           .annotatedService(new BlogService())\n           .serviceUnder("/docs", docService)  // Add Documentation service\n           .build();\n}\n'})}),"\n",(0,i.jsxs)(r.ol,{start:"3",children:["\n",(0,i.jsxs)(r.li,{children:["(Optional) To access the Documentation service result easily, edit the log message we added in ",(0,i.jsx)(r.a,{href:"/docs/tutorials/rest/create-server",children:"Step 1. Create a server"})," to the one specified below."]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",metastring:'title="Main.java" {2}',children:'public static void main(String[] args) throws Exception {\n    logger.info("Server has been started. Serving DocService at http://127.0.0.1:{}/docs",\n                server.activeLocalPort());\n}\n'})}),"\n",(0,i.jsx)(r.h2,{id:"4-run-the-server-and-services",children:"4. Run the server and services"}),"\n",(0,i.jsxs)(r.p,{children:["Like we did in ",(0,i.jsx)(r.em,{children:"Step 1. Create a server"}),", ",(0,i.jsx)(r.a,{href:"/docs/tutorials/rest/create-server#3-run-the-server-and-service",children:"build and run"})," the service by running the ",(0,i.jsx)(r.code,{children:"main()"})," method or using Gradle."]}),"\n",(0,i.jsx)(r.p,{children:"The server and services are launched successfully if you see this message."}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:" Server has been started. Serving DocService at http://127.0.0.1:8080/docs\n"})}),"\n",(0,i.jsx)(r.h2,{id:"5-check-docservice-page",children:"5. Check DocService page"}),"\n",(0,i.jsx)(r.p,{children:"Let's test and call our service operations, using Armeria's Documentation service."}),"\n",(0,i.jsxs)(r.p,{children:["Click the URL ",(0,i.jsx)(r.a,{href:"http://127.0.0.1:8080/docs",children:"http://127.0.0.1:8080/docs"})," from the log message or open the URL on a web browser. If you see the Document service page, you've launched the ",(0,i.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})," and server successfully. We're seeing no services on the\npage because we're to implement service methods."]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:s(55917).A+"",width:"1193",height:"410"})}),"\n",(0,i.jsx)(r.h3,{id:"using-docservice-after-adding-service-methods",children:"Using DocService after adding service methods"}),"\n",(0,i.jsx)(r.p,{children:"When you add service methods through later steps, you'll see a result similar to this."}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:s(75910).A+"",width:"1197",height:"414"})}),"\n",(0,i.jsxs)(r.p,{children:["To test your service methods with the ",(0,i.jsx)(r.a,{href:"/docs/server/docservice",children:"Documentation service"}),":"]}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:["Click the ",(0,i.jsx)(r.strong,{children:"createBlogPost()"})," method link in the left panel. You can make calls to the creation method from the page opened."]}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:s(63952).A+"",width:"536",height:"419"})}),"\n",(0,i.jsxs)(r.p,{children:["Note that in the ",(0,i.jsx)(r.strong,{children:"REQUEST BODY"})," section that the values specified for the ",(0,i.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocServiceBuilder.html",children:"DocServiceBuilder"})," are automatically entered on the page."]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",metastring:'title="Main.java" {5-8}',children:'static Server newServer(int port) {\n  ServerBuilder sb = Server.builder();\n  DocService docService =\n    DocService.builder()\n              .exampleRequests(\n                BlogService.class,\n                "createBlogPost",\n                "{\\"title\\":\\"My first blog\\",\\"content\\":\\"Hello Armeria!\\"}")\n              .build();\n'})}),"\n",(0,i.jsxs)(r.ol,{start:"2",children:["\n",(0,i.jsxs)(r.li,{children:["Click the ",(0,i.jsx)(r.strong,{children:"SUBMIT"})," button, and you'll see the blog post information returned in the right panel."]}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{src:s(31333).A+"",width:"1080",height:"253"})}),"\n",(0,i.jsx)(r.h2,{id:"whats-next",children:"What's next?"}),"\n",(0,i.jsx)(r.p,{children:"In this step, we've added an empty blog service and the Documentation service to a server."}),"\n",(0,i.jsxs)(r.p,{children:["Next, at ",(0,i.jsx)(r.a,{href:"/docs/tutorials/rest/implement-create",children:"Step 4. Implement CREATE"}),", we'll finally implement a CREATE\noperation to create blog posts."]}),"\n",(0,i.jsx)(t,{current:3})]})}function h(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);