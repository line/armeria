"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[4554],{25080:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>c,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"1.8.0","title":"v1.8.0","description":"\ud83c\udf1f New features","source":"@site/src/content/release-notes/1.8.0.mdx","sourceDirName":".","slug":"/1.8.0","permalink":"/release-notes/1.8.0","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site-new/src/content/release-notes/1.8.0.mdx","tags":[],"version":"current","frontMatter":{"date":"2021-05-14T00:00:00.000Z"},"sidebar":"defaultSidebar","previous":{"title":"v1.9.0","permalink":"/release-notes/1.9.0"},"next":{"title":"v1.7.2","permalink":"/release-notes/1.7.2"}}');var a=n(74848),t=n(28453);const s={date:new Date("2021-05-14T00:00:00.000Z")},c="v1.8.0",o={},l=[{value:"\ud83c\udf1f New features",id:"-new-features",level:2},{value:"\ud83d\udcc8 Improvements",id:"-improvements",level:2},{value:"\ud83d\udee0\ufe0f Bug fixes",id:"\ufe0f-bug-fixes",level:2},{value:"\u26d3 Dependencies",id:"-dependencies",level:2},{value:"\ud83d\ude47 Thank you",id:"-thank-you",level:2}];function h(e){const r={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components},{ThankYou:n}=r;return n||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ThankYou",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.header,{children:[(0,a.jsx)(r.h1,{id:"v180",children:"v1.8.0"}),(0,a.jsx)(r.p,{children:(0,a.jsx)(r.em,{children:"May 14, 2021"})})]}),"\n",(0,a.jsx)(r.h2,{id:"-new-features",children:"\ud83c\udf1f New features"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now create a ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/healthcheck/HealthChecker.html",children:"HealthChecker"})," that updates its healthiness periodically. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3392",children:"#3392"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3406",children:"#3406"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"HealthChecker.of(() -> {\n    HealthCheckStatus status = ...;\n    UnmodifiableFuture.completedFuture(status);\n}, Duration.ofSeconds(5));\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now create a propagating ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/ContextAwareExecutorService.html",children:"ContextAwareExecutorService"})," and\n",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/ContextAwareScheduledExecutorService.html",children:"ContextAwareScheduledExecutorService"})," using ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/RequestContext.html#makeContextPropagating(java.util.concurrent.ExecutorService)?full",children:"RequestContext#makeContextPropagating(ExecutorService)"}),"\nand ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/RequestContext.html#makeContextPropagating(java.util.concurrent.ScheduledExecutorService)?full",children:"RequestContext#makeContextPropagating(ScheduledExecutorService)"}),".\nThe executors propagate a ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/RequestContext.html",children:"RequestContext"})," to submitted tasks when a submission thread is\na request-context-aware thread. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3483",children:"#3483"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"ExecutorService myExecutor = Executors.newSingleThreadExecutor();\nExecutorService contextAwareExecutor = RequestContext.makeContextPropagating(myExecutor);\n// Make sure the current thread is a request-context-aware thread\nRequestContext ctx = RequestContext.current();\ncontextAwareExecutor.execute(() -> {\n    assert RequestContext.current() == ctx;\n});\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now set a maximum allowed length of a server response in the request level\nusing ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/WebClientRequestPreparation.html#maxResponseLength(long)",children:"WebClientRequestPreparation#maxResponseLength(long)"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3565",children:"#3565"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"WebClient client = ...;\nclient.prepare()\n      .maxResponseLength(maxResponseLength)\n      ...\n      .execute();\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now add or set HTTP headers and query params with ",(0,a.jsx)(r.code,{children:"java.util.Map"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3499",children:"#3499"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3502",children:"#3502"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:' HttpHeaders\n    .builder()\n    .add(Map.of("foo", "1"))\n    .set(Map.of("bar", "2"));\n\nQueryParams.builder()\n           .add(Map.of("page", "1"))\n           .set(Map.of("size", "2"));\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now disable DNS query metrics using ",(0,a.jsx)(r.a,{href:"type://#",children:"DnsResolverGroupBuilder#disableDnsQueryMetrics()"}),".\n",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3368",children:"#3368"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3552",children:"#3552"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"ClientFactory.builder()\n             .domainNameResolverCustomizer(customizer -> {\n                 customizer.disableDnsQueryMetrics();\n             })\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now create a ",(0,a.jsx)(r.a,{href:"https://jsonlines.org/",children:"JSON Lines"})," response using ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/streaming/JsonLines.html",children:"JsonLines"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3446",children:"#3446"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3456",children:"#3456"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"Publisher<MyObject> publisher = StreamMessage.of(new MyObject(...), new MyObject(...), ...);\nHttpReponse response = JsonLines.fromPublisher(publisher);\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now create an ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/RpcRequest.html",children:"RpcRequest"})," with a service name using\n",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/RpcRequest.html#of(java.lang.Class,java.lang.String,java.lang.String,java.lang.Iterable)",children:"RpcRequest#of(Class,String,String,Iterable)"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3537",children:"#3537"})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now customize ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/metric/MetricCollectingService.html",children:"MetricCollectingService"})," with ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/spring/MetricCollectingServiceConfigurator.html",children:"MetricCollectingServiceConfigurator"}),"\nwhen using Spring integration. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3536",children:"#3536"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"@Bean\npublic MetricCollectingServiceConfigurator metricCollectingServiceConfigurator() {\n    return builder -> builder\n            .successFunction((context, log) -> {\n                final int statusCode = log.responseHeaders().status().code();\n                return (statusCode >= 200 && statusCode < 400) || statusCode == 404;\n            });\n}\n"})}),"\n"]}),"\n"]}),"\n","\n",(0,a.jsx)(r.h2,{id:"-improvements",children:"\ud83d\udcc8 Improvements"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Various performance optimizations. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3534",children:"#3534"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3535",children:"#3535"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3537",children:"#3537"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3538",children:"#3538"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3539",children:"#3539"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3543",children:"#3543"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3548",children:"#3548"})]}),"\n",(0,a.jsxs)(r.li,{children:["You can now null-safely access the elements of collections and arrays in\n",(0,a.jsx)(r.a,{href:"https://kotlinlang.org/docs/whatsnew15.html#improvements-to-handling-nullability-annotations",children:"Kotlin 1.5"}),".\n",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3527",children:"#3527"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3558",children:"#3558"})]}),"\n",(0,a.jsxs)(r.li,{children:["You can now use code completion for ",(0,a.jsx)(r.code,{children:"armeria.ssl"})," when using IntelliJ IDEA. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3507",children:"#3507"})]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"\ufe0f-bug-fixes",children:"\ud83d\udee0\ufe0f Bug fixes"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Armeria server now correctly sends ",(0,a.jsx)(r.code,{children:"Connection: close"})," header on an invalid HTTP/1 request. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3506",children:"#3506"})]}),"\n",(0,a.jsxs)(r.li,{children:["You no longer see an infinity loop or an ",(0,a.jsx)(r.code,{children:"IllegalStateException: Recurse update"})," when invalidating\na DNS cache. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3528",children:"#3528"})]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/logging/LoggingService.html",children:"LoggingService"})," now correctly logs a request failed with the server error class(5xx) that is served\nby ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/TransientService.html",children:"TransientService"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3551",children:"#3551"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3559",children:"#3559"})]}),"\n",(0,a.jsxs)(r.li,{children:["You no longer see trailing dollar signs from a service name. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3508",children:"#3508"})]}),"\n",(0,a.jsxs)(r.li,{children:["You no longer see a ",(0,a.jsx)(r.code,{children:"NullPointerException"})," when a request times out. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3564",children:"#3564"})]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"-dependencies",children:"\u26d3 Dependencies"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Caffeine 2.9.0 -> 2.9.1"}),"\n",(0,a.jsx)(r.li,{children:"Dropwizard Metrics 4.1.20 -> 4.1.21"}),"\n",(0,a.jsx)(r.li,{children:"java-jwt 3.15.0 -> 3.16.0"}),"\n",(0,a.jsxs)(r.li,{children:["Micrometer 1.6.6 -> 1.7.0","\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Note that ",(0,a.jsx)(r.code,{children:"PrometheusMeterRegistry"})," will work with the Prometheus ",(0,a.jsx)(r.code,{children:"simpleclient"})," dependency version 0.10.0\nor later only. See ",(0,a.jsx)(r.a,{href:"https://github.com/micrometer-metrics/micrometer/releases/tag/v1.7.0",children:"Micrometer 1.7.0 release note"})," for more information."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.li,{children:"Reactor 3.4.5 -> 3.4.6"}),"\n",(0,a.jsx)(r.li,{children:"scala-collection-compat 2.4.3 -> 2.4.4"}),"\n",(0,a.jsx)(r.li,{children:"scala-java8-compat 0.9.1 -> 1.0.0"}),"\n",(0,a.jsx)(r.li,{children:"Spring 5.3.6 -> 5.3.7"}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"-thank-you",children:"\ud83d\ude47 Thank you"}),"\n",(0,a.jsx)(n,{usernames:["amitvc","anuraaga","hexoul","hirakida","ikhoon","jrhee17","KarboniteKream","kojilin","m50d","max904-github","minwoox","nirvanarsc","trustin"]})]})}function d(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>s,x:()=>c});var i=n(96540);const a={},t=i.createContext(a);function s(e){const r=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(t.Provider,{value:r},e.children)}}}]);