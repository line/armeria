"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[8508],{28453:(e,r,n)=>{n.d(r,{R:()=>s,x:()=>o});var i=n(96540);const a={},t=i.createContext(a);function s(e){const r=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(t.Provider,{value:r},e.children)}},28814:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"0.99.5","title":"v0.99.5","description":"\ud83c\udf1f New features","source":"@site/src/content/release-notes/0.99.5.mdx","sourceDirName":".","slug":"/0.99.5","permalink":"/release-notes/0.99.5","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site-new/src/content/release-notes/0.99.5.mdx","tags":[],"version":"current","frontMatter":{"date":"2020-05-14T00:00:00.000Z"},"sidebar":"defaultSidebar","previous":{"title":"v0.99.6","permalink":"/release-notes/0.99.6"},"next":{"title":"v0.99.4","permalink":"/release-notes/0.99.4"}}');var a=n(74848),t=n(28453);const s={date:new Date("2020-05-14T00:00:00.000Z")},o="v0.99.5",l={},c=[{value:"\ud83c\udf1f New features",id:"-new-features",level:2},{value:"\ud83d\udcc8 Improvements",id:"-improvements",level:2},{value:"\ud83d\udee0\ufe0f Bug fixes",id:"\ufe0f-bug-fixes",level:2},{value:"\u2622\ufe0f Breaking changes",id:"\ufe0f-breaking-changes",level:2},{value:"\u26d3 Dependencies",id:"-dependencies",level:2},{value:"\ud83d\ude47 Thank you",id:"-thank-you",level:2}];function h(e){const r={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components},{ThankYou:n}=r;return n||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ThankYou",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.header,{children:[(0,a.jsx)(r.h1,{id:"v0995",children:"v0.99.5"}),(0,a.jsx)(r.p,{children:(0,a.jsx)(r.em,{children:"May 14, 2020"})})]}),"\n",(0,a.jsx)(r.h2,{id:"-new-features",children:"\ud83c\udf1f New features"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["Added ",(0,a.jsx)(r.code,{children:"Server.blockUntilShutdown()"})," which lets you wait for a ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/Server.html",children:"Server"})," to close. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2659",children:"#2659"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"Server server = Server.builder()...build();\nserver.start().join();\n// Returns when server.close() or closeAsync() is called.\nserver.blockUntilShutdown();\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["Added ",(0,a.jsx)(r.code,{children:"SystemInfo.defaultNonLoopbackIpV4Address()"})," which returns the sensible IPv4 address of the current\nmachine. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2679",children:"#2679"})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now specify authorization credentials conveniently when building a client: ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2680",children:"#2680"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'WebClient.builder("https://example.com/api")\n         // Basic\n         .auth(BasicToken.of("admin", "sesame"))\n         // OAuth 1a\n         .auth(OAuth1aToken.of(...))\n         // OAuth 2\n         .auth(OAuth2Token.of("token-0123456789abcdef"))\n         .build();\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["New ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/retry/RetryRule.html",children:"RetryRule"})," and ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/retry/RetryRuleWithContent.html",children:"RetryRuleWithContent"})," API let you define a complex retry policy\nconveniently. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/1634",children:"#1634"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2661",children:"#2661"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2709",children:"#2709"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"Backoff myBackoff = Backoff.exponential(1000, 60000)\n                           .withJitter(0.3)\n                           .withMaxAttempts(10);\nRetryRule retryRule =\n    RetryRule.of(RetryRule.builder()\n                          .onUnProcessed()\n                          .thenBackoff(myBackoff),\n                 RetryRule.builder()\n                          .onException(ResponseTimeoutException.class)\n                          .thenBackoff(),\n                 RetryRule.builder()\n                          .onStatus(HttpStatus.TOO_MANY_REQUESTS)\n                          .thenNoRetry())\n\nRetryingClient.newDecorator(retryRule);\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/circuitbreaker/CircuitBreakerListener.html",children:"CircuitBreakerListener"})," now has a new event listener method ",(0,a.jsx)(r.code,{children:"onInitialized()"}),", which is invoked\nwhen a circuit is initialized. By default, it simply delegates to ",(0,a.jsx)(r.code,{children:"onStateChanged()"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2675",children:"#2675"})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now register your server to or retrieve the ",(0,a.jsx)(r.a,{href:"typeplural://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/Endpoint.html",children:"Endpoint"})," from\na ",(0,a.jsx)(r.a,{href:"https://spring.io/guides/gs/service-registration-and-discovery/",children:"Eureka"})," registry server,\nwhich gives nice integration with Spring Cloud. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/707",children:"#707"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2701",children:"#2701"})]}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["Use ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/eureka/EurekaUpdatingListener.html",children:"EurekaUpdatingListener"})," for ",(0,a.jsx)(r.a,{href:"typeplural://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/Server.html",children:"Server"}),":"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'Server server = Server.builder()...build();\nserver.addListener(EurekaUpdatingListener.of("https://my-eureka-registry.com/"));\n// Automatically registers when the Server starts.\nserver.start().join();\n// Automatically deregisters when the Server stops.\nserver.stop().join();\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["Use ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/eureka/EurekaEndpointGroup.html",children:"EurekaEndpointGroup"})," for clients:"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'// Periodically retrieves the endpoint list from the registry.\nEndpointGroup group = EurekaEndpointGroup.of("https://my-eureka-registry/");\ngroup.whenReady().join();\n\n// Sends a request to the endpoints, spreading the load w/ weighted round-robin.\nWebClient client = WebClient.of(SessionProtocol.HTTP, group);\nSystem.err.println(client.get("/some-resource")\n                         .aggregate().join()\n                         .contentUtf8());\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now use the gRPC client stubs generated by ",(0,a.jsx)(r.a,{href:"https://github.com/grpc/grpc-kotlin",children:(0,a.jsx)(r.code,{children:"grpc-kotlin"})}),"\n",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2662",children:"#2662"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2669",children:"#2669"})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["Added a new Thrift serialization format ",(0,a.jsx)(r.code,{children:"TTEXT_NAMED_ENUM"}),". It is a variant of ",(0,a.jsx)(r.code,{children:"TTEXT"})," that serializes\nan ",(0,a.jsx)(r.code,{children:"enum"})," as a string instead of an integer. This can be useful when you need to serialize a ",(0,a.jsx)(r.code,{children:"TBase"}),"\nobject into a human-readable JSON. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2706",children:"#2706"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"ObjectMapper mapper = new ObjectMapper()\nmapper.registerModule(new ThriftJacksonModule(/* useNamedEnum */ true));\nString json = mapper.writeValueAsString(myTBaseStruct);\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["Added two Spring Boot annotations that inject the current local Armeria port(s) - ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/spring/LocalArmeriaPort.html",children:"@LocalArmeriaPort"})," and ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/spring/LocalArmeriaPorts.html",children:"@LocalArmeriaPorts"}),",\nwhich is useful when you bind at an ephemeral port or more than one port: ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2561",children:"#2561"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2684",children:"#2684"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"@Configuration\nclass MyConfiguration {\n    @LocalArmeriaPort(SessionProtocol.HTTP)\n    int httpPort;\n    @LocalArmeriaPort(SessionProtocol.HTTPS)\n    int httpsPort;\n    @LocalArmeriaPorts\n    List<Integer> ports;\n}\n"})}),"\n"]}),"\n"]}),"\n","\n",(0,a.jsx)(r.h2,{id:"-improvements",children:"\ud83d\udcc8 Improvements"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/zookeeper/ZooKeeperUpdatingListener.html",children:"ZooKeeperUpdatingListener"})," now updates the registry with both host name and IP address by default,\nso that the client does not have to do a DNS lookup. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2674",children:"#2674"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2679",children:"#2679"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["The IP address is retrieved from ",(0,a.jsx)(r.code,{children:"defaultNonLoopbackIpV4Address()"})," of ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/util/SystemInfo.html",children:"SystemInfo"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"\ufe0f-bug-fixes",children:"\ud83d\udee0\ufe0f Bug fixes"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Fixed a bug where more than one thread can consume from a streaming message. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2687",children:"#2687"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2683",children:"#2683"})]}),"\n",(0,a.jsxs)(r.li,{children:["You will not get a ",(0,a.jsx)(r.code,{children:"NullPointerException"})," anymore when starting a ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/jetty/JettyService.html",children:"JettyService"})," with DEBUG level\nlogging enabled. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2688",children:"#2688"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2691",children:"#2691"})]}),"\n",(0,a.jsxs)(r.li,{children:["PING interval now works as expected even if idle timeout is disabled. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2702",children:"#2702"})]}),"\n",(0,a.jsxs)(r.li,{children:["A connection is now closed immediately when PING fails, rather than waiting for idle timeout. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2699",children:"#2699"})]}),"\n",(0,a.jsxs)(r.li,{children:["A request sent to an HTTP/1 server behind an HTTP CONNECT proxy server is now handled properly. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2705",children:"#2705"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2698",children:"#2698"})]}),"\n",(0,a.jsxs)(r.li,{children:["An event loop does not block for too long anymore when:","\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Thrift TEXT protocol loads a class. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2692",children:"#2692"})]}),"\n",(0,a.jsxs)(r.li,{children:["A client makes a lot of requests for a short period. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2700",children:"#2700"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"\ufe0f-breaking-changes",children:"\u2622\ufe0f Breaking changes"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/auth/BasicToken.html",children:"BasicToken"}),", ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/auth/OAuth1aToken.html",children:"OAuth1aToken"})," and ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/auth/OAuth2Token.html",children:"OAuth2Token"})," have been moved to\n",(0,a.jsx)(r.code,{children:"com.linecorp.armeria.common.auth"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2680",children:"#2680"})]}),"\n",(0,a.jsxs)(r.li,{children:["Builder and factory methods of ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/retry/RetryingClient.html",children:"RetryingClient"})," need an explicit type parameter for\n",(0,a.jsx)(r.a,{href:"type://#",children:"RetryStrategy"})," when creating with a lambda expression. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2661",children:"#2661"})]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"-dependencies",children:"\u26d3 Dependencies"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Dropwizard 2.0.5 \u2192 2.0.9"}),"\n",(0,a.jsx)(r.li,{children:"Dropwizard Metrics 4.1.5 \u2192 4.1.7, 3.2.5 \u2192 3.2.6"}),"\n",(0,a.jsx)(r.li,{children:"gRPC 1.28.0 \u2192 1.29.0"}),"\n",(0,a.jsx)(r.li,{children:"Jackson 2.10.3 \u2192 2.11.0"}),"\n",(0,a.jsx)(r.li,{children:"java-jwt 3.10.2 \u2192 3.10.3"}),"\n",(0,a.jsx)(r.li,{children:"Jetty 9.4.27 \u2192 9.4.28"}),"\n",(0,a.jsx)(r.li,{children:"Micrometer 1.3.6 \u2192 1.5.1"}),"\n",(0,a.jsx)(r.li,{children:"Netty 4.1.48 \u2192 4.1.50"}),"\n",(0,a.jsx)(r.li,{children:"Prometheus simpleclient 0.8.1 \u2192 0.9.0"}),"\n",(0,a.jsx)(r.li,{children:"protobuf-jackson 1.0.0 \u2192 1.1.0"}),"\n",(0,a.jsx)(r.li,{children:"Reactor 3.3.4 \u2192 3.3.5"}),"\n",(0,a.jsx)(r.li,{children:"RxJava 3.0.1 \u2192 3.0.3"}),"\n",(0,a.jsx)(r.li,{children:"snappy-java 1.1.7 \u2192 1.1.7.5"}),"\n",(0,a.jsx)(r.li,{children:"Spring Boot 2.2.6 \u2192 2.2.7"}),"\n",(0,a.jsx)(r.li,{children:"Tomcat 9.0.33 \u2192 9.0.35, 8.5.53 \u2192 8.5.55"}),"\n",(0,a.jsx)(r.li,{children:"ZooKeeper 3.5.7 \u2192 3.5.8"}),"\n",(0,a.jsxs)(r.li,{children:["Shaded dependencies","\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Bouncy Castle 1.64 \u2192 1.65"}),"\n",(0,a.jsx)(r.li,{children:"Caffeine 2.8.1 \u2192 2.8.2"}),"\n",(0,a.jsx)(r.li,{children:"Guava 28.2 \u2192 29.0"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["Example dependencies","\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Kotlin 1.3.71 \u2192 1.3.72"}),"\n",(0,a.jsx)(r.li,{children:"Kotlin Coroutines 1.3.4 \u2192 1.3.6"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"-thank-you",children:"\ud83d\ude47 Thank you"}),"\n",(0,a.jsx)(n,{usernames:["andrewoma","anuraaga","Charliocat","eonezhang","gary-lo","ghkim3221","heowc","hexoul","hueneburg","ikhoon","imasahiro","jrhee17","KarboniteKream","max904-github","minwoox","mono0x","renaudb","shakuzen","syleeeee","tobias-","trustin"]})]})}function d(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}}}]);