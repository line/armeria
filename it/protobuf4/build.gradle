dependencies {
    // switch to the protobuf-v4 version
    testImplementation platform(libs.protobuf4.bom)
    
    testImplementation(project(':grpc'))
    testImplementation libs.javax.annotation
}

def grpcDir = "${rootProject.projectDir}/grpc"

task generateTestSources(type: Copy) {
    from("${grpcDir}/src/test/java")
    into "${project.ext.genSrcDir}/test/java"
    include "**/HttpJsonTranscoding*Test.java"
}

tasks.compileTestJava.dependsOn(tasks.generateTestSources)
tasks.processTestResources.from "${grpcDir}/src/test/resources"
