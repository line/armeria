"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[2285],{28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>l});var s=r(96540);const i={},t=s.createContext(i);function a(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(t.Provider,{value:n},e.children)}},31377:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"0.85.0","title":"v0.85.0","description":"New features","source":"@site/src/content/release-notes/0.85.0.mdx","sourceDirName":".","slug":"/0.85.0","permalink":"/release-notes/0.85.0","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site/src/content/release-notes/0.85.0.mdx","tags":[],"version":"current","frontMatter":{"date":"2019-05-17T00:00:00.000Z"},"sidebar":"defaultSidebar","previous":{"title":"v0.86.0","permalink":"/release-notes/0.86.0"},"next":{"title":"v0.84.0","permalink":"/release-notes/0.84.0"}}');var i=r(74848),t=r(28453);const a={date:new Date("2019-05-17T00:00:00.000Z")},l="v0.85.0",d={},c=[{value:"New features",id:"new-features",level:2},{value:"Bug fixes",id:"bug-fixes",level:2},{value:"Breaking changes",id:"breaking-changes",level:2},{value:"Deprecations",id:"deprecations",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Thank you",id:"thank-you",level:2}];function o(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components},{ThankYou:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ThankYou",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.header,{children:[(0,i.jsx)(n.h1,{id:"v0850",children:"v0.85.0"}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"May 17, 2019"})})]}),"\n",(0,i.jsx)(n.h2,{id:"new-features",children:"New features"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You can now bind your Service to a certain HTTP method or enable HTTP content-type negotiation very easily with the new ",(0,i.jsx)(n.code,{children:"ServerBuilder.route()"})," method. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1737",children:"#1737"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'ServerBuilder sb = new ServerBuilder();\nsb.route()\n  .get("/users/{id}")\n  .delete("/users/{id}")\n  .post("/users")\n  .consumes(MediaType.JSON)\n  .produces(MediaType.JSON_UTF_8)\n  .build(new MyUserService());\n\n// You can also configure using a lambda expression.\nsb.withRoute(b -> {\n    b.path("/foo")\n     .build(new MyFooService());\n});\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["It is now also possible to specify different settings for different services using the new ",(0,i.jsx)(n.code,{children:"route()"})," method. It means you can specify a large timeout for a certain service only conveniently. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1737",children:"#1737"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'ServerBuilder sb = new ServerBuilder();\nsb.route()\n  .path("/long_poll")\n  .requestTimeoutMillis(0) // Disable timeout for /service.\n  .build(new MyLongPollingService());\nsb.route()\n  .path("/get_now")\n  .build(new MyOtherService()); // Use the default timeout.\n```java\n\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["We revamped our ",(0,i.jsx)(n.code,{children:"HttpHeaders"})," API to make it cleaner and safer. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1731",children:"#1731"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"HttpHeaders"})," has been split into three types:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RequestHeaders"})," for request headers with ",(0,i.jsx)(n.code,{children:":method"})," and ",(0,i.jsx)(n.code,{children:":path"})," header"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ResponseHeaders"})," for response headers with ",(0,i.jsx)(n.code,{children:":status"})," header"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"HttpHeaders"})," for trailers and other headers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RequestHeaders"})," and ",(0,i.jsx)(n.code,{children:"ResponseHeaders"})," extend ",(0,i.jsx)(n.code,{children:"HttpHeaders"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"HttpHeaders"})," and its subtypes are immutable and thus must be built using a factory method or a builder."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Quick examples:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'RequestHeaders reqHdrs = RequestHeaders.of(HttpMethod.GET, "/get",\n                                           HttpHeaderNames.ACCEPT, MediaType.JSON_UTF_8);\nRequestHeaders newReqHdrs = reqHdrs.toBuilder()\n                                   .add("foo", "bar")\n                                   .build();\nResponseHeaders resHdrs = ResponseHeaders.of(200 /* OK */);\n\nHttpHeaders hdrs = HttpHeaders.builder()\n                              .add("alice", "bob");\n                              .build();\nHttpHeaders newHdrs = hdrs.withMutations(builder -> {\n    builder.add("charlie", "debora");\n});\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.code,{children:"HttpHeaders"})," Javadoc for more examples."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You can now test your Armeria app with JUnit 5. A new module ",(0,i.jsx)(n.code,{children:"armeria-testing-junit5"})," has been added with the following extensions: ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1736",children:"#1736"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"com.linecorp.armeria.testing.junit.server.ServerExtension"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"com.linecorp.armeria.testing.junit.server.SelfSignedCertificateExtension"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"com.linecorp.armeria.testing.junit.common.EventLoopGroupExtension"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"com.linecorp.armeria.testing.junit.common.EventLoopExtension"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You can now customize the behavior of gRPC JSON marshaller. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1696",children:"#1696"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1753",children:"#1753"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"ServerBuilder sb = new ServerBuilder();\nsb.service(new GrpcServiceBuilder()\n               .addService(new MyServiceImpl())\n               .supportedSerializationFormats(GrpcSerializationFormats.values())\n               .jsonMarshallerCustomizer(marshaller -> {\n                   marshaller.preservingProtoFieldNames(true);\n               })\n               .build());\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You can now write a unary gRPC client without depending on grpc-java at all. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1703",children:"#1703"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1748",children:"#1748"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1751",children:"#1751"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'HelloRequest req = HelloRequest.newBuilder()\n                               .setName("Alice")\n                               .build();\nUnaryGrpcClient client = new UnaryGrpcClient(HttpClient.of("http://127.0.0.1:8080"));\nbyte[] resBytes = client.execute("/com.example.HelloService/Greet",\n                                 req.toByteArray()).join();\nHelloResponse res = HelloResponse.parseFrom(resBytes);\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You can now use ",(0,i.jsx)(n.code,{children:"GrpcServiceRegistrationBean"})," to register a gRPC service when using Spring Boot integration. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1749",children:"#1749"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Bean\npublic GrpcServiceRegistrationBean helloService() {\n    return new GrpcServiceRegistrationBean()\n        .setServiceName("helloService")\n        .setService(new GrpcServiceBuilder()\n                        .addService(new HelloService())\n                        .supportedSerializationFormats(GrpcSerializationFormats.values())\n                        .enableUnframedRequests(true)\n                        .build())\n        .setDecorators(LoggingService.newDecorator())\n        .setExampleRequests(List.of(ExampleRequest.of(HelloServiceGrpc.SERVICE_NAME,\n                                                      "Hello",\n                                                      HelloRequest.newBuilder()\n                                                                  .setName("Armeria")\n                                                                  .build())));\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You can now use ",(0,i.jsx)(n.code,{children:"wildcard"})," pattern when specifying built-in properties in Logback ",(0,i.jsx)(n.code,{children:"RequestContextExportingAppender"}),". ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/489",children:"#489"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1742",children:"#1742"})]}),"\n"]}),"\n"]}),"\n","\n",(0,i.jsx)(n.h2,{id:"bug-fixes",children:"Bug fixes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Trailing slashes in a path pattern is now handled correctly. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1741",children:"#1741"})]}),"\n",(0,i.jsxs)(n.li,{children:["It is now disallowed to apply ",(0,i.jsx)(n.code,{children:"CorsDecorator"})," more than once. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1740",children:"#1740"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"HttpTracingClient"})," and ",(0,i.jsx)(n.code,{children:"HttpTracingService"})," now adds a valid addressable ",(0,i.jsx)(n.code,{children:"http.url"})," tag. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1733",children:"#1733"})," ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1762",children:"#1762"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"SessionProtocol"})," and ",(0,i.jsx)(n.code,{children:"SerializationFormat"})," are now added to ",(0,i.jsx)(n.code,{children:"http.protocol"})," and ",(0,i.jsx)(n.code,{children:"http.serfmt"})," tag instead."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"breaking-changes",children:"Breaking changes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Artifact armeria-testing has been renamed to ",(0,i.jsx)(n.code,{children:"armeria-testing-junit4"}),". Please update your project dependencies. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1736",children:"#1736"})]}),"\n",(0,i.jsxs)(n.li,{children:["Many places in the public API that use ",(0,i.jsx)(n.code,{children:"HttpHeaders"})," as a parameter or a return value have been changed due to the revamped ",(0,i.jsx)(n.code,{children:"HttpHeaders"})," API. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1731",children:"#1731"})]}),"\n",(0,i.jsxs)(n.li,{children:["The following ",(0,i.jsx)(n.code,{children:"ServerBuilder"})," methods were removed:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"virtualHost(VirtualHost)"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"defaultVirtualHost(VirtualHost)"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"deprecations",children:"Deprecations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["The default prefix found in various configuration properties has been deprecated. Use the property setters without the default prefix. ",(0,i.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1737",children:"#1737"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"ServerBuilder sb = new ServerBuilder();\n// Do NOT use this:\nsb.defaultRequestTimeout(...);\n// Use this:\nsb.requestTimeout(...);\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"HttpHeaders.EMPTY"})," has been deprecated. Use ",(0,i.jsx)(n.code,{children:"HttpHeaders.of()"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Dropwizard Metrics 4.0.5 -> 4.1.0"}),"\n",(0,i.jsx)(n.li,{children:"Jetty 9.4.17 -> 9.4.18"}),"\n",(0,i.jsx)(n.li,{children:"Project Reactor 3.2.8 -> 3.2.9"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"thank-you",children:"Thank you"}),"\n",(0,i.jsx)(r,{usernames:["anuraaga","codefromthecrypt","delegacy","ejona86","hyangtack","huydx","karthikraman22","masonshin","matsumana","minwoox","trustin"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);