"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[1059],{28453:(e,r,t)=>{t.d(r,{R:()=>a,x:()=>o});var i=t(96540);const n={},s=i.createContext(n);function a(e){const r=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),i.createElement(s.Provider,{value:r},e.children)}},48908:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"tutorials/thrift/run-service","title":"Running a service","description":"In this step, we\'ll do three things with the code we obtained from our Thrift file; define the blog service in Java, create a server instance, and run the service.","source":"@site/src/content/docs/tutorials/thrift/02-run-service.mdx","sourceDirName":"tutorials/thrift","slug":"/tutorials/thrift/run-service","permalink":"/docs/tutorials/thrift/run-service","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site/src/content/docs/tutorials/thrift/02-run-service.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_label":"2. Run a service","category":"thrift","type":"step","targetLang":"java"},"sidebar":"docsSidebar","previous":{"title":"1. Define a service","permalink":"/docs/tutorials/thrift/define-service"},"next":{"title":"3. Implement CREATE","permalink":"/docs/tutorials/thrift/implement-create"}}');var n=t(74848),s=t(28453);const a={sidebar_label:"2. Run a service",category:"thrift",type:"step",targetLang:"java"},o="Running a service",l={},c=[{value:"What you need",id:"what-you-need",level:2},{value:"1. Implement the service",id:"1-implement-the-service",level:2},{value:"2. Override service methods",id:"2-override-service-methods",level:2},{value:"3. Create a server",id:"3-create-a-server",level:2},{value:"4. Run the server",id:"4-run-the-server",level:2},{value:"What&#39;s next",id:"whats-next",level:2}];function d(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components},{TutorialSteps:t}=r;return t||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("TutorialSteps",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"running-a-service",children:"Running a service"})}),"\n",(0,n.jsx)(r.p,{children:"In this step, we'll do three things with the code we obtained from our Thrift file; define the blog service in Java, create a server instance, and run the service."}),"\n",(0,n.jsx)(t,{current:2}),"\n",(0,n.jsx)(r.h2,{id:"what-you-need",children:"What you need"}),"\n",(0,n.jsxs)(r.p,{children:["You need to have the ",(0,n.jsx)(r.a,{href:"/docs/tutorials/thrift/define-service#3-compile-the-thrift-file",children:"generated Java code"})," obtained from the previous step.\nYou can always ",(0,n.jsx)(r.a,{href:"https://github.com/line/armeria-examples/tree/main/tutorials/thrift",children:"download"})," the full version, instead of creating one yourself."]}),"\n",(0,n.jsx)(r.h2,{id:"1-implement-the-service",children:"1. Implement the service"}),"\n",(0,n.jsxs)(r.p,{children:["Create a file, ",(0,n.jsx)(r.code,{children:"BlogServiceImpl.java"}),", and declare the ",(0,n.jsx)(r.code,{children:"BlogServiceImpl"})," class implementing the ",(0,n.jsx)(r.code,{children:"BlogService"})," service we defined earlier in ",(0,n.jsx)(r.a,{href:"/docs/tutorials/thrift/define-service",children:"Step 1. Define a service"}),"."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:'title="BlogServiceImpl.java"',children:"package example.armeria.server.blog.thrift;\n\nimport example.armeria.blog.thrift.BlogService;\n\npublic class BlogServiceImpl implements BlogService.AsyncIface {}\n"})}),"\n",(0,n.jsx)(r.h2,{id:"2-override-service-methods",children:"2. Override service methods"}),"\n",(0,n.jsx)(r.p,{children:"Add empty service methods as follows to override the service methods.\nWe'll implement the service methods one by one in this tutorial.\nLet's leave them empty for now."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:'title="BlogServiceImpl.java"',children:"import example.armeria.blog.thrift.BlogPost;\nimport example.armeria.blog.thrift.CreateBlogPostRequest;\nimport example.armeria.blog.thrift.GetBlogPostRequest;\nimport example.armeria.blog.thrift.ListBlogPostsRequest;\nimport example.armeria.blog.thrift.ListBlogPostsResponse;\nimport example.armeria.blog.thrift.UpdateBlogPostRequest;\nimport example.armeria.blog.thrift.DeleteBlogPostRequest;\nimport org.apache.thrift.TException;\nimport org.apache.thrift.async.AsyncMethodCallback;\n\npublic class BlogServiceImpl implements BlogService.AsyncIface {\n\n  @Override\n  public void createBlogPost(CreateBlogPostRequest request, AsyncMethodCallback<BlogPost> resultHandler)\n          throws TException {}\n\n  @Override\n  public void getBlogPost(GetBlogPostRequest request, AsyncMethodCallback<BlogPost> resultHandler)\n          throws TException {}\n\n  @Override\n  public void listBlogPosts(ListBlogPostsRequest request, AsyncMethodCallback<ListBlogPostsResponse> resultHandler)\n          throws TException {}\n\n  @Override\n  public void updateBlogPost(UpdateBlogPostRequest request, AsyncMethodCallback<BlogPost> resultHandler)\n          throws TException {}\n\n  @Override\n  public void deleteBlogPost(DeleteBlogPostRequest request, AsyncMethodCallback<Void> resultHandler)\n          throws TException {}\n}\n"})}),"\n",(0,n.jsx)(r.h2,{id:"3-create-a-server",children:"3. Create a server"}),"\n",(0,n.jsx)(r.p,{children:"Let's create a server to serve our service."}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["Create the ",(0,n.jsx)(r.code,{children:"Main"})," class for the server.\nYou can see the full version of the file ",(0,n.jsx)(r.a,{href:"https://github.com/line/armeria-examples/tree/main/tutorials/thrift/src/main/java/example/armeria/server/blog/thrift/Main.java",children:"here"}),"."]}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:'title="Main.java"',children:"package example.armeria.server.blog.thrift;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic final class Main {\n  private static final Logger logger = LoggerFactory.getLogger(Main.class);\n}\n"})}),"\n",(0,n.jsxs)(r.ol,{start:"2",children:["\n",(0,n.jsxs)(r.li,{children:["Add the ",(0,n.jsx)(r.code,{children:"newServer()"})," method in the ",(0,n.jsx)(r.code,{children:"Main"})," class as follows.\nWe are using Armeria's ",(0,n.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/thrift/THttpService.html",children:"THttpService"})," to handle Thrift calls."]}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:'title="Main.java"',children:"import com.linecorp.armeria.server.Server;\nimport com.linecorp.armeria.server.thrift.THttpService;\n...\nprivate static Server newServer(int port) throws Exception {\n  final THttpService tHttpService =\n            THttpService.builder()\n                        .addService(new BlogServiceImpl())\n                        .build();\n}\n"})}),"\n",(0,n.jsxs)(r.ol,{start:"3",children:["\n",(0,n.jsxs)(r.li,{children:["Create and return a server instance using Armeria's ",(0,n.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/ServerBuilder.html",children:"ServerBuilder"}),".\nNote that the service instance, ",(0,n.jsx)(r.code,{children:"tHttpService"}),", is added to the server instance."]}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:'title="Main.java"',children:'private static Server newServer(int port) throws Exception {\n  ...\n  return Server.builder()\n               .http(port)\n               .service("/thrift", tHttpService) // Add the service to server\n               .build();\n}\n'})}),"\n",(0,n.jsxs)(r.ol,{start:"4",children:["\n",(0,n.jsxs)(r.li,{children:["Add the ",(0,n.jsx)(r.code,{children:"main()"})," method in the ",(0,n.jsx)(r.code,{children:"Main"})," class as follows."]}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:'title="Main.java"',children:'public static void main(String[] args) throws Exception {\n  final Server server = newServer(8080);\n\n  server.closeOnJvmShutdown().thenRun(() -> {\n    logger.info("Server has been stopped.");\n  });\n\n  server.start().join();\n}\n'})}),"\n",(0,n.jsx)(r.h2,{id:"4-run-the-server",children:"4. Run the server"}),"\n",(0,n.jsxs)(r.p,{children:["Run the ",(0,n.jsx)(r.code,{children:"Main.main()"})," method on your IDE or using Gradle."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"./gradlew run\n"})}),"\n",(0,n.jsx)(r.p,{children:"Your server is running if you see the following message."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"[armeria-boss-http-*:8080] INFO com.linecorp.armeria.server.Server - Serving HTTP at /[0:0:0:0:0:0:0:0]:8080 - http://127.0.0.1:8080/\n"})}),"\n",(0,n.jsx)(r.h2,{id:"whats-next",children:"What's next"}),"\n",(0,n.jsx)(r.p,{children:"In this step, we've created and added an empty Thrift service to a server."}),"\n",(0,n.jsxs)(r.p,{children:["Next, we'll get on with implementing a service method for ",(0,n.jsx)(r.a,{href:"/docs/tutorials/thrift/implement-create",children:"creating blog posts"}),"."]}),"\n",(0,n.jsx)(t,{current:2})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}}}]);