"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[6310],{28453:(e,r,n)=>{n.d(r,{R:()=>t,x:()=>c});var i=n(96540);const a={},s=i.createContext(a);function t(e){const r=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),i.createElement(s.Provider,{value:r},e.children)}},29823:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>c,default:()=>d,frontMatter:()=>t,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"1.15.0","title":"v1.15.0","description":"\ud83c\udf38 Highlights","source":"@site/src/content/release-notes/1.15.0.mdx","sourceDirName":".","slug":"/1.15.0","permalink":"/release-notes/1.15.0","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site-new/src/content/release-notes/1.15.0.mdx","tags":[],"version":"current","frontMatter":{"date":"2022-03-24T00:00:00.000Z"},"sidebar":"defaultSidebar","previous":{"title":"v1.16.0","permalink":"/release-notes/1.16.0"},"next":{"title":"v1.14.1","permalink":"/release-notes/1.14.1"}}');var a=n(74848),s=n(28453);const t={date:new Date("2022-03-24T00:00:00.000Z")},c="v1.15.0",o={},l=[{value:"\ud83c\udf38 Highlights",id:"-highlights",level:2},{value:"\ud83c\udf1f New features",id:"-new-features",level:2},{value:"\ud83d\udcc8 Improvements",id:"-improvements",level:2},{value:"\ud83d\udee0\ufe0f Bug fixes",id:"\ufe0f-bug-fixes",level:2},{value:"\ud83c\udfda\ufe0f Deprecations",id:"\ufe0f-deprecations",level:2},{value:"\u2622\ufe0f Breaking changes",id:"\ufe0f-breaking-changes",level:2},{value:"\u26d3 Dependencies",id:"-dependencies",level:2},{value:"\ud83d\ude47 Thank you",id:"-thank-you",level:2}];function h(e){const r={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components},{ThankYou:n}=r;return n||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ThankYou",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.header,{children:[(0,a.jsx)(r.h1,{id:"v1150",children:"v1.15.0"}),(0,a.jsx)(r.p,{children:(0,a.jsx)(r.em,{children:"March 24, 2022"})})]}),"\n",(0,a.jsx)(r.h2,{id:"-highlights",children:"\ud83c\udf38 Highlights"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"gRPC health check protocol"}),"\n",(0,a.jsx)(r.li,{children:"Multipart file uploads in annotated services"}),"\n",(0,a.jsxs)(r.li,{children:["Preliminary GraphQL support in ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})]}),"\n",(0,a.jsx)(r.li,{children:"Refactored DNS resolver cache with higher hit ratio and reduced traffic"}),"\n",(0,a.jsx)(r.li,{children:"New metrics that help you get alerts before your TLS certificates are expired"}),"\n"]}),"\n","\n",(0,a.jsx)(r.h2,{id:"-new-features",children:"\ud83c\udf1f New features"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/Server.html",children:"Server"})," now registers two gauges about TLS certificate expiry, so you can get alerts before\nthe certificates are expired. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4075",children:"#4075"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4082",children:"#4082"})]}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"armeria_server_certificate_validity"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"1"})," if certificate is in validity period. ",(0,a.jsx)(r.code,{children:"0"})," otherwise."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"armeria_server_certificate_validity_days"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["The number of days before certificate expires, or ",(0,a.jsx)(r.code,{children:"-1"})," if expired."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now specify a ",(0,a.jsx)(r.code,{children:"File"})," or ",(0,a.jsx)(r.code,{children:"Path"})," parameter in your annotated service method to handle multipart file\nuploads. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3578",children:"#3578"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4061",children:"#4061"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'Server\n  .builder()\n  .annotatedService(new Object() {\n    @Post("/upload")\n    @Consumes("multipart/form-data")\n    public String upload(@Param File file) {\n      return "Successfully uploaded a file to " + file;\n    }\n  })\n  .build();\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now use the ",(0,a.jsx)(r.code,{children:"||"})," (logical OR) operator in parameter and header predicate expressions. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4116",children:"#4116"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4138",children:"#4138"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'// "Hi!" for /greet?casual or /greet?casual=true\n// "Hello!" for /greet or /greet?casual=false\nServer\n  .builder()\n  .route()\n    .get("/greet")\n    .matchesParam("casual || casual=true") // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n    .build((ctx, req) -> HttpResponse.of("Hi!"))\n  .route()\n    .get("/greet")\n    .matchesParam("!casual || casual!=true") // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n    .build(ctx, req) -> HttpResponse.of("Hello!"))\n'})}),"\n",(0,a.jsx)(r.admonition,{type:"tip",children:(0,a.jsxs)(r.p,{children:["You can use the same syntax in ",(0,a.jsx)(r.a,{href:"/docs/server/annotated-service",children:"annotated services"}),"\nusing ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/annotation/MatchesParam.html",children:"@MatchesParam"})," and ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/annotation/MatchesHeader.html",children:"@MatchesHeader"}),"."]})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now enable ",(0,a.jsx)(r.a,{href:"https://github.com/grpc/grpc/blob/master/src/proto/grpc/health/v1/health.proto",children:"gRPC health check protocol"}),"\nwith ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/grpc/GrpcHealthCheckService.html",children:"GrpcHealthCheckService"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3146",children:"#3146"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3963",children:"#3963"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"Server\n  .builder()\n  .service(\n    GrpcService\n      .builder()\n      .addService(new MyGrpcService())\n      .enableHealthCheckService(true) // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n      // or customize:\n      // .addService(GrpcHealthCheckService.of(...))\n      .build()\n  )\n  .build()\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})," now supports ",(0,a.jsx)(r.a,{href:"type://#",children:"GraphQlService"})," with CodeMirror auto-completion. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3706",children:"#3706"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4023",children:"#4023"})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now configure the ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/endpoint/EndpointGroup.html",children:"EndpointGroup"})," implementations based on ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/endpoint/DynamicEndpointGroup.html",children:"DynamicEndpointGroup"}),"\nto allow or disallow empty endpoints. This can be useful when you want to avoid the situation where\nthe endpoint group becomes empty due to misconfiguration. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3952",children:"#3952"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3958",children:"#3958"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'EndpointGroup endpointGroup =\n  DnsAddressEndpointGroup\n    .builder("example.com")\n    .allowEmptyEndpoints(false) // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n    .build();\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now configure the timeout of DNS sub-queries with ",(0,a.jsx)(r.code,{children:"queryTimeoutMillisForEachAttempt()"}),". Previously,\nyou were only able to specify the timeout for the entire DNS resolution process, which can consist of more\nthan one DNS query. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2940",children:"#2940"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4133",children:"#4133"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'DnsAddressEndpointGroup\n  .builder("armeria.dev")\n  .queryTimeoutMillisForEachAttempt(1000) // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n  .queryTimeoutMillis(5000)\n  .build();\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["Armeria now has the global shared DNS cache by default for higher hit ratio and less DNS traffic.\nYou can also build and share a custom DNS cache across multiple resolvers. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2940",children:"#2940"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4133",children:"#4133"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'DnsCache dnsCache =\n  DnsCache\n    .builder()\n    .ttl(60, 3600)\n    .negativeTtl(600)\n    .build();\n\nEndpointGroup endpointGroup =\n  DnsAddressEndpointGroup\n    .builder("armeria.dev")\n    .dnsCache(dnsCache) // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n    .build();\n\nClientFactory factory =\n  ClientFactory\n    .builder()\n    .domainNameResolverCustomizer(builder -> {\n      builder.dnsCache(dnsCache); // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n    })\n    .build();\n\nWebClient client =\n  WebClient\n    .builder(SessionProtocol.HTTPS, endpointGroup) // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n    .factory(factory) // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n    .build();\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["Failed search domain queries are now cached according to the negative TTL configuration. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2940",children:"#2940"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4133",children:"#4133"})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now specify a ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/SuccessFunction.html",children:"SuccessFunction"})," when constructing a client or server, and let all decorators\nuse it for determining whether a request was successful or not. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4101",children:"#4101"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"Server\n  .builder()\n  .successFunction((ctx, log) -> { // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n    // Treat only '200 OK' and '204 No Content' as success.\n    switch (log.responseStatus().code()) {\n      case 200:\n      case 204:\n        return true;\n      default:\n        return false;\n    }\n  })\n  .decorator(LoggingService.newDecorator())\n  .decorator(MetricCollectingService.newDecorator())\n  ...\n\nWebClient\n  .builder()\n  .successFunction(...) // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n  .decorator(LoggingClient.newDecorator())\n  .decorator(MetricCollectingClient.newDecorator())\n  .build();\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now specify different sampling ratio (or ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/util/Sampler.html",children:"Sampler"}),") for successful and failed requests\nwhen using ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/logging/LoggingClient.html",children:"LoggingClient"})," and ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/logging/LoggingService.html",children:"LoggingService"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3666",children:"#3666"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4101",children:"#4101"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"LoggingService\n  .builder()\n  // Log at 10% sampling ratio if successful.\n  .successSamplingRate(0.1)\n  // Log all failure.\n  .failureSamplingRate(1.0)\n  .newDecorator()\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now customize how ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/logging/LoggingClient.html",children:"LoggingClient"})," and ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/logging/LoggingService.html",children:"LoggingService"})," determines log level\nmore flexibly. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3972",children:"#3972"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'LoggingService\n  .builder()\n  // Log at INFO if under /important. DEBUG otherwise.\n  .requestLogLevelMapper(log -> {\n    if (log.requestHeaders().path().startsWith("/important/")) {\n      return LogLevel.INFO;\n    } else {\n      return LogLevel.DEBUG;\n    }\n  })\n  // Log at INFO if 200 OK.\n  .responseLogLevel(HttpStatus.OK, LogLevel.INFO)\n  // Log at WARN if 5xx.\n  .responseLogLevel(HttpStatusClass.SERVER_ERROR, LogLevel.WARN)\n  .newDecorator()\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now specify a customizer that customizes a ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/ClientRequestContext.html",children:"ClientRequestContext"})," when building a client. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4075",children:"#4075"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4082",children:"#4082"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"WebClient client =\n  WebClient\n    .builder()\n    .contextCustomizer(ctx -> { // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n      String userId = MyUserContext.current().getId();\n      ctx.setAttr(USER_ID, userId);\n    })\n    .build();\n"})}),"\n",(0,a.jsxs)(r.p,{children:["For instance, you could manually propagate a Brave thread-local ",(0,a.jsx)(r.code,{children:"TraceContext"})," using it:"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"Tracing reactorTracing = ...;\nTracing requestContextTracing =\n  Tracing\n    .newBuilder()\n    .currentTraceContext(RequestContextCurrentTraceContext.ofDefault())\n    .build();\n\nWebClient\n  .builder()\n  .contextCustomizer(TraceContextPropagation.inject(() -> {\n    // Propagate Reactor's TraceContext to Armeria's TraceContext.\n    return reactorTracing.currentTraceContext().get();\n  })\n  .decorator(BraveClient.newDecorator(requestContextTracing))\n  .build();\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now write the content of ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html",children:"StreamMessage"})," into a file using\n",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html#writeTo(java.util.function.Function,java.nio.file.Path,java.nio.file.OpenOption...)",children:"StreamMessage#writeTo(Function,Path,OpenOption)"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4048",children:"#4048"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4130",children:"#4130"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'SplitHttpResponse res =\n  WebClient\n    .of()\n    .get("https://example.com/large_file")\n    .split();\nStreamMessage<HttpData> body = res.body();\nbody.writeTo( // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n  Function.identity(),\n  Path.of("/tmp", "large_file")\n);\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now convert a ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html",children:"StreamMessage"})," into an ",(0,a.jsx)(r.code,{children:"InputStream"})," using\n",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html#toInputStream(java.util.function.Function)",children:"StreamMessage#toInputStream(Function)"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4059",children:"#4059"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'StreamMessage<HttpData> body = ...;\nBufferedReader in = new BufferedReader(\n  new InputStreamReader(\n    body.toInputStream(Function.identity()), // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n    "UTF-8"\n  )\n);\nfor (;;) {\n  String line = in.readLine();\n  if (line == null) break;\n  System.out.println(line);\n}\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now use ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html#mapParallel(java.util.function.Function,int)",children:"StreamMessage#mapParallel(Function,int)"})," to modify a stream using an async operation\nwith a configurable concurrency limit. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4031",children:"#4031"})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now decode a ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html",children:"StreamMessage"})," into another using ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html#decode(com.linecorp.armeria.common.stream.StreamDecoder)",children:"StreamMessage#decode(StreamDecoder)"}),"\nwhich was previously possible only for ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/HttpMessage.html",children:"HttpMessage"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4147",children:"#4147"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4148",children:"#4148"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4152",children:"#4152"})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now give Armeria a performance optimization hint by specifying if your service is unary,\nrequest-streaming, response-streaming or bidi-streaming by implementing ",(0,a.jsx)(r.a,{href:"type://#",children:"HttpService#exchangeType()"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3956",children:"#3956"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'class MyUnaryService implements HttpService {\n  @Override\n  public HttpResponse serve(ServiceRequestContext ctx, HttpRequest req) {\n    return HttpResponse.from(\n      req\n        .aggregate() // Always aggregate\n        .thenApply(aggregatedReq -> {\n          HttpResponse.of( // Never streaming\n            "You sent %d bytes.",\n            aggregatedReq.content().length()\n          );\n        })\n    );\n  }\n\n  // Tells Armeria to assume non-streaming requests and responses.\n  @Override\n  public ExchangeType exchangeType() {\n    return ExchangeType.UNARY; // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n  }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"-improvements",children:"\ud83d\udcc8 Improvements"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Spring Boot ",(0,a.jsx)(r.code,{children:"WebServerException"})," message is now more user-friendly. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4146",children:"#4146"})]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"\ufe0f-bug-fixes",children:"\ud83d\udee0\ufe0f Bug fixes"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["A response with status code ",(0,a.jsx)(r.code,{children:"408"})," doesn't trigger a ",(0,a.jsx)(r.code,{children:"NullPointerException"})," anymore, even if its reason phrase\nis not exactly ",(0,a.jsx)(r.code,{children:"Request Timeout"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4165",children:"#4165"})]}),"\n",(0,a.jsxs)(r.li,{children:["Failed search domain queries are now cached properly according to the negative TTL configuration. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2940",children:"#2940"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4133",children:"#4133"})]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/grpc/GrpcService.html",children:"GrpcService"})," now logs ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RequestOnlyLog.html#requestContent()",children:"RequestOnlyLog#requestContent()"})," for invalid requests. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4128",children:"#4128"})]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})," doesn't crash the whole Armeria service anymore when ",(0,a.jsx)(r.code,{children:".proto"})," files have comments\non service options or extensions. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4123",children:"#4123"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4127",children:"#4127"})]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"type://#",children:"GraphQlService"})," doesn't throw a ",(0,a.jsx)(r.code,{children:"ClassCastException"})," anymore when ",(0,a.jsx)(r.code,{children:"query"})," or ",(0,a.jsx)(r.code,{children:"operationName"})," are not\na string. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4104",children:"#4104"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4168",children:"#4168"})]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/file/FileService.html",children:"FileService"})," doesn't choose a ",(0,a.jsx)(r.code,{children:".br"})," file for generating decompressed content anymore when Brotli\nis not available. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4119",children:"#4119"})]}),"\n",(0,a.jsxs)(r.li,{children:["You no longer see an ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/HttpResponseException.html",children:"HttpResponseException"})," or ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/HttpStatusException.html",children:"HttpStatusException"})," from built-in services. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4056",children:"#4056"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4117",children:"#4117"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Thanks to this fix, you can now mutate a redirect response from ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/file/FileService.html",children:"FileService"})," in your decorator\nusing ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/HttpResponse.html#mapHeaders(java.util.function.Function)",children:"HttpResponse#mapHeaders(Function)"})]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"type://#",children:"RampingUpEndpointWeightSelector"})," doesn't raise a ",(0,a.jsx)(r.code,{children:"NoSuchElementException"})," anymore when endpoints\nare replaced completely. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3776",children:"#3776"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4102",children:"#4102"})]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"\ufe0f-deprecations",children:"\ud83c\udfda\ufe0f Deprecations"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"samplingRate"})," property of ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/annotation/decorator/LoggingDecorator.html",children:"@LoggingDecorator"})," has been deprecated in favor of ",(0,a.jsx)(r.code,{children:"successSamplingRate"}),"\nand ",(0,a.jsx)(r.code,{children:"failureSamplingRate"}),"."]}),"\n",(0,a.jsxs)(r.li,{children:["The ",(0,a.jsx)(r.code,{children:"successFunction()"})," builder methods that require a ",(0,a.jsx)(r.code,{children:"BiPredicate"})," has been deprecated in favor of\n",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/SuccessFunction.html",children:"SuccessFunction"})," that's specified when constructing a client or server."]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"dnsServerAddressStreamProvider()"})," has been deprecated in favor of ",(0,a.jsx)(r.code,{children:"serverAddressStreamProvider()"})," in the\nDNS-related builders."]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"disableDnsQueryMetrics()"})," has been deprecated in favor of ",(0,a.jsx)(r.code,{children:"enableDnsQueryMetrics()"})," in the DNS-related\nbuilders."]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"\ufe0f-breaking-changes",children:"\u2622\ufe0f Breaking changes"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["The experimental ",(0,a.jsx)(r.code,{children:"HttpDecoder"})," API has been replaced with ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/encoding/StreamDecoder.html",children:"StreamDecoder"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4147",children:"#4147"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4152",children:"#4152"})]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"-dependencies",children:"\u26d3 Dependencies"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Bucket4j 7.0.0 \u2192 7.3.0"}),"\n",(0,a.jsx)(r.li,{children:"Curator 5.2.0 \u2192 5.2.1"}),"\n",(0,a.jsx)(r.li,{children:"Dropwizard Metrics 4.2.7 \u2192 4.2.9"}),"\n",(0,a.jsx)(r.li,{children:"gRPC-Java 1.43.2 \u2192 1.45.0"}),"\n",(0,a.jsx)(r.li,{children:"Jackson 2.13.1 \u2192 2.13.2"}),"\n",(0,a.jsx)(r.li,{children:"java-jwt 3.18.3 \u2192 3.19.0"}),"\n",(0,a.jsx)(r.li,{children:"Jetty 9.4.44 \u2192 9.4.45"}),"\n",(0,a.jsx)(r.li,{children:"Graphql-Java 17.3 \u2192 18.0"}),"\n",(0,a.jsx)(r.li,{children:"Logback 1.2.10 \u2192 1.2.11"}),"\n",(0,a.jsx)(r.li,{children:"Micrometer 1.8.2 \u2192 1.8.4"}),"\n",(0,a.jsxs)(r.li,{children:["Netty 4.1.73 \u2192 4.1.75","\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"io_uring 0.0.11 \u2192 0.0.13"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.li,{children:"Prometheus 0.14.1 \u2192 0.15.0"}),"\n",(0,a.jsxs)(r.li,{children:["Reactor 3.4.14 \u2192 3.4.16","\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Reactor Kotlin 1.1.5 \u2192 1.1.6"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.li,{children:"RxJava 3.1.3 \u2192 3.1.4"}),"\n",(0,a.jsx)(r.li,{children:"Sangria 2.1.6 \u2192 3.0.0"}),"\n",(0,a.jsx)(r.li,{children:"ScalaPB 0.11.8 \u2192 0.11.10"}),"\n",(0,a.jsx)(r.li,{children:"scala-collection-compat 2.6.0 \u2192 2.7.0"}),"\n",(0,a.jsx)(r.li,{children:"SLF4J 1.7.34 \u2192 1.7.36"}),"\n",(0,a.jsx)(r.li,{children:"Spring 5.3.15 \u2192 5.3.17"}),"\n",(0,a.jsx)(r.li,{children:"Spring Boot 2.6.3 \u2192 2.6.5"}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"-thank-you",children:"\ud83d\ude47 Thank you"}),"\n",(0,a.jsx)(n,{usernames:["Dogacel","Jimexist","anuraaga","doppany","ghkim3221","heowc","ikhoon","injae-kim","jrhee17","klurpicolo","kojilin","lucasamoroso","minwoox","pine","sleeplesslord","ta7uw","tobias-","trustin","wooseongshin","wooyeong"]})]})}function d(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}}}]);