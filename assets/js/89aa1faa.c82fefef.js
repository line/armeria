"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[6995],{28453:(e,r,i)=>{i.d(r,{R:()=>s,x:()=>c});var n=i(96540);const a={},t=n.createContext(a);function s(e){const r=n.useContext(t);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(t.Provider,{value:r},e.children)}},46783:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>o,contentTitle:()=>c,default:()=>d,frontMatter:()=>s,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"1.3.0","title":"v1.3.0","description":"\ud83c\udf1f New features","source":"@site/src/content/release-notes/1.3.0.mdx","sourceDirName":".","slug":"/1.3.0","permalink":"/release-notes/1.3.0","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site-new/src/content/release-notes/1.3.0.mdx","tags":[],"version":"current","frontMatter":{"date":"2020-11-30T00:00:00.000Z"},"sidebar":"defaultSidebar","previous":{"title":"v1.4.0","permalink":"/release-notes/1.4.0"},"next":{"title":"v1.2.0","permalink":"/release-notes/1.2.0"}}');var a=i(74848),t=i(28453);const s={date:new Date("2020-11-30T00:00:00.000Z")},c="v1.3.0",o={},l=[{value:"\ud83c\udf1f New features",id:"-new-features",level:2},{value:"\ud83d\udcc8 Improvements",id:"-improvements",level:2},{value:"\ud83d\udee0\ufe0f Bug fixes",id:"\ufe0f-bug-fixes",level:2},{value:"\ud83c\udfda\ufe0f Deprecations",id:"\ufe0f-deprecations",level:2},{value:"\u2622\ufe0f Breaking changes",id:"\ufe0f-breaking-changes",level:2},{value:"\u26d3 Dependencies",id:"-dependencies",level:2},{value:"\ud83d\ude47 Thank you",id:"-thank-you",level:2}];function h(e){const r={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components},{ThankYou:i}=r;return i||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ThankYou",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.header,{children:[(0,a.jsx)(r.h1,{id:"v130",children:"v1.3.0"}),(0,a.jsx)(r.p,{children:(0,a.jsx)(r.em,{children:"November 30, 2020"})})]}),"\n",(0,a.jsx)(r.h2,{id:"-new-features",children:"\ud83c\udf1f New features"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now use ",(0,a.jsx)(r.a,{href:"https://unixism.net/loti/what_is_io_uring.html",children:"io_uring"})," for efficient I/O\nprocessing in Linux. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3182",children:"#3182"})]}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Specify the ",(0,a.jsx)(r.code,{children:"-Dcom.linecorp.armeria.transportType=io_uring"})," JVM option to enable it."]}),"\n",(0,a.jsxs)(r.li,{children:["Netty's ",(0,a.jsx)(r.code,{children:"io_uring"})," transport is currently experimental, so you should be careful using the feature."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["The metrics of requests to a ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/TransientService.html",children:"TransientService"})," are not collected anymore by default. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3061",children:"#3061"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3081",children:"#3081"})]}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Access logs and service logs are not recorded as well."}),"\n",(0,a.jsxs)(r.li,{children:["You should use ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/TransientServiceOption.html",children:"TransientServiceOption"})," to enable them.","\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"HealthCheckService.builder()\n                  .transientServiceOptions(TransientServiceOption.WITH_METRIC_COLLECTION,\n                                           TransientServiceOption.WITH_SERVICE_LOGGING,\n                                           TransientServiceOption.WITH_ACCESS_LOGGING)\n                  .build();\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["Currently, ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/healthcheck/HealthCheckService.html",children:"HealthCheckService"})," and ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/metric/PrometheusExpositionService.html",children:"PrometheusExpositionService"})," are\n",(0,a.jsx)(r.a,{href:"typeplural://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/TransientService.html",children:"TransientService"}),"."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now use Protobuf's ",(0,a.jsx)(r.code,{children:"Message"})," and ",(0,a.jsx)(r.a,{href:"https://github.com/scalapb/ScalaPB",children:"ScalaPB's"}),"\n",(0,a.jsx)(r.code,{children:"GeneratedMessage"})," as a request/response object in an annotated service. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3088",children:"#3088"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3124",children:"#3124"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3192",children:"#3192"})]}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Use ",(0,a.jsx)(r.code,{children:"armeria-protobuf"}),", ",(0,a.jsx)(r.code,{children:"armeria-scalapb_2.12"})," or ",(0,a.jsx)(r.code,{children:"armeria-scalapb_2.13"})," dependencies."]}),"\n",(0,a.jsxs)(r.li,{children:["See ",(0,a.jsx)(r.a,{href:"/docs/advanced/scalapb#supporting-scalapb-in-annotated-services",children:"Supporting ScalaPB in annotated services"}),"\nfor more information."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now use Scala ",(0,a.jsx)(r.code,{children:"Future"})," in an annotated service. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3189",children:"#3189"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-scala",children:'@Get("/items/{id}")\ndef items(@Param id: Int)(implicit ec: ExecutionContext): Future[String] = {\n  Future {\n    // Perform asynchronous task using Armeria\'s event loop.\n    ...\n  }\n}\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now use ",(0,a.jsx)(r.a,{href:"type://#",children:"HttpDeframer"})," to conveniently decode a stream of ",(0,a.jsx)(r.a,{href:"typeplural://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/HttpObject.html",children:"HttpObject"}),"\nto N objects. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2981",children:"#2981"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"HttpDeframerHandler<String> decoder = ...\nHttpDeframer<String> deframer = HttpDeframer.of(decoder, ByteBufAllocator.DEFAULT);\nHttpRequest request = ...;\nrequest.subscribe(deframer);\n"})}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["See ",(0,a.jsx)(r.a,{href:"type://#",children:"HttpDeframer"})," for more information."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now apply ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/circuitbreaker/CircuitBreaker.html",children:"CircuitBreaker"})," per request path. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3134",children:"#3134"}),", ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3135",children:"#3135"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"CircuitBreakerFactory factory = ...\n// CircuitBreaker is applied per the combination of host and path.\nCircuitBreakerMapping mapping = CircuitBreakerMapping.builder()\n                                                     .perPath()\n                                                     .perHost()\n                                                     .build(factory);\nCircuitBreakerRule rule = ...\nCircuitBreakerClient.newDecorator(mapping, rule);\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now apply the different ",(0,a.jsx)(r.code,{children:"maxTotalAttempts"})," and ",(0,a.jsx)(r.code,{children:"responseTimeout"})," for ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/retry/RetryingClient.html",children:"RetryingClient"}),"\nusing ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/retry/RetryConfig.html",children:"RetryConfig"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3145",children:"#3145"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'BiFunction<ClientRequestContext, Request, String> keyFactory =\n    (ctx, req) -> ctx.endpoint().host();\nBiFunction<ClientRequestContext, Request, RetryConfig<HttpResponse>> configFactory = (ctx, req) -> {\n    String host = ctx.endpoint().host();\n    RetryConfigBuilder builder = RetryConfig.<HttpResponse>builder(RetryRule.onException());\n    if (host.equals("host1")) {\n        builder.maxTotalAttempts(2);\n    } else if (host.equals("host2")) {\n        builder.maxTotalAttempts(4);\n    } else {\n        builder.maxTotalAttempts(1);\n    }\n    return builder.build();\n};\nRetryConfigMapping mapping = RetryConfigMapping.of(keyFactory, configFactory);\nRetryingClient.newDecoratorWithMapping(mapping);\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now split the ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/ResponseHeaders.html",children:"ResponseHeaders"})," and bodies using ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/HttpResponse.html#split()",children:"HttpResponse#split()"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3038",children:"#3038"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"HttpResponse response = ...\nSplitHttpResponse splitHttpResponse = response.split();\nCompletableFuture<ResponseHeaders> headersFuture = splitHttpResponse.headers();\nStreamMessage<HttpData> bodyStream = splitHttpResponse.body();\n\nheadersFuture.thenApply(headers -> {\n    if (headers.contentType() == MediaType.JSON_SEQ) {\n        // Subscribe to a stream of HttpData.\n        Flux.from(bodyStream)\n            .map(httpData -> {\n                // Convert HttpData to your domain object\n            });\n            ...\n    }\n});\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now customize for mapping an exception to a gRPC status. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3197",children:"#3197"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"GrpcService.builder()\n           .addExceptionMapping(AccessDeniedException.class, Status.UNAUTHENTICATED);\n// Or, use GrpcStatusFunction.\nGrpcService.builder()\n           .exceptionMapping(cause -> {\n               if (cause instanceof AccessDeniedException) {\n                   return Status.UNAUTHENTICATED;\n               }\n               if (cause instanceof FileNotFoundException) {\n                   return Status.NOT_FOUND;\n               }\n               return null; // Return null to use Armeria's default exception mapping.\n           });\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now specify the Caffeine spec for the DNS resolver cache. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2970",children:"#2970"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3007",children:"#3007"})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now specify a prefix for MDC keys using the ",(0,a.jsx)(r.code,{children:"<prefix>"})," element. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3086",children:"#3086"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3112",children:"#3112"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-xml",children:'<configuration>\n  ...\n  <appender name="RCEA" class="com.linecorp.armeria.common.logback.RequestContextExportingAppender">\n    ...\n    \x3c!-- set the prefix of exports which is not wrapped with the <exportGroup> element --\x3e\n    <prefix>armeria.</prefix>\n    <export>remote.id</export>\n    <export>req.headers.user-agent</export>\n    ...\n    <exportGroup>\n      \x3c!-- set the prefix of exports in this <exportGroup> --\x3e\n      <prefix>some_prefix.</prefix>\n      <export>some_value=attr:com.example.AttrKeys#SOME_KEY</export>\n      ...\n    </exportGroup>\n    <exportGroup>\n      \x3c!-- if <prefix> is not defined, no prefix is added to exports --\x3e\n      <export>tracking_id=attr:com.example.AttrKeys#TRACKING_ID_KEY</export>\n      ...\n    </exportGroup>\n  </appender>\n  ...\n</configuration>\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now use the unsafe TLS cipher using ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/ClientFactoryBuilder.html#tlsAllowUnsafeCiphers(boolean)",children:"ClientFactoryBuilder#tlsAllowUnsafeCiphers(boolean)"}),".\n",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3157",children:"#3157"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3172",children:"#3172"})]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now specify an arbitrary type for ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/annotation/Header.html",children:"@Header"})," and ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/annotation/Param.html",children:"@Param"})," if the\ntype has one of following static methods or the constructor. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2574",children:"#2574"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3143",children:"#3143"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3164",children:"#3164"})]}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.code,{children:"public static T of(String) { ... }"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.code,{children:"public static T valueOf(String) { ... }"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.code,{children:"public static T fromString(String) { ... }"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.code,{children:"public T(String) { ... } // constructor"})}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'public class UserService {\n\n    @Get("/api")\n    public HttpResponse get(@Param User user) {\n        ...\n    }\n\n    private static class User {\n        User(String userId) { ... } // This constructor is used to create User.\n        ...\n    }\n}\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now build and execute an ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/HttpRequest.html",children:"HttpRequest"})," fluently. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3110",children:"#3110"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'// Creates a POST HttpRequest whose URI is "/foo?q=bar"\n// with headers "cookie: name=value" and "authorization: value" and a JSON body.\nHttpRequest.builder()\n           .post("/{resource}")\n           .pathParam("resource", "foo")\n           .queryParam("q", "bar")\n           .cookie(Cookie.of("name", "value"))\n           .header("authorization", "value")\n           .content(MediaType.JSON, "{\\"foo\\":\\"bar\\"}"));\n// You can also use WebClient.prepare().\nWebClient client = ...\nclient.prepare()\n      .post("/{resource}")\n      .pathParam("resource", "foo")\n      .queryParam("q", "bar")\n      .cookie(Cookie.of("name", "value"))\n      .header("authorization", "value")\n      .content(MediaType.JSON, "{\\"foo\\":\\"bar\\"}")\n      .execute();\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now easily handle cookies by applying ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/cookie/CookieClient.html#newDecorator()",children:"CookieClient#newDecorator()"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2637",children:"#2637"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3118",children:"#3118"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"WebClient client = WebClient.builder()\n                            .factory(factory)\n                            .decorator(CookieClient.newDecorator())\n                            .build();\nclient.get(...); // The cookies that are received from the origin server\n                 // are added to the request headers.\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now use the custom Thrift protocol by using ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/thrift/ThriftProtocolFactoryProvider.html",children:"ThriftProtocolFactoryProvider"})," and SPI. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3183",children:"#3183"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:'public class TTupleFactoryProvider extends ThriftProtocolFactoryProvider {\n    @Override\n    public Set<ThriftProtocolFactoryProvider.Entry> entries() {\n        return ImmutableSet.of(new ThriftProtocolFactoryProvider.Entry(\n                SerializationFormat.of("ttuple"), new TTupleProtocol.Factory()));\n    }\n}\n'})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now collect more detailed DNS metrics. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/1887",children:"#1887"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2935",children:"#2935"})]}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.code,{children:"armeria.client.dns.queries#count{...,result=success}"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.code,{children:"armeria.client.dns.queries#count{...,result=failure}"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.code,{children:"armeria.client.dns.queries.written#count{...}"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.code,{children:"armeria.client.dns.queries.cancelled#count{...}"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.code,{children:"armeria.client.dns.queries.redirected#count{...}"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.code,{children:"armeria.client.dns.queries.cnamed#count{...}"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.code,{children:"armeria.client.dns.queries.noanswer#count{...}"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now customize the ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/healthcheck/HealthCheckService.html",children:"HealthCheckService"})," when using Spring integration. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3144",children:"#3144"})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"@Bean\npublic HealthCheckServiceConfigurator healthCheckServiceConfigurator() {\n    return builder -> builder.updatable(true);\n}\n"})}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["You can now use ",(0,a.jsx)(r.a,{href:"type://#",children:"RequestHeaders#acceptLanguage()"})," to choose language. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3177",children:"#3177"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3179",children:"#3179"})]}),"\n"]}),"\n"]}),"\n","\n",(0,a.jsx)(r.h2,{id:"-improvements",children:"\ud83d\udcc8 Improvements"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Various improvements for ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3149",children:"#3149"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3150",children:"#3150"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3167",children:"#3167"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3188",children:"#3188"})]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"\ufe0f-bug-fixes",children:"\ud83d\udee0\ufe0f Bug fixes"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"type://#",children:"HealthCheckedEndpointGroup#endpoints()"})," now returns healthy endpoints properly even when\n",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/endpoint/EndpointGroup.html#orElse(com.linecorp.armeria.client.endpoint.EndpointGroup)",children:"EndpointGroup#orElse(EndpointGroup)"})," is used. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3181",children:"#3181"})]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"ServletRequest.getProtocol()"})," now returns the proper value when using ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/tomcat/TomcatService.html",children:"TomcatService"})," and\n",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/jetty/JettyService.html",children:"JettyService"}),". ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3194",children:"#3194"})]}),"\n",(0,a.jsxs)(r.li,{children:["The route decorators are now evaluated in the reverse order they applied. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3160",children:"#3160"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3166",children:"#3166"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["The purpose of this change is to make sure we provide a consistent experience when decorating a service.\nFor example, when we decorate a service like the following:","\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"myService\n  .decorate(decoratorA)\n  .decorate(decoratorB);\n"})}),"\n","we expect ",(0,a.jsx)(r.code,{children:"decoratorA"})," decorates ",(0,a.jsx)(r.code,{children:"myService"})," and ",(0,a.jsx)(r.code,{children:"decoratorB"})," decorates ",(0,a.jsx)(r.code,{children:"decoratorA"}),".\nRoute decorators were breaking this expectation."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["You now get the FORBIDDEN status if your service does not handle preflight requests regardless of\nroute decorators. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3152",children:"#3152"})]}),"\n",(0,a.jsxs)(r.li,{children:["A gRPC ",(0,a.jsx)(r.code,{children:"ServerCall"})," is now closed exactly only once. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3153",children:"#3153"})]}),"\n",(0,a.jsxs)(r.li,{children:["You no longer see ",(0,a.jsx)(r.code,{children:"AnnotatedConnectException"})," when the ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/Endpoint.html",children:"Endpoint"})," is created with an\nIPv6 scope ID. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3158",children:"#3158"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3178",children:"#3178"})]}),"\n",(0,a.jsxs)(r.li,{children:["Armeria server does not reject the request path whose first segment includes a colon anymore. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3154",children:"#3154"})]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"\ufe0f-deprecations",children:"\ud83c\udfda\ufe0f Deprecations"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/circuitbreaker/CircuitBreakerClient.html#newPerHostAndMethodDecorator(java.util.function.BiFunction,com.linecorp.armeria.client.circuitbreaker.CircuitBreakerRule)",children:"CircuitBreakerClient#newPerHostAndMethodDecorator(BiFunction,CircuitBreakerRule)"})," is now deprecated.\n",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3135",children:"#3135"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Use ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/circuitbreaker/CircuitBreakerClient.html#newDecorator(com.linecorp.armeria.client.circuitbreaker.CircuitBreakerMapping,com.linecorp.armeria.client.circuitbreaker.CircuitBreakerRule)",children:"CircuitBreakerClient#newDecorator(CircuitBreakerMapping,CircuitBreakerRule)"})," with the customized\n",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/circuitbreaker/CircuitBreakerMapping.html",children:"CircuitBreakerMapping"})," using ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/circuitbreaker/CircuitBreakerMapping.html#builder()",children:"CircuitBreakerMapping#builder()"}),"."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["The response timeout and max total attempts setters in ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/retry/RetryingClientBuilder.html",children:"RetryingClientBuilder"})," are now deprecated.\n",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3128",children:"#3128"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3145",children:"#3145"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["The static factory methods that take those parameters in ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/retry/RetryingClient.html",children:"RetryingClient"})," are now deprecated as well."]}),"\n",(0,a.jsxs)(r.li,{children:["Use ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/retry/RetryConfigMapping.html",children:"RetryConfigMapping"})," and ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/retry/RetryConfig.html",children:"RetryConfig"}),"."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/Route.html#apply(com.linecorp.armeria.server.RoutingContext)?full",children:"Route#apply(RoutingContext)"})," is deprecated. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3152",children:"#3152"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Use ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/Route.html#apply(com.linecorp.armeria.server.RoutingContext,boolean)?full",children:"Route#apply(RoutingContext,boolean)"}),"."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["The constructor of ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/metric/PrometheusExpositionService.html",children:"PrometheusExpositionService"})," is now deprecated. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3081",children:"#3081"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Use ",(0,a.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/metric/PrometheusExpositionService.html#of(io.prometheus.client.CollectorRegistry)",children:"PrometheusExpositionService#of(CollectorRegistry)"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"\ufe0f-breaking-changes",children:"\u2622\ufe0f Breaking changes"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Route decorators are now evaluated in the reverse order they applied. ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3160",children:"#3160"})," ",(0,a.jsx)(r.a,{href:"https://github.com/line/armeria/issues/3166",children:"#3166"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["The purpose of this change is to make sure we provide a consistent experience when decorating a service.\nFor example, when we decorate a service like the following:","\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-java",children:"myService\n  .decorate(decoratorA)\n  .decorate(decoratorB);\n"})}),"\n","we expect ",(0,a.jsx)(r.code,{children:"decoratorA"})," decorates ",(0,a.jsx)(r.code,{children:"myService"})," and ",(0,a.jsx)(r.code,{children:"decoratorB"})," decorates ",(0,a.jsx)(r.code,{children:"decoratorA"}),".\nRoute decorators were breaking this expectation."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"-dependencies",children:"\u26d3 Dependencies"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Dropwizard 2.0.13 \u2192 2.0.16"}),"\n",(0,a.jsx)(r.li,{children:"Fastutil 8.4.2 \u2192 8.4.3"}),"\n",(0,a.jsx)(r.li,{children:"gRPC 1.33.0 \u2192 1.33.1"}),"\n",(0,a.jsx)(r.li,{children:"grpc-kotlin-stub 0.2.0 \u2192 0.2.1"}),"\n",(0,a.jsx)(r.li,{children:"Dropwizard Metrics 4.1.13 \u2192 4.1.15"}),"\n",(0,a.jsx)(r.li,{children:"Jackson 2.11.2 \u2192 2.12.0"}),"\n",(0,a.jsx)(r.li,{children:"JCTools 3.1.0 \u2192 3.2.0"}),"\n",(0,a.jsxs)(r.li,{children:["javax.annotation-api 1.3.2","\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"jakarta-annotation-api 2.0 has been released with a breaking change so we use javax.annotation-api instead."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(r.li,{children:"Micrometer 1.5.5 \u2192 1.6.1"}),"\n",(0,a.jsx)(r.li,{children:"Netty 4.1.53.Final \u2192 4.1.54.Final"}),"\n",(0,a.jsx)(r.li,{children:"BouncyCastle 1.66 \u2192 1.67"}),"\n",(0,a.jsx)(r.li,{children:"Reactor 3.3.10.RELEASE \u2192 3.4.0"}),"\n",(0,a.jsx)(r.li,{children:"Spring Boot 2.3.4.RELEASE \u2192 2.4.0"}),"\n",(0,a.jsx)(r.li,{children:"Spring 5.2.9.RELEASE \u2192 5.3.1"}),"\n",(0,a.jsx)(r.li,{children:"Tomcat 9.0.39 \u2192 9.0.40"}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"-thank-you",children:"\ud83d\ude47 Thank you"}),"\n",(0,a.jsx)(i,{usernames:["anuraaga","codefromthecrypt","ghkim3221","haithamgabr","heowc","ikhoon","jrhee17","KarboniteKream","kojilin","masonshin","minwoox","okue","perlun","rolandblain","techno","tobias-","trustin","tumile","Ubehebe","wickedev","windmeup"]})]})}function d(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}}}]);