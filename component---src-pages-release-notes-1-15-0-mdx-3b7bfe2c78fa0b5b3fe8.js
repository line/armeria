"use strict";(self.webpackChunkarmeria_site=self.webpackChunkarmeria_site||[]).push([[2514],{3810:function(e,a,t){t.r(a),t.d(a,{_frontmatter:function(){return l},default:function(){return u}});var r=t(63366),n=(t(67294),t(64983)),i=t(20370),o=["components"],l={},s=function(e){return function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,n.kt)("div",a)}},p=s("Tip"),c=s("ThankYou"),m={_frontmatter:l},h=i.Z;function u(e){var a=e.components,t=(0,r.Z)(e,o);return(0,n.kt)(h,Object.assign({},m,t,{components:a,mdxType:"MDXLayout"}),(0,n.kt)("p",{className:"date"},"24th March 2022"),(0,n.kt)("h2",{id:"-highlights",style:{position:"relative"}},(0,n.kt)("a",{parentName:"h2",href:"#-highlights","aria-label":" highlights permalink",className:"anchor before"},(0,n.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"🌸 Highlights"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"gRPC health check protocol"),(0,n.kt)("li",{parentName:"ul"},"Multipart file uploads in annotated services"),(0,n.kt)("li",{parentName:"ul"},"Preliminary GraphQL support in ",(0,n.kt)("a",{parentName:"li",href:"type://DocService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html"},"type://DocService")," "),(0,n.kt)("li",{parentName:"ul"},"Refactored DNS resolver cache with higher hit ratio and reduced traffic"),(0,n.kt)("li",{parentName:"ul"},"New metrics that help you get alerts before your TLS certificates are expired")),(0,n.kt)("h2",{id:"-new-features",style:{position:"relative"}},(0,n.kt)("a",{parentName:"h2",href:"#-new-features","aria-label":" new features permalink",className:"anchor before"},(0,n.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"🌟 New features"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"type://Server:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/Server.html"},"type://Server")," now registers two gauges about TLS certificate expiry, so you can get alerts before\nthe certificates are expired. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4075"},"#4075")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4082"},"#4082")),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"armeria_server_certificate_validity"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"1")," if certificate is in validity period. ",(0,n.kt)("inlineCode",{parentName:"li"},"0")," otherwise."))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"armeria_server_certificate_validity_days"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The number of days before certificate expires, or ",(0,n.kt)("inlineCode",{parentName:"li"},"-1")," if expired."))))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now specify a ",(0,n.kt)("inlineCode",{parentName:"p"},"File")," or ",(0,n.kt)("inlineCode",{parentName:"p"},"Path")," parameter in your annotated service method to handle multipart file\nuploads. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/3578"},"#3578")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4061"},"#4061")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},'Server\n  .builder()\n  .annotatedService(new Object() {\n    @Post("/upload")\n    @Consumes("multipart/form-data")\n    public String upload(@Param File file) {\n      return "Successfully uploaded a file to " + file;\n    }\n  })\n  .build();\n'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now use the ",(0,n.kt)("inlineCode",{parentName:"p"},"||")," (logical OR) operator in parameter and header predicate expressions. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4116"},"#4116")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4138"},"#4138")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},'// "Hi!" for /greet?casual or /greet?casual=true\n// "Hello!" for /greet or /greet?casual=false\nServer\n  .builder()\n  .route()\n    .get("/greet")\n    .matchesParam("casual || casual=true") // 👈👈👈\n    .build((ctx, req) -> HttpResponse.of("Hi!"))\n  .route()\n    .get("/greet")\n    .matchesParam("!casual || casual!=true") // 👈👈👈\n    .build(ctx, req) -> HttpResponse.of("Hello!"))  \n')),(0,n.kt)(p,{mdxType:"Tip"},(0,n.kt)("p",{parentName:"li"},"You can use the same syntax in ",(0,n.kt)("a",{parentName:"p",href:"/docs/server-annotated-service"},"annotated services"),"\nusing ",(0,n.kt)("a",{parentName:"p",href:"type://@MatchesParam:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/annotation/MatchesParam.html"},"type://@MatchesParam")," and ",(0,n.kt)("a",{parentName:"p",href:"type://@MatchesHeader:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/annotation/MatchesHeader.html"},"type://@MatchesHeader"),"."))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now enable ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/grpc/grpc/blob/master/src/proto/grpc/health/v1/health.proto"},"gRPC health check protocol"),"\nwith ",(0,n.kt)("a",{parentName:"p",href:"type://GrpcHealthCheckService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/grpc/GrpcHealthCheckService.html"},"type://GrpcHealthCheckService")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/3146"},"#3146")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/3963"},"#3963")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},"Server\n  .builder()\n  .service(\n    GrpcService\n      .builder()\n      .addService(new MyGrpcService())\n      .enableHealthCheckService(true) // 👈👈👈\n      // or customize:\n      // .addService(GrpcHealthCheckService.of(...))\n      .build()\n  )\n  .build()\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"type://DocService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html"},"type://DocService")," now supports ",(0,n.kt)("a",{parentName:"p",href:"type://GraphqlService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/graphql/GraphqlService.html"},"type://GraphqlService")," with CodeMirror auto-completion. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/3706"},"#3706")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4023"},"#4023"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now configure the ",(0,n.kt)("a",{parentName:"p",href:"type://EndpointGroup:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/endpoint/EndpointGroup.html"},"type://EndpointGroup")," implementations based on ",(0,n.kt)("a",{parentName:"p",href:"type://DynamicEndpointGroup:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/endpoint/DynamicEndpointGroup.html"},"type://DynamicEndpointGroup"),"\nto allow or disallow empty endpoints. This can be useful when you want to avoid the situation where\nthe endpoint group becomes empty due to misconfiguration. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/3952"},"#3952")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/3958"},"#3958")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},'EndpointGroup endpointGroup =\n  DnsAddressEndpointGroup\n    .builder("example.com")\n    .allowEmptyEndpoints(false) // 👈👈👈\n    .build();\n'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now configure the timeout of DNS sub-queries with ",(0,n.kt)("inlineCode",{parentName:"p"},"queryTimeoutMillisForEachAttempt()"),". Previously,\nyou were only able to specify the timeout for the entire DNS resolution process, which can consist of more\nthan one DNS query. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/2940"},"#2940")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4133"},"#4133")," "),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},'DnsAddressEndpointGroup\n  .builder("armeria.dev")\n  .queryTimeoutMillisForEachAttempt(1000) // 👈👈👈\n  .queryTimeoutMillis(5000)\n  .build();\n'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Armeria now has the global shared DNS cache by default for higher hit ratio and less DNS traffic.\nYou can also build and share a custom DNS cache across multiple resolvers. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/2940"},"#2940")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4133"},"#4133")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},'DnsCache dnsCache = \n  DnsCache\n    .builder()\n    .ttl(60, 3600)\n    .negativeTtl(600)\n    .build();\n\nEndpointGroup endpointGroup = \n  DnsAddressEndpointGroup\n    .builder("armeria.dev")\n    .dnsCache(dnsCache) // 👈👈👈\n    .build();\n\nClientFactory factory =\n  ClientFactory\n    .builder()\n    .domainNameResolverCustomizer(builder -> {\n      builder.dnsCache(dnsCache); // 👈👈👈\n    })\n    .build();\n\nWebClient client =\n  WebClient\n    .builder(SessionProtocol.HTTPS, endpointGroup) // 👈👈👈\n    .factory(factory) // 👈👈👈\n    .build();         \n'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Failed search domain queries are now cached according to the negative TTL configuration. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/2940"},"#2940")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4133"},"#4133"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now specify a ",(0,n.kt)("a",{parentName:"p",href:"type://SuccessFunction:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/SuccessFunction.html"},"type://SuccessFunction")," when constructing a client or server, and let all decorators\nuse it for determining whether a request was successful or not. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4101"},"#4101")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},"Server\n  .builder()\n  .successFunction((ctx, log) -> { // 👈👈👈\n    // Treat only '200 OK' and '204 No Content' as success. \n    switch (log.responseStatus().code()) {\n      case 200:\n      case 204:\n        return true;\n      default:\n        return false;\n    }\n  })\n  .decorator(LoggingService.newDecorator())\n  .decorator(MetricCollectingService.newDecorator())\n  ...\n\nWebClient\n  .builder()\n  .successFunction(...) // 👈👈👈\n  .decorator(LoggingClient.newDecorator())\n  .decorator(MetricCollectingClient.newDecorator())\n  .build();\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now specify different sampling ratio (or ",(0,n.kt)("a",{parentName:"p",href:"type://Sampler:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/util/Sampler.html"},"type://Sampler"),") for successful and failed requests\nwhen using ",(0,n.kt)("a",{parentName:"p",href:"type://LoggingClient:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/logging/LoggingClient.html"},"type://LoggingClient")," and ",(0,n.kt)("a",{parentName:"p",href:"type://LoggingService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/logging/LoggingService.html"},"type://LoggingService")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/3666"},"#3666")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4101"},"#4101")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},"LoggingService\n  .builder()\n  // Log at 10% sampling ratio if successful.\n  .successSamplingRate(0.1)\n  // Log all failure.\n  .failureSamplingRate(1.0)\n  .newDecorator()\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now customize how ",(0,n.kt)("a",{parentName:"p",href:"type://LoggingClient:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/logging/LoggingClient.html"},"type://LoggingClient")," and ",(0,n.kt)("a",{parentName:"p",href:"type://LoggingService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/logging/LoggingService.html"},"type://LoggingService")," determines log level\nmore flexibly. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/3972"},"#3972")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},'LoggingService\n  .builder()\n  // Log at INFO if under /important. DEBUG otherwise.\n  .requestLogLevelMapper(log -> {\n    if (log.requestHeaders().path().startsWith("/important/")) {\n      return LogLevel.INFO;\n    } else {\n      return LogLevel.DEBUG;\n    }\n  })\n  // Log at INFO if 200 OK.\n  .responseLogLevel(HttpStatus.OK, LogLevel.INFO)\n  // Log at WARN if 5xx.\n  .responseLogLevel(HttpStatusClass.SERVER_ERROR, LogLevel.WARN)\n  .newDecorator()    \n'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now specify a customizer that customizes a ",(0,n.kt)("a",{parentName:"p",href:"type://ClientRequestContext:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/ClientRequestContext.html"},"type://ClientRequestContext")," when building a client. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4075"},"#4075")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4082"},"#4082")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},"WebClient client =\n  WebClient\n    .builder()\n    .contextCustomizer(ctx -> { // 👈👈👈\n      String userId = MyUserContext.current().getId();\n      ctx.setAttr(USER_ID, userId);\n    })\n    .build();\n")),(0,n.kt)("p",{parentName:"li"},"For instance, you could manually propagate a Brave thread-local ",(0,n.kt)("inlineCode",{parentName:"p"},"TraceContext")," using it:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},"Tracing reactorTracing = ...;\nTracing requestContextTracing =\n  Tracing\n    .newBuilder()\n    .currentTraceContext(RequestContextCurrentTraceContext.ofDefault())\n    .build();\n\nWebClient\n  .builder()\n  .contextCustomizer(TraceContextPropagation.inject(() -> {\n    // Propagate Reactor's TraceContext to Armeria's TraceContext.\n    return reactorTracing.currentTraceContext().get();\n  })\n  .decorator(BraveClient.newDecorator(requestContextTracing))\n  .build();\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now write the content of ",(0,n.kt)("a",{parentName:"p",href:"type://StreamMessage:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html"},"type://StreamMessage")," into a file using\n",(0,n.kt)("a",{parentName:"p",href:"type://StreamMessage#writeTo(Function,Path,OpenOption):https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html#writeTo(java.util.function.Function,java.nio.file.Path,java.nio.file.OpenOption...)"},"type://StreamMessage#writeTo(Function,Path,OpenOption)")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4048"},"#4048")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4130"},"#4130")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},'SplitHttpResponse res =\n  WebClient\n    .of()\n    .get("https://example.com/large_file")\n    .split();\nStreamMessage<HttpData> body = res.body();\nbody.writeTo( // 👈👈👈\n  Function.identity(),\n  Path.of("/tmp", "large_file")\n);\n'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now convert a ",(0,n.kt)("a",{parentName:"p",href:"type://StreamMessage:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html"},"type://StreamMessage")," into an ",(0,n.kt)("inlineCode",{parentName:"p"},"InputStream")," using\n",(0,n.kt)("a",{parentName:"p",href:"type://StreamMessage#toInputStream(Function):https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html#toInputStream(java.util.function.Function)"},"type://StreamMessage#toInputStream(Function)")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4059"},"#4059")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},'StreamMessage<HttpData> body = ...;\nBufferedReader in = new BufferedReader(\n  new InputStreamReader(\n    body.toInputStream(Function.identity()), // 👈👈👈\n    "UTF-8"\n  )\n);\nfor (;;) {\n  String line = in.readLine();\n  if (line == null) break;\n  System.out.println(line);\n}\n'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now use ",(0,n.kt)("a",{parentName:"p",href:"type://StreamMessage#mapParallel(Function,int):https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html#mapParallel(java.util.function.Function,int)"},"type://StreamMessage#mapParallel(Function,int)")," to modify a stream using an async operation\nwith a configurable concurrency limit. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4031"},"#4031"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now decode a ",(0,n.kt)("a",{parentName:"p",href:"type://StreamMessage:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html"},"type://StreamMessage")," into another using ",(0,n.kt)("a",{parentName:"p",href:"type://StreamMessage#decode(StreamDecoder):https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html#decode(com.linecorp.armeria.common.stream.StreamDecoder)"},"type://StreamMessage#decode(StreamDecoder)"),"\nwhich was previously possible only for ",(0,n.kt)("a",{parentName:"p",href:"type://HttpMessage:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/HttpMessage.html"},"type://HttpMessage"),". ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4147"},"#4147")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4148"},"#4148")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/4152"},"#4152"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"You can now give Armeria a performance optimization hint by specifying if your service is unary,\nrequest-streaming, response-streaming or bidi-streaming by implementing ",(0,n.kt)("a",{parentName:"p",href:"type://HttpService#exchangeType()"},"type://HttpService#exchangeType()")," ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/line/armeria/issues/3956"},"#3956")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-java"},'class MyUnaryService implements HttpService {\n  @Override\n  public HttpResponse serve(ServiceRequestContext ctx, HttpRequest req) {\n    return HttpResponse.from(\n      req\n        .aggregate() // Always aggregate\n        .thenApply(aggregatedReq -> {\n          HttpResponse.of( // Never streaming\n            "You sent %d bytes.",\n            aggregatedReq.content().length()\n          );\n        })\n    );\n  }\n\n  // Tells Armeria to assume non-streaming requests and responses.\n  @Override\n  public ExchangeType exchangeType() {\n    return ExchangeType.UNARY; // 👈👈👈\n  }\n}\n')))),(0,n.kt)("h2",{id:"-improvements",style:{position:"relative"}},(0,n.kt)("a",{parentName:"h2",href:"#-improvements","aria-label":" improvements permalink",className:"anchor before"},(0,n.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"📈 Improvements"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Spring Boot ",(0,n.kt)("inlineCode",{parentName:"li"},"WebServerException")," message is now more user-friendly. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4146"},"#4146"))),(0,n.kt)("h2",{id:"️-bug-fixes",style:{position:"relative"}},(0,n.kt)("a",{parentName:"h2",href:"#%EF%B8%8F-bug-fixes","aria-label":"️ bug fixes permalink",className:"anchor before"},(0,n.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"🛠️ Bug fixes"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"A response with status code ",(0,n.kt)("inlineCode",{parentName:"li"},"408")," doesn't trigger a ",(0,n.kt)("inlineCode",{parentName:"li"},"NullPointerException")," anymore, even if its reason phrase\nis not exactly ",(0,n.kt)("inlineCode",{parentName:"li"},"Request Timeout"),". ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4165"},"#4165")," "),(0,n.kt)("li",{parentName:"ul"},"Failed search domain queries are now cached properly according to the negative TTL configuration. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/2940"},"#2940")," ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4133"},"#4133")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"type://GrpcService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/grpc/GrpcService.html"},"type://GrpcService")," now logs ",(0,n.kt)("a",{parentName:"li",href:"type://RequestOnlyLog#requestContent():https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RequestOnlyLog.html#requestContent()"},"type://RequestOnlyLog#requestContent()")," for invalid requests. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4128"},"#4128")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"type://DocService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html"},"type://DocService")," doesn't crash the whole Armeria service anymore when ",(0,n.kt)("inlineCode",{parentName:"li"},".proto")," files have comments\non service options or extensions. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4123"},"#4123")," ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4127"},"#4127")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"type://GraphqlService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/graphql/GraphqlService.html"},"type://GraphqlService")," doesn't throw a ",(0,n.kt)("inlineCode",{parentName:"li"},"ClassCastException")," anymore when ",(0,n.kt)("inlineCode",{parentName:"li"},"query")," or ",(0,n.kt)("inlineCode",{parentName:"li"},"operationName")," are not\na string. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4104"},"#4104")," ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4168"},"#4168"),"  "),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"type://FileService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/file/FileService.html"},"type://FileService")," doesn't choose a ",(0,n.kt)("inlineCode",{parentName:"li"},".br")," file for generating decompressed content anymore when Brotli\nis not available. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4119"},"#4119")),(0,n.kt)("li",{parentName:"ul"},"You no longer see an ",(0,n.kt)("a",{parentName:"li",href:"type://HttpResponseException:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/HttpResponseException.html"},"type://HttpResponseException")," or ",(0,n.kt)("a",{parentName:"li",href:"type://HttpStatusException:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/HttpStatusException.html"},"type://HttpStatusException")," from built-in services. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4056"},"#4056")," ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4117"},"#4117"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Thanks to this fix, you can now mutate a redirect response from ",(0,n.kt)("a",{parentName:"li",href:"type://FileService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/file/FileService.html"},"type://FileService")," in your decorator\nusing ",(0,n.kt)("a",{parentName:"li",href:"type://HttpResponse#mapHeaders(Function):https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/HttpResponse.html#mapHeaders(java.util.function.Function)"},"type://HttpResponse#mapHeaders(Function)")))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"type://RampingUpEndpointWeightSelector"},"type://RampingUpEndpointWeightSelector")," doesn't raise a ",(0,n.kt)("inlineCode",{parentName:"li"},"NoSuchElementException")," anymore when endpoints\nare replaced completely. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/3776"},"#3776")," ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4102"},"#4102"))),(0,n.kt)("h2",{id:"️-deprecations",style:{position:"relative"}},(0,n.kt)("a",{parentName:"h2",href:"#%EF%B8%8F-deprecations","aria-label":"️ deprecations permalink",className:"anchor before"},(0,n.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"🏚️ Deprecations"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"samplingRate")," property of ",(0,n.kt)("a",{parentName:"li",href:"type://@LoggingDecorator:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/annotation/decorator/LoggingDecorator.html"},"type://@LoggingDecorator")," has been deprecated in favor of ",(0,n.kt)("inlineCode",{parentName:"li"},"successSamplingRate"),"\nand ",(0,n.kt)("inlineCode",{parentName:"li"},"failureSamplingRate"),"."),(0,n.kt)("li",{parentName:"ul"},"The ",(0,n.kt)("inlineCode",{parentName:"li"},"successFunction()")," builder methods that require a ",(0,n.kt)("inlineCode",{parentName:"li"},"BiPredicate")," has been deprecated in favor of\n",(0,n.kt)("a",{parentName:"li",href:"type://SuccessFunction:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/SuccessFunction.html"},"type://SuccessFunction")," that's specified when constructing a client or server."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"dnsServerAddressStreamProvider()")," has been deprecated in favor of ",(0,n.kt)("inlineCode",{parentName:"li"},"serverAddressStreamProvider()")," in the\nDNS-related builders."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"disableDnsQueryMetrics()")," has been deprecated in favor of ",(0,n.kt)("inlineCode",{parentName:"li"},"enableDnsQueryMetrics()")," in the DNS-related\nbuilders.")),(0,n.kt)("h2",{id:"️-breaking-changes",style:{position:"relative"}},(0,n.kt)("a",{parentName:"h2",href:"#%EF%B8%8F-breaking-changes","aria-label":"️ breaking changes permalink",className:"anchor before"},(0,n.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"☢️ Breaking changes"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"The experimental ",(0,n.kt)("inlineCode",{parentName:"li"},"HttpDecoder")," API has been replaced with ",(0,n.kt)("a",{parentName:"li",href:"type://StreamDecoder:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/encoding/StreamDecoder.html"},"type://StreamDecoder")," ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4147"},"#4147")," ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/line/armeria/issues/4152"},"#4152"))),(0,n.kt)("h2",{id:"-dependencies",style:{position:"relative"}},(0,n.kt)("a",{parentName:"h2",href:"#-dependencies","aria-label":" dependencies permalink",className:"anchor before"},(0,n.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"⛓ Dependencies"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Bucket4j 7.0.0 → 7.3.0"),(0,n.kt)("li",{parentName:"ul"},"Curator 5.2.0 → 5.2.1"),(0,n.kt)("li",{parentName:"ul"},"Dropwizard Metrics 4.2.7 → 4.2.9"),(0,n.kt)("li",{parentName:"ul"},"gRPC-Java 1.43.2 → 1.45.0"),(0,n.kt)("li",{parentName:"ul"},"Jackson 2.13.1 → 2.13.2"),(0,n.kt)("li",{parentName:"ul"},"java-jwt 3.18.3 → 3.19.0"),(0,n.kt)("li",{parentName:"ul"},"Jetty 9.4.44 → 9.4.45"),(0,n.kt)("li",{parentName:"ul"},"Graphql-Java 17.3 → 18.0"),(0,n.kt)("li",{parentName:"ul"},"Logback 1.2.10 → 1.2.11"),(0,n.kt)("li",{parentName:"ul"},"Micrometer 1.8.2 → 1.8.4"),(0,n.kt)("li",{parentName:"ul"},"Netty 4.1.73 → 4.1.75",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"io_uring 0.0.11 → 0.0.13"))),(0,n.kt)("li",{parentName:"ul"},"Prometheus 0.14.1 → 0.15.0"),(0,n.kt)("li",{parentName:"ul"},"Reactor 3.4.14 → 3.4.16",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Reactor Kotlin 1.1.5 → 1.1.6"))),(0,n.kt)("li",{parentName:"ul"},"RxJava 3.1.3 → 3.1.4"),(0,n.kt)("li",{parentName:"ul"},"Sangria 2.1.6 → 3.0.0"),(0,n.kt)("li",{parentName:"ul"},"ScalaPB 0.11.8 → 0.11.10"),(0,n.kt)("li",{parentName:"ul"},"scala-collection-compat 2.6.0 → 2.7.0"),(0,n.kt)("li",{parentName:"ul"},"SLF4J 1.7.34 → 1.7.36"),(0,n.kt)("li",{parentName:"ul"},"Spring 5.3.15 → 5.3.17"),(0,n.kt)("li",{parentName:"ul"},"Spring Boot 2.6.3 → 2.6.5")),(0,n.kt)("h2",{id:"-thank-you",style:{position:"relative"}},(0,n.kt)("a",{parentName:"h2",href:"#-thank-you","aria-label":" thank you permalink",className:"anchor before"},(0,n.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"🙇 Thank you"),(0,n.kt)(c,{usernames:["Dogacel","Jimexist","anuraaga","doppany","ghkim3221","heowc","ikhoon","injae-kim","jrhee17","klurpicolo","kojilin","lucasamoroso","minwoox","pine","sleeplesslord","ta7uw","tobias-","trustin","wooseongshin","wooyeong"],mdxType:"ThankYou"}))}u.isMDXComponent=!0},20370:function(e,a,t){t(88025);var r=t(1923),n=t(25444),i=t(67294),o=t(55746),l=t(8284),s=t(96759),p=t(46731),c=t(9396),m=r.Z.Title,h=Object.keys(l)[0],u=d(h);function d(e){return e.substring(e.lastIndexOf("/")+1)}a.Z=function(e){var a={},t={},r={root:{"Latest news items":"/news","Latest release notes":"/release-notes","Past news items":"/news/list","Past release notes":"/release-notes/list"},"Recent news items":a,"Recent releases":t};Object.entries(o).forEach((function(e){var t=e[0],r=e[1];a[r]=t})),Object.entries(l).forEach((function(e){var a=e[0],r=e[1];t[r]=a}));var g=(0,c.Z)(e.location),v=e.version||d(g);return v.match(/^[0-9]/)||(v=void 0),i.createElement(p.Z,Object.assign({},e,{candidateMdxNodes:[],index:r,prefix:"release-notes",pageTitle:v?v+" release notes":e.pageTitle,pageTitleSuffix:"Armeria release notes"}),v&&v!==u?i.createElement(s.Ch,null,"You're seeing the release note of an old version. Check out"," ",i.createElement(n.Link,{to:h},"the latest release note"),"."):"",v?i.createElement(m,{id:"release-notes",level:1},i.createElement("a",{href:"#release-notes","aria-label":"release notes permalink",className:"anchor before"},i.createElement("svg",{"aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},i.createElement("path",{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),v," release notes"):"",e.children)}},55746:function(e){e.exports=JSON.parse('{"/news/20231208-newsletter-6":"Armeria Newsletter vol. 6","/news/20230426-newsletter-5":"Armeria Newsletter vol. 5","/news/20220714-newsletter-4":"Armeria Newsletter vol. 4","/news/20211029-newsletter-3":"Armeria Newsletter vol. 3","/news/20210202-newsletter-2":"Armeria Newsletter vol. 2","/news/20200703-newsletter-1":"Armeria Newsletter vol. 1","/news/20200514-newsletter-0":"Armeria Newsletter vol. 0"}')},8284:function(e){e.exports=JSON.parse('{"/release-notes/1.29.4":"v1.29.4","/release-notes/1.29.3":"v1.29.3","/release-notes/1.29.2":"v1.29.2","/release-notes/1.29.1":"v1.29.1","/release-notes/1.29.0":"v1.29.0","/release-notes/1.28.4":"v1.28.4","/release-notes/1.28.3":"v1.28.3","/release-notes/1.28.2":"v1.28.2","/release-notes/1.28.1":"v1.28.1","/release-notes/1.28.0":"v1.28.0","/release-notes/1.27.3":"v1.27.3","/release-notes/1.27.2":"v1.27.2","/release-notes/1.27.1":"v1.27.1","/release-notes/1.27.0":"v1.27.0","/release-notes/1.26.4":"v1.26.4","/release-notes/1.26.3":"v1.26.3"}')}}]);
//# sourceMappingURL=component---src-pages-release-notes-1-15-0-mdx-3b7bfe2c78fa0b5b3fe8.js.map