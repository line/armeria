---
menuTitle: "Implement READ"
order: 4
type: step
tags:
  - rest
  - request-converter
level: basic
---

# Implementing READ operation

In this step, you'll implement two methods at once. One is for retrieving a single post and another for multiple blog posts. By completing this step, you'll learn to map your service with the HTTP GET (<type://@Get>) method, use parameter injection (<type://@Param>), set default parameter value (<type://@Default>), and return a JSON object (<type://@ProducesJson>) as a response.

<TutorialSteps current={4} />

## What you need

You must have the following files ready to try retrieving a blog post. You can always [download](https://github.com/line/armeria-examples/blob/master/tutorials/rest-api-annotated-service/src/main/java/example/armeria/server/blog/) the full version, instead of creating one yourself.

- Main.java: See [Step 1. Create a server](/tutorials/tutorial-blog-rest-step1)
- BlogPost.java: See [Step 2. Prepare a data object](/tutorials/tutorial-blog-rest-step2)

## 0. Create a service file

Create a service file, BlogService.java, if you don't have one yet. Skip this step if you've already made one in earlier steps. You can see the full version of the file [here](https://github.com/line/armeria-examples/blob/master/tutorials/rest-api-annotated-service/src/main/java/example/armeria/server/blog/BlogService.java).

<Warning>

To test retrieving a blog post, you need to have blog posts created, which requires you to have the creation method implemented in the BlogService.java. See [Step 3. Implement CREATE](/tutorials/tutorial-blog-rest-step3) for instructions.

</Warning>

```java filename=BlogService.java
package example.armeria.server.blog;

import com.fasterxml.jackson.databind.ObjectMapper;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;

public final class BlogService {
  // Used for serializing and deserializing JSON
  private static final ObjectMapper mapper = new ObjectMapper();

  private Map<Integer, BlogPost> blogPosts = new ConcurrentHashMap<>();
}
```

## 1. Map HTTP method

Let's start [mapping the HTTP GET method](/docs/server-annotated-service#mapping-http-service-methods) with our service method:

1. Declare a service method `getBlogPost()` in the class `BlogService`.
2. Map this service method with the HTTP GET method by adding the <type://@Get> annotation as follows.
3. Bind the endpoint `/blogs` to the method.

```java filename=BlogService.java highlight=7
import com.fasterxml.jackson.core.JsonProcessingException;
import com.linecorp.armeria.server.annotation.*;

public final class BlogService {
  ...

  @Get("/blogs")
  public void getBlogPost(int id)
      throws JsonProcessingException {
    // Retrieve a single post
  }
}
```

## 2. Handle parameters

Take in information through _path_ and _query_ parameters for retrieving blog posts. For retrieving a single post, we'll take a blog post ID as the path parameter. For multiple posts, we'll take the sorting order as a query parameter.

<Tabs defaultActiveKey="1">
<TabPane tab="Single post" key="1">

Let's retrieve a single post:

1. To take in a path parameter, add `/:id` to the <type://@Get> annotation's parameter as in line 1.
2. [Inject the path parameter](/docs/server-annotated-service#parameter-injection) to the service method, annotate the parameter with <type://@Param> as in line 2.

```java filename=BlogService.java showlineno=true
@Get("/blogs/:id")
public void getBlogPost(@Param int id)
    throws JsonProcessingException {
  // Retrieve a single post
}
```

</TabPane>
<TabPane tab="Multiple posts" key="2">

Let's retrieve multiple blog posts:

1. Specify the endpoint for the service using the <type://@Get> annotation.
2. [Inject the parameter](/docs/server-annotated-service#parameter-injection) by annotating the parameter `descending` with <type://@Param> as in line 2.
3. Set the default sorting order to descending by annotating the parameter `descending` with <type://@Default>, with its parameter as `"true"`.

```java filename=BlogService.java showlineno=true
@Get("/blogs")
public void getBlogPosts(@Param @Default("true") boolean descending) {
  // Retrieve multiple posts
}
```

</TabPane>

</Tabs>


## 3. Implement service code

In this step, write the code required for service itself.

<Tabs defaultActiveKey="1">
<TabPane tab="Single post" key="1">

To retrieve a single blog post information, copy the following code inside the `getBlogPost()` method:

```java filename=BlogService.java highlight=4
@Get("/blogs")
public void getBlogPost(@Param int id)
    throws JsonProcessingException {
  BlogPost blogPost = blogPosts.get(id);
}
```

</TabPane>
<TabPane tab="Multiple posts" key="2">

To retrieve multiple blog posts, copy the following code inside the `getBlogPosts()` method. Note that the return type has been changed from `void` to `Iterable<BlogPost>`.

```java filename=BlogService.java
import java.util.Map.Entry;
import java.util.Collections;
import java.util.Comparator;
import static com.google.common.collect.ImmutableList.toImmutableList;

@Get("/blogs")
public Iterable<BlogPost> getBlogPosts(@Param @Default("true") boolean descending) {
  // descending
  if (descending) {
      return blogPosts.entrySet()
                      .stream()
                      .sorted(Collections.reverseOrder(Comparator.comparingInt(Entry::getKey)))
                      .map(Entry::getValue).collect(toImmutableList());
  }
  // ascending
  return blogPosts.values().stream().collect(toImmutableList());
}
```

</TabPane>
</Tabs>


## 4. Return response

Let's return a response for the service call.

<Tabs defaultActiveKey="1">
<TabPane tab="Single post" key="1">

To return a response for getting a single post:

1. Replace the return type of the `getBlogPost()` method from `void` to `HttpResponse`.
2. Return a response using Armeria's <type://HttpResponse> containing the content of the blog post retrieved.

```java filename=BlogService.java highlight=2,5-6
@Get("/blogs/:id")
public HttpResponse getBlogPost(@Param int id)
    throws JsonProcessingException {
  ...
  byte[] content = mapper.writeValueAsBytes(blogPost);
  return HttpResponse.of(HttpStatus.OK, MediaType.JSON_UTF_8, content);
}
```

</TabPane>
<TabPane tab="Multiple posts" key="2">

We've already implemented returning multiple blog posts in the previous step. Here, annotate the method `getBlogPosts()` with <type://@ProducesJson>. This converts a list of `BlogPost` objects into a JSON response.

```java filename=BlogService.java highlight=2
@Get("/blogs")
@ProducesJson
public Iterable<BlogPost> getBlogPosts(@Param @Default("true") boolean descending) {
  // Retrieve multiple blog posts
}
```

</TabPane>
</Tabs>

## 5. Test retrieving a blog post

Let's test retrieving a single and multiple posts.

1. Add our blog service to the server, by removing the dummy service we added in [Step 1. Create a server](/tutorials/tutorial-blog-rest-step1#1-create-a-server-instance) and adding line 6. Skip this process if you've done it already from other steps.

  ```java filename="Main.java" highlight=6 showlineno=true
  public final class Main {
    ...
    static Server newServer(int port) {
      ServerBuilder sb = Server.builder();
      return sb.http(port)
               .annotatedService(new BlogService())
               .build();
  }
  ...
  ```

2. Run the server like we did in [Step 1. Create a server](/tutorials/tutorial-blog-rest-step1) by running the `main()` method or using Gradle. When you see the message, "Server has been started", you can try testing service methods.
3. Create a couple of blog posts to test retrieving a blog post and get the ID value returned. Enter the cURL commands below.

  ```bash
  $ curl --request POST 'localhost:8080/blogs' \
  -H 'Content-Type: application/json' \
  -d '{"title":"Test blog for retrieving", "content":"Create to read."}'
  ```

  ```bash
  $ curl --request POST 'localhost:8080/blogs' \
  -H 'Content-Type: application/json' \
  -d '{"title":"Second blog for test retrieving", "content":"Create to read for the second time"}'
  ```

  For each command, you'll get a response similar to the following.

  ```bash
  {"id":0,"title":"Test blog for retrieving","content":"Create to read.","createdAt":1624856923175,"modifiedAt":1624856923175}

  {"id":1,"title":"Second blog for test retrieving","content":"Create to read for the second time","createdAt":1624864060343,"modifiedAt":1624864060343}
  ```

4. Try retrieving a blog post we just created:

    <Tabs defaultActiveKey="1">
    <TabPane tab="Single post" key="1">

    Let's try retrieving the second blog post we created. Pass the path parameter (blog ID) as `1`.

    ```bash
    $ curl --request GET 'localhost:8080/blogs/1'
    ```

    You'll get a return value similar to this:

    ```bash
    {
      "id":1,
      "title":"Second blog for test retrieving",
      "content":"Create to read for the second time",
      "createdAt":1624864060343,
      "modifiedAt":1624864060343
    }
    ```

    </TabPane>
    <TabPane tab="Multiple posts" key="2">

    Let's try retrieving all the blog posts we've created.

    ```bash
    $ curl --request GET 'localhost:8080/blogs'
    ```

    You'll get a return value similar to this:

    ```bash
    [
      {
        "id":1,
        "title":"Second blog for test retrieving",
        "content":"Create to read for the second time",
        "createdAt":1624864060343,
        "modifiedAt":1624864060343
      },
      {
        "id":0,
        "title":"Test blog for retrieving",
        "content":"Create to read.",
        "createdAt":1624856923175,
        "modifiedAt":1624856923175
      }
    ]
    ```

    </TabPane>
    </Tabs>

You can test this also with Armeria's [Documentation service](/docs/server-docservice), which we'll cover at [Step 7. Add services to server](/tutorials/tutorial-blog-rest-step7).


## Next step

In this step, you've implemented methods for a READ operation and used Armeria's annotations; <type://@Get>, <type://@ProducesJson>, <type://@Param>, and <type://@Default>.

Next, at [Step 5. Implement UPDATE](/tutorials/tutorial-blog-rest-step5), you'll implement an UPDATE operation to modify existing blog posts.

<TutorialSteps current={4} />
