"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[2173],{18511:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/making-a-basic-server-with-java-armeria-2-80eb84c42349487c987a7dbb286e610e.png"},22640:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/making-a-basic-server-with-java-armeria-5-57f6c382db621a5320ffec9a350c821d.png"},28453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>o});var i=r(96540);const t={},a=i.createContext(t);function s(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(a.Provider,{value:n},e.children)}},28889:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/making-a-basic-server-with-java-armeria-4-0abee9bb88f848a5ee8ee433185ae2c7.png"},30158:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var i=r(54528),t=r(74848),a=r(28453);const s={authors:["inseong"]},o="Making a basic server with Java & Armeria",l={authorsImageUrls:[void 0]},c=[{value:"Create a project",id:"create-a-project",level:2},{value:"Configure Gradle",id:"configure-gradle",level:2},{value:"Hello Armeria!",id:"hello-armeria",level:2},{value:"Run a web server for starters",id:"run-a-web-server-for-starters",level:2},{value:"Routing",id:"routing",level:2},{value:"Run again!",id:"run-again",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["As some of you know already, LINE has been actively open-sourcing projects including ",(0,t.jsx)(n.a,{href:"https://line.github.io/armeria/",children:"Armeria"})," and ",(0,t.jsx)(n.a,{href:"https://line.github.io/centraldogma/",children:"Central Dogma"}),".\nToday, I'd like to share a bit about Armeria and setting up a simple web server using Armeria.\nTo follow the instructions, you need to have Java and IntelliJ IDEA installed, which can be downloaded from the following links:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.oracle.com/technetwork/java/javase/downloads/index.html",children:"Java Development Kit"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.jetbrains.com/idea/",children:"IntelliJ IDEA"})}),"\n"]}),"\n","\n",(0,t.jsx)(n.h2,{id:"create-a-project",children:"Create a project"}),"\n",(0,t.jsxs)(n.p,{children:["Let us begin by creating a project.\nFirst, run IntelliJ IDEA and click the ",(0,t.jsx)(n.strong,{children:"Create New Project"})," button.\nThe New Project dialog pops up."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(44020).A+"",width:"1332",height:"964"})}),"\n",(0,t.jsxs)(n.p,{children:["On the New Project dialog, click the ",(0,t.jsx)(n.strong,{children:"Gradle"})," menu from the left panel, and then check the box for ",(0,t.jsx)(n.strong,{children:"Java"}),", and click the Next button.\nThe dialog displays the fields required for project configuration."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(18511).A+"",width:"806",height:"487"})}),"\n",(0,t.jsx)(n.p,{children:"Configure the fields as instructed below."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"GroupId"}),": We will skip this field. This field is optional anyway."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ArtifactId"}),": Enter a name to represent your project. For this post, I named it 'hello-armeria'."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Version"}),": Use the default value already in the input field."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(79494).A+"",width:"806",height:"487"})}),"\n",(0,t.jsxs)(n.p,{children:["Once you are done with filling in, click the ",(0,t.jsx)(n.strong,{children:"Next"})," button.\nContinue with the rest of the step until you see the ",(0,t.jsx)(n.strong,{children:"Finish"})," button."]}),"\n",(0,t.jsx)(n.h2,{id:"configure-gradle",children:"Configure Gradle"}),"\n",(0,t.jsxs)(n.p,{children:["Once a project is created, open the ",(0,t.jsx)(n.code,{children:"build.gradle"})," file, which you can find from the ",(0,t.jsx)(n.strong,{children:"Project"})," panel on the left-hand side.\nYou will see a few lines of code like below.\nAdd the line marked with comments I've left, and save the file.\nThis makes Gradle automatically configure \u2014 download and build \u2014 the Armeria library for you.\nIt may take sometime for the process to be completed."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"plugins {\n    id 'java'\n}\n\nversion '1.0-SNAPSHOT'\n\nsourceCompatibility = 1.8\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    // Add the following line of code\n    // <Group Name>:<Artifact Id>:<Version>\n    compile \"com.linecorp.armeria:armeria:0.71.1\"\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"hello-armeria",children:"Hello Armeria!"}),"\n",(0,t.jsxs)(n.p,{children:["Now, let's make a class.\nGo to ",(0,t.jsx)(n.strong,{children:"src > main"}),", right-click on ",(0,t.jsx)(n.strong,{children:"java"}),", and click ",(0,t.jsx)(n.strong,{children:"New > Java Class"}),".\nWe'll name the class ",(0,t.jsx)(n.code,{children:"ServerMain.java"})," and make it print, ",(0,t.jsx)(n.code,{children:'"Hello, Armeria!"'}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(28889).A+"",width:"678",height:"509"})}),"\n",(0,t.jsxs)(n.p,{children:["First, we will create an instance of the ",(0,t.jsx)(n.code,{children:"ServerBuilder"})," class and run the server, in the following steps:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Set the port using the ",(0,t.jsx)(n.code,{children:"http()"})," method."]}),"\n",(0,t.jsxs)(n.li,{children:["Configure the server with the ",(0,t.jsx)(n.code,{children:"service()"})," method."]}),"\n",(0,t.jsxs)(n.li,{children:["Create an instance of ",(0,t.jsx)(n.code,{children:"Server"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Call the ",(0,t.jsx)(n.code,{children:"start()"})," method."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Here is the actual code:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'import com.linecorp.armeria.common.HttpResponse;\nimport com.linecorp.armeria.common.HttpStatus;\nimport com.linecorp.armeria.common.MediaType;\nimport com.linecorp.armeria.server.Server;\nimport com.linecorp.armeria.server.ServerBuilder;\nimport java.util.concurrent.CompletableFuture;\n\npublic class ServerMain {\n    public static void main(String[] args) {\n        ServerBuilder sb = new ServerBuilder();\n        sb.http(8080);\n        sb.service("/hello", (ctx, res) ->\n            HttpResponse.of(\n                HttpStatus.OK,\n                MediaType.HTML_UTF_8,\n                "<h1>Hello Armeria...!</h1>"));\n        Server server = sb.build();\n        CompletableFuture<Void> future = server.start();\n        future.join();\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["To those who are unfamiliar with IntelliJ IDEA, here is a little tip on importing classes.\nWhen you enter the name of a class in your code and the class needs to be imported \u2014 in our case, ",(0,t.jsx)(n.code,{children:"ServerBuilder"})," and ",(0,t.jsx)(n.code,{children:"HttpResponse"})," \u2014 press ",(0,t.jsx)(n.strong,{children:"ALT + Enter"}),".\nYou will see the context menu with options available for the given class.\nSelect ",(0,t.jsx)(n.strong,{children:"Import class"})," from the menu which will automatically add an import statement for the specified class on the file."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(22640).A+"",width:"522",height:"223"})}),"\n",(0,t.jsxs)(n.p,{children:["Note that if you select the ",(0,t.jsx)(n.strong,{children:"Import class"})," option on ",(0,t.jsx)(n.code,{children:"MediaType"}),", available options are as follows:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"MediaType (com.google.common.net)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"MediaType (com.linecorp.armeria.common)"})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Since we are using Armeria, select ",(0,t.jsx)(n.code,{children:"com.linecorp.armeria.common"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(93931).A+"",width:"1030",height:"203"})}),"\n",(0,t.jsx)(n.h2,{id:"run-a-web-server-for-starters",children:"Run a web server for starters"}),"\n",(0,t.jsxs)(n.p,{children:["To run a web server from IntelliJ IDEA, go to ",(0,t.jsx)(n.strong,{children:"Run > Run <file_name>"}),".\nYou may see warnings on SLF4J (a library for printing out logs) that it cannot find a suitable logger implementation, but that's not important at the moment.\nLet's focus on getting our Armeria server up and running.Open a web browser, enter the URL, ",(0,t.jsx)(n.a,{href:"http://127.0.0.1:8080/hello",children:"http://127.0.0.1:8080/hello"}),", and you will be greeted with ",(0,t.jsx)(n.code,{children:'"Hello, Armeria...!"'}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(72802).A+"",width:"576",height:"246"})}),"\n",(0,t.jsx)(n.p,{children:"So, that was it!\nMaking a web server with Java couldn't be simpler than this, right?\nYou've only seen the tip of the iceberg; there is much more to Armeria than this.\nJust to show you a little bit more, let's move onto routing, the most basic and the core feature of web servers."}),"\n",(0,t.jsx)(n.h2,{id:"routing",children:"Routing"}),"\n",(0,t.jsxs)(n.p,{children:["Create a Java class and name it ",(0,t.jsx)(n.code,{children:"CustomService"})," or any other name you like.\nCopy and paste the following code in the class.\nIn addition to ",(0,t.jsx)(n.code,{children:"HttpResponse.of()"}),", I've added annotations for routing.\nTo keep things simple, I did not add this configuration in the ",(0,t.jsx)(n.code,{children:"build.gradle"})," file, but instead, passed a parameter, ",(0,t.jsx)(n.code,{children:'@Param("number") int number'}),".\nYou can enter parameters like ",(0,t.jsx)(n.code,{children:"@Param int number"}),", if you add ",(0,t.jsx)(n.code,{children:"-parameters"})," in the compile option for ",(0,t.jsx)(n.code,{children:"build.gradle"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Using annotations, we set up routing; set ",(0,t.jsx)(n.code,{children:"methodA()"})," to be called via ",(0,t.jsx)(n.code,{children:'GET "/"'}),".\nLikewise, ",(0,t.jsx)(n.code,{children:"methodB()"})," is to be called via ",(0,t.jsx)(n.code,{children:'GET "/page/<number>"'}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'import com.linecorp.armeria.common.HttpResponse;\nimport com.linecorp.armeria.common.HttpStatus;\nimport com.linecorp.armeria.common.MediaType;\nimport com.linecorp.armeria.server.annotation.Get;\nimport com.linecorp.armeria.server.annotation.Param;\n\npublic class CustomService {\n    @Get("/")\n    public HttpResponse methodA() {\n        return HttpResponse.of(\n            HttpStatus.OK,\n            MediaType.HTML_UTF_8,\n            "<h1>Hello Custom Service...!</h1>");\n    }\n\n    @Get("/page/:number")\n    public HttpResponse methodB(@Param("number") int number) {\n        return HttpResponse.of(\n            HttpStatus.OK,\n            MediaType.HTML_UTF_8,\n            "<h1>Hello %d...!</h1>", number);\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The next step is to modify our class, ",(0,t.jsx)(n.code,{children:"ServerMain"}),".\nWe need to pass the instance of the ",(0,t.jsx)(n.code,{children:"CustomService"})," class.\nTo do so, call the ",(0,t.jsx)(n.code,{children:"annotatedService()"})," method and pass the instance as the parameter."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"import com.linecorp.armeria.server.Server;\nimport com.linecorp.armeria.server.ServerBuilder;\nimport java.util.concurrent.CompletableFuture;\n\npublic class ServerMain {\n    public static void main(String[] args) {\n        ServerBuilder sb = new ServerBuilder();\n        sb.http(8080);\n\n        sb.annotatedService(new CustomService());\n\n        Server server = sb.build();\n        CompletableFuture<Void> future = server.start();\n        future.join();\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"run-again",children:"Run again!"}),"\n",(0,t.jsxs)(n.p,{children:["Now run the code and open ",(0,t.jsx)(n.a,{href:"http://127.0.0.1:8080/",children:"http://127.0.0.1:8080/"}),".\nYou will see ",(0,t.jsx)(n.code,{children:'"Hello Custom Service...!"'})," printed on the page."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(67333).A+"",width:"576",height:"246"})}),"\n",(0,t.jsxs)(n.p,{children:["This time, add ",(0,t.jsx)(n.code,{children:"/page/10"})," to the URL to make it ",(0,t.jsx)(n.a,{href:"http://127.0.0.1:8080/page/10",children:"http://127.0.0.1:8080/page/10"}),", and open the page.\nYou will see ",(0,t.jsx)(n.code,{children:'"Hello 10...!"'})," instead."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(84444).A+"",width:"603",height:"246"})}),"\n",(0,t.jsxs)(n.p,{children:["Using Armeria, implementing routing is a piece of cake!\nToday, we've looked through the most basic way of using Armeria.\nArmeria supports serving static files, running and calling Thrift services, structured logging with Kafka and many others.\nVisit the ",(0,t.jsx)(n.a,{href:"https://line.github.io/armeria/",children:"official Armeria site"})," and the ",(0,t.jsx)(n.a,{href:"https://github.com/line/armeria",children:"GitHub repository"})," to learn more about Armeria."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:r(60686).A+"",width:"1552",height:"1012"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},44020:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/making-a-basic-server-with-java-armeria-1-f9cd4bd82d79b146a04372e6c3cf26af.png"},54528:e=>{e.exports=JSON.parse('{"permalink":"/blog/2018/09/13/making-a-basic-server-with-java-armeria","editUrl":"https://github.com/line/armeria/edit/main/site/src/content/blog/en/2018-09-13-making-a-basic-server-with-java-armeria.mdx","source":"@site/src/content/blog/en/2018-09-13-making-a-basic-server-with-java-armeria.mdx","title":"Making a basic server with Java & Armeria","description":"As some of you know already, LINE has been actively open-sourcing projects including Armeria and Central Dogma.","date":"2018-09-13T00:00:00.000Z","tags":[],"readingTime":5.36,"hasTruncateMarker":true,"authors":[{"name":"Inseong","title":"LINE Engineer","imageURL":"/img/author-inseong.png","key":"inseong","page":null}],"frontMatter":{"authors":["inseong"]},"unlisted":false,"prevItem":{"title":"Thank you for contributing to Armeria!","permalink":"/blog/2019/04/16/thank-you-for-contributing-to-armeria"},"nextItem":{"title":"Applying CircuitBreaker to Channel Gateway","permalink":"/blog/2016/08/04/applying-circuitbreaker-to-channel-gateway"}}')},60686:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/making-a-basic-server-with-java-armeria-10-719b12466c159ea32a06306171e69614.png"},67333:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/making-a-basic-server-with-java-armeria-8-0e388a130c6e1da91fa599abe2292ab3.png"},72802:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/making-a-basic-server-with-java-armeria-7-a72df7033eb694ec9d3aa68da72e7ac9.png"},79494:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/making-a-basic-server-with-java-armeria-3-133fca86fc557e3340b69025921d2f63.png"},84444:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/making-a-basic-server-with-java-armeria-9-14d6092166514d80e35de57af09e460d.png"},93931:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/making-a-basic-server-with-java-armeria-6-f0515b31fdeb8dae7c16535963042dd1.png"}}]);