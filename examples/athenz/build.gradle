plugins {
    id 'application'
}

dependencies {
    implementation project(':core')
    implementation project(':athenz')
    implementation project(':grpc')
    implementation libs.testcontainers.core
    implementation libs.athenz.zms.client
    implementation libs.athenz.zts.client
    runtimeOnly libs.slf4j.simple

    testImplementation project(':junit5')
    testImplementation libs.assertj
    testImplementation libs.junit5.jupiter.api
    testImplementation libs.testcontainers.junit.jupiter
}

application {
    mainClass.set('example.armeria.athenz.Main')
}

// Copy the Athenz Docker resources from ':athenz'.
task copyTestResources(type: Copy) {
    from("${rootProject.projectDir}/athenz/src/test") {
        include 'resources/**'
        include '**/AthenzDocker.java'
    }
    into "${project.ext.genSrcDir}/main"
}

tasks.compileJava.dependsOn(tasks.copyTestResources)
tasks.processResources.dependsOn(tasks.copyTestResources)
tasks.sourcesJar.dependsOn(tasks.copyTestResources)
