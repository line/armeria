"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[3111],{28453:(e,r,s)=>{s.d(r,{R:()=>c,x:()=>o});var n=s(96540);const t={},i=n.createContext(t);function c(e){const r=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),n.createElement(i.Provider,{value:r},e.children)}},88803:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"server/access-log","title":"Writing an access log","description":"Configuring logging framework","source":"@site/src/content/docs/server/access-log.mdx","sourceDirName":"server","slug":"/server/access-log","permalink":"/docs/server/access-log","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site/src/content/docs/server/access-log.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Embedding a servlet container","permalink":"/docs/server/servlet"},"next":{"title":"Configuring CORS","permalink":"/docs/server/cors"}}');var t=s(74848),i=s(28453);const c={},o="Writing an access log",d={},l=[{value:"Configuring logging framework",id:"configuring-logging-framework",level:2},{value:"logback",id:"logback",level:3},{value:"log4j2",id:"log4j2",level:3},{value:"Customizing a log format",id:"customizing-a-log-format",level:2},{value:"Retrieving values from <code>RequestLog</code>",id:"retrieving-values-from-requestlog",level:3},{value:"Customizing timestamp format",id:"customizing-timestamp-format",level:3},{value:"Customizing an access log writer",id:"customizing-an-access-log-writer",level:2},{value:"Customizing an access logger",id:"customizing-an-access-logger",level:2}];function a(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"writing-an-access-log",children:"Writing an access log"})}),"\n",(0,t.jsx)(r.h2,{id:"configuring-logging-framework",children:"Configuring logging framework"}),"\n",(0,t.jsxs)(r.p,{children:["To write an access log, you need to configure a logging framework first. The following configurations are\nsimple examples of ",(0,t.jsx)(r.code,{children:"logback.xml"})," and ",(0,t.jsx)(r.code,{children:"log4j2.xml"})," respectively."]}),"\n",(0,t.jsx)(r.h3,{id:"logback",children:"logback"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<configuration>\n  <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">\n    <encoder>\n      <pattern>%-4relative [%thread] %-5level %logger{35} - %msg%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="ACCESS" class="ch.qos.logback.core.rolling.RollingFileAppender">\n    <file>access.log</file>\n    <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">\n      \x3c!-- daily rollover --\x3e\n      <fileNamePattern>access.%d{yyyy-MM-dd}-%i.log</fileNamePattern>\n      \x3c!-- each file should be at most 1GB, keep 30 days worth of history, but at most 30GB --\x3e\n      <maxFileSize>1GB</maxFileSize>\n      <maxHistory>30</maxHistory>\n      <totalSizeCap>30GB</totalSizeCap>\n    </rollingPolicy>\n    <encoder>\n      <pattern>%msg%n</pattern>\n    </encoder>\n  </appender>\n\n  <logger name="com.linecorp.armeria.logging.access" level="INFO" additivity="false">\n    <appender-ref ref="ACCESS"/>\n  </logger>\n\n  <root level="DEBUG">\n    <appender-ref ref="CONSOLE"/>\n  </root>\n</configuration>\n'})}),"\n",(0,t.jsx)(r.h3,{id:"log4j2",children:"log4j2"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<Configuration status="WARN">\n  <Appenders>\n    <Console name="CONSOLE" target="SYSTEM_OUT">\n      <PatternLayout pattern="%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"/>\n    </Console>\n    <RollingFile name="ACCESS" fileName="access.log"\n                 filePattern="access.%d{MM-dd-yyyy}-%i.log.gz">\n      <PatternLayout>\n        <Pattern>%m%n</Pattern>\n      </PatternLayout>\n\n      <Policies>\n        \x3c!-- daily rollover --\x3e\n        <TimeBasedTriggeringPolicy/>\n        \x3c!-- each file should be at most 1GB --\x3e\n        <SizeBasedTriggeringPolicy size="1GB"/>\n      </Policies>\n      \x3c!-- keep 30 archives --\x3e\n      <DefaultRolloverStrategy max="30"/>\n    </RollingFile>\n  </Appenders>\n\n  <Loggers>\n    <Logger name="com.linecorp.armeria.logging.access" level="INFO" additivity="false">\n      <AppenderRef ref="ACCESS"/>\n    </Logger>\n    <Root level="DEBUG">\n      <AppenderRef ref="CONSOLE"/>\n    </Root>\n  </Loggers>\n</Configuration>\n'})}),"\n",(0,t.jsx)(r.h2,{id:"customizing-a-log-format",children:"Customizing a log format"}),"\n",(0,t.jsxs)(r.p,{children:["Access logging is disabled by default. If you want to enable it, you need to specify an ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/logging/AccessLogWriter.html",children:"AccessLogWriter"}),".\nYou may use one of the pre-defined log formats."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'import com.linecorp.armeria.server.ServerBuilder;\nimport com.linecorp.armeria.server.logging.AccessLogWriter;\n\nServerBuilder sb = Server.builder();\n// Use NCSA common log format.\nsb.accessLogWriter(AccessLogWriter.common(), true);\n// Use NCSA combined log format.\nsb.accessLogWriter(AccessLogWriter.combined(), true);\n// Use your own log format.\nsb.accessLogFormat("...log format...");\n...\n'})}),"\n",(0,t.jsxs)(r.p,{children:["You can have different ",(0,t.jsx)(r.a,{href:"typeplural://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/logging/AccessLogWriter.html",children:"AccessLogWriter"})," for ",(0,t.jsx)(r.a,{href:"typeplural://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/VirtualHost.html",children:"VirtualHost"})," and ",(0,t.jsx)(r.a,{href:"typeplural://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/Service.html",children:"Service"}),"."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'ServerBuilder sb = Server.builder();\nAccessLogWriter fallbackLogWriter = ...\nsb.accessLogWriter(fallbackLogWriter);\n\nsb.virtualHost("foo.com")\n  .accessLogWriter(AccessLogWriter.combined(), true)\n  .service((ctx, req) -> HttpResponse.of(OK)); // This service will log using the combined format.\n  ...\n\nsb.route()\n  .get("/commonAccessLog")\n  .accessLogWriter(AccessLogWriter.common(), true)\n  .build((ctx, req) -> HttpResponse.of(OK)); // This service will log using the common format.\n\n// This service will log using the fallbackLogWriter.\nsb.service("/fallbackLogWriter", (ctx, req) -> HttpResponse.of(OK));\n'})}),"\n",(0,t.jsx)(r.p,{children:"Pre-defined log formats are as follows."}),"\n",(0,t.jsx)(r.p,{children:"Tokens for the log format are listed in the following table."}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:(0,t.jsx)("div",{style:{width:"12rem"},children:"Tokens"})}),(0,t.jsx)(r.th,{children:"Condition support"}),(0,t.jsx)(r.th,{children:"Description"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%A"})}),(0,t.jsx)(r.td,{children:"No"}),(0,t.jsx)(r.td,{children:"the local IP address"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%a"})}),(0,t.jsx)(r.td,{children:"No"}),(0,t.jsxs)(r.td,{children:["the IP address of the client who initiated a request. Use ",(0,t.jsx)(r.code,{children:"%{c}a"})," format string to get the remote IP address where the channel is connected to, which may yield a different value when there is an intermediary proxy server. This value relies on the ",(0,t.jsx)(r.code,{children:"clientAddress()"})," and ",(0,t.jsx)(r.code,{children:"remoteAddress()"})," methods of ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/ServiceRequestContext.html",children:"ServiceRequestContext"}),", please refer to ",(0,t.jsx)(r.a,{href:"/docs/server/basics#getting-an-ip-address-of-a-client-who-initiated-a-request",children:"Getting an IP address of a client who initiated a request"})," about how to configure the ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/ServerBuilder.html",children:"ServerBuilder"})," to get the client address you interest."]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%h"})}),(0,t.jsx)(r.td,{children:"No"}),(0,t.jsx)(r.td,{children:"the remote hostname or IP address if DNS hostname lookup is not available"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%I"})}),(0,t.jsx)(r.td,{children:"No"}),(0,t.jsxs)(r.td,{children:["the request ID. Use ",(0,t.jsx)(r.code,{children:"%{short}I"})," format string to get the short form."]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%l"})}),(0,t.jsx)(r.td,{children:"No"}),(0,t.jsxs)(r.td,{children:["the remote logname of the user (not supported yet, always write ",(0,t.jsx)(r.code,{children:"-"}),")"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%u"})}),(0,t.jsx)(r.td,{children:"No"}),(0,t.jsxs)(r.td,{children:["the name of the authenticated remote user (not supported yet, always write ",(0,t.jsx)(r.code,{children:"-"}),")"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%t"})}),(0,t.jsx)(r.td,{children:"No"}),(0,t.jsxs)(r.td,{children:["the date, time and time zone that the request was received, by default in ",(0,t.jsx)(r.code,{children:"strftime"})," format %d/%b/%Y:%H:%M:%S %z. (for example, ",(0,t.jsx)(r.code,{children:"10/Oct/2000:13:55:36 -0700"}),") Refer to ",(0,t.jsx)(r.a,{href:"#customizing-timestamp-format",children:"Customizing timestamp format"})," for more information."]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%r"})}),(0,t.jsx)(r.td,{children:"Yes"}),(0,t.jsxs)(r.td,{children:["the request line from the client (for example, ",(0,t.jsx)(r.code,{children:"GET /path h2"}),")"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%s"})}),(0,t.jsx)(r.td,{children:"No"}),(0,t.jsx)(r.td,{children:"the HTTP status code returned to the client"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%b"})}),(0,t.jsx)(r.td,{children:"Yes"}),(0,t.jsx)(r.td,{children:"the size of the object returned to the client, measured in bytes"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%{HEADER_NAME}i"})}),(0,t.jsx)(r.td,{children:"Yes"}),(0,t.jsx)(r.td,{children:"the value of the specified HTTP request header name"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%{HEADER_NAME}o"})}),(0,t.jsx)(r.td,{children:"Yes"}),(0,t.jsx)(r.td,{children:"the value of the specified HTTP response header name"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%{ATTRIBUTE_NAME}j"})}),(0,t.jsx)(r.td,{children:"Yes"}),(0,t.jsx)(r.td,{children:"the value of the specified attribute name"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%{REQUEST_LOG_NAME}L"})}),(0,t.jsx)(r.td,{children:"Yes"}),(0,t.jsxs)(r.td,{children:["the value of the specified variable of the ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RequestLog.html",children:"RequestLog"}),". Refer to ",(0,t.jsx)(r.a,{href:"#retrieving-values-from-requestlog",children:"Retrieving values from RequestLog"})," for more information."]})]})]})]}),"\n",(0,t.jsx)(r.p,{children:"Some tokens can have a condition of the response status code and the log message can be omitted with\nthe condition."}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:(0,t.jsx)("div",{style:{width:"25rem"},children:"Example of a condition"})}),(0,t.jsx)(r.th,{children:"Description"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%200b"})}),(0,t.jsxs)(r.td,{children:["Write the size of the object returned to the client only if the response code is ",(0,t.jsx)(r.code,{children:"200"}),"."]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%200,304{User-Agent}i"})}),(0,t.jsxs)(r.td,{children:["Write ",(0,t.jsx)(r.code,{children:"User-Agent"})," header value only if the response code is ",(0,t.jsx)(r.code,{children:"200"})," or ",(0,t.jsx)(r.code,{children:"304"}),"."]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"%!200,304{com.example.armeria.Attribute#KEY}j"})}),(0,t.jsxs)(r.td,{children:["Write the value of the specified attribute only if the response code is neither ",(0,t.jsx)(r.code,{children:"200"})," nor ",(0,t.jsx)(r.code,{children:"304"}),"."]})]})]})]}),"\n",(0,t.jsxs)(r.h3,{id:"retrieving-values-from-requestlog",children:["Retrieving values from ",(0,t.jsx)(r.code,{children:"RequestLog"})]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RequestLog.html",children:"RequestLog"})," holds information about the request, so a user may want to write these values to his or\nher access log file. To write them in a simple way, ",(0,t.jsx)(r.code,{children:"%{variable}L"})," token is provided with the following\nsupported variable:"]}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:(0,t.jsx)("div",{style:{width:"13rem"},children:"Name"})}),(0,t.jsx)(r.th,{children:"Description"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"method"})}),(0,t.jsx)(r.td,{children:"the HTTP method value of the request"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"path"})}),(0,t.jsx)(r.td,{children:"the absolute path part of the HTTP request URI"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"query"})}),(0,t.jsx)(r.td,{children:"the query part of the HTTP request URI"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"requestStartTimeMillis"})}),(0,t.jsx)(r.td,{children:"the time when the processing of the request started, in milliseconds since the epoch"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"requestDurationMillis"})}),(0,t.jsx)(r.td,{children:"the duration that was taken to consume or produce the request completely, in milliseconds"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"requestDurationNanos"})}),(0,t.jsx)(r.td,{children:"the duration that was taken to consume or produce the request completely, in nanoseconds"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"requestLength"})}),(0,t.jsx)(r.td,{children:"the length of the request content"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"requestCause"})}),(0,t.jsx)(r.td,{children:"the cause of request processing failure. The class name of the cause and the detail message of it will be contained if exists."})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"requestContentPreview"})}),(0,t.jsx)(r.td,{children:"the preview of the request content"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"responseStartTimeMillis"})}),(0,t.jsx)(r.td,{children:"the time when the processing of the response started, in milliseconds since the epoch"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"responseDurationMillis"})}),(0,t.jsx)(r.td,{children:"the duration that was taken to consume or produce the response completely, in milliseconds"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"responseDurationNanos"})}),(0,t.jsx)(r.td,{children:"the duration that was taken to consume or produce the response completely, in nanoseconds"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"responseLength"})}),(0,t.jsx)(r.td,{children:"the length of the response content"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"responseCause"})}),(0,t.jsx)(r.td,{children:"the cause of response processing failure. The class name of the cause and the detail message of it will be contained if exists."})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"responseContentPreview"})}),(0,t.jsx)(r.td,{children:"the preview of the response content"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"totalDurationMillis"})}),(0,t.jsx)(r.td,{children:"the amount of time taken since the request processing started and until the response processing ended, in milliseconds"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"totalDurationNanos"})}),(0,t.jsx)(r.td,{children:"the amount of time taken since the request processing started and until the response processing ended, in nanoseconds"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"sessionProtocol"})}),(0,t.jsxs)(r.td,{children:["the session protocol of the request. e.g. ",(0,t.jsx)(r.code,{children:"h1"}),", ",(0,t.jsx)(r.code,{children:"h2"}),", ",(0,t.jsx)(r.code,{children:"h1c"})," or ",(0,t.jsx)(r.code,{children:"h2c"})]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"serializationFormat"})}),(0,t.jsxs)(r.td,{children:["the serialization format of the request. e.g. ",(0,t.jsx)(r.code,{children:"tbinary"}),", ",(0,t.jsx)(r.code,{children:"ttext"}),", ",(0,t.jsx)(r.code,{children:"tcompact"}),", ",(0,t.jsx)(r.code,{children:"tjson"})," or ",(0,t.jsx)(r.code,{children:"none"})]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"scheme"})}),(0,t.jsxs)(r.td,{children:["the scheme value printed as ",(0,t.jsx)(r.code,{children:"serializationFormat+sessionProtocol"})]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"host"})}),(0,t.jsx)(r.td,{children:"the host name of the request"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"status"})}),(0,t.jsxs)(r.td,{children:["the status code and its reason phrase of the response. e.g. ",(0,t.jsx)(r.code,{children:"200 OK"})]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"statusCode"})}),(0,t.jsxs)(r.td,{children:["the status code of the response. e.g. ",(0,t.jsx)(r.code,{children:"200"})]})]})]})]}),"\n",(0,t.jsx)(r.h3,{id:"customizing-timestamp-format",children:"Customizing timestamp format"}),"\n",(0,t.jsxs)(r.p,{children:["You can specify a new date/time format for the ",(0,t.jsx)(r.code,{children:"%t"})," token with\n",(0,t.jsx)(r.a,{href:"https://docs.oracle.com/javase/10/docs/api/java/time/format/DateTimeFormatter.html",children:"DateTimeFormatter"}),".\nYou can use one of the following formatters which is provided by JDK as a variable of the ",(0,t.jsx)(r.code,{children:"%t"})," token,\ne.g. ",(0,t.jsx)(r.code,{children:"%{BASIC_ISO_DATE}t"}),". If you want to use your own pattern, you can specify it as the variable,\ne.g. ",(0,t.jsx)(r.code,{children:"%{yyyy MM dd}t"}),"."]}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Formatter"}),(0,t.jsx)(r.th,{children:"Description"}),(0,t.jsx)(r.th,{children:"Example"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"BASIC_ISO_DATE"})}),(0,t.jsx)(r.td,{children:"Basic ISO date"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"20111203"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_LOCAL_DATE"})}),(0,t.jsx)(r.td,{children:"ISO Local Date"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"2011-12-03"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_OFFSET_DATE"})}),(0,t.jsx)(r.td,{children:"ISO Date with offset"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"2011-12-03+01:00"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_DATE"})}),(0,t.jsx)(r.td,{children:"ISO Date with or without offset"}),(0,t.jsxs)(r.td,{children:[(0,t.jsx)(r.code,{children:"2011-12-03+01:00"}),"; ",(0,t.jsx)(r.code,{children:"2011-12-03"})]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_LOCAL_TIME"})}),(0,t.jsx)(r.td,{children:"Time without offset"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"10:15:30"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_OFFSET_TIME"})}),(0,t.jsx)(r.td,{children:"Time with offset"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"10:15:30+01:00"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_TIME"})}),(0,t.jsx)(r.td,{children:"Time with or without offset"}),(0,t.jsxs)(r.td,{children:[(0,t.jsx)(r.code,{children:"10:15:30+01:00"}),"; ",(0,t.jsx)(r.code,{children:"10:15:30"})]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_LOCAL_DATE_TIME"})}),(0,t.jsx)(r.td,{children:"ISO Local Date and Time"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"2011-12-03T10:15:30"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_OFFSET_DATE_TIME"})}),(0,t.jsx)(r.td,{children:"Date Time with Offset"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"2011-12-03T10:15:30+01:00"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_ZONED_DATE_TIME"})}),(0,t.jsx)(r.td,{children:"Zoned Date Time"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"2011-12-03T10:15:30+01:00[Europe/Paris]"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_DATE_TIME"})}),(0,t.jsx)(r.td,{children:"Date and time with ZoneId"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"2011-12-03T10:15:30+01:00[Europe/Paris]"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_ORDINAL_DATE"})}),(0,t.jsx)(r.td,{children:"Year and day of year"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"2012-337"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_WEEK_DATE"})}),(0,t.jsx)(r.td,{children:"Year and Week"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"2012-W48-6"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"ISO_INSTANT"})}),(0,t.jsx)(r.td,{children:"Date and Time of an Instant"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"2011-12-03T10:15:30Z"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"RFC_1123_DATE_TIME"})}),(0,t.jsx)(r.td,{children:"RFC 1123 / RFC 822"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"Tue, 3 Jun 2008 11:05:30 GMT"})})]})]})]}),"\n",(0,t.jsx)(r.h2,{id:"customizing-an-access-log-writer",children:"Customizing an access log writer"}),"\n",(0,t.jsxs)(r.p,{children:["You can specify your own log writer which implements a ",(0,t.jsx)(r.code,{children:"Consumer"})," of ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RequestLog.html",children:"RequestLog"}),"."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:"ServerBuilder sb = Server.builder();\nsb.accessLogWriter(requestLog -> {\n    // Write your access log with the given RequestLog instance.\n    ...\n}, true);\n"})}),"\n",(0,t.jsx)(r.h2,{id:"customizing-an-access-logger",children:"Customizing an access logger"}),"\n",(0,t.jsx)(r.p,{children:"Armeria uses an SLF4J logger whose name is based on a reversed domain name of each virtual host by\ndefault, e.g."}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"com.linecorp.armeria.logging.access.com.example"})," for ",(0,t.jsx)(r.code,{children:"*.example.com"})]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"com.linecorp.armeria.logging.access.com.linecorp"})," for ",(0,t.jsx)(r.code,{children:"*.linecorp.com"})]}),"\n"]}),"\n",(0,t.jsxs)(r.p,{children:["Alternatively, you can specify your own mapper or logger for a ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/VirtualHost.html",children:"VirtualHost"}),", e.g."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'ServerBuilder sb = Server.builder();\n\n// Using the specific logger name.\nsb.accessLogger("com.example.my.access.logs");\n...\n\n// Using your own logger.\nLogger logger = LoggerFactory.getLogger("com.example2.my.access.logs");\nsb.accessLogger(Logger);\n...\n\n// Using the mapper which sets an access logger with the given VirtualHost instance.\nsb.accessLogger(virtualHost -> {\n    // Return the logger.\n    // Do not return null. Otherwise, it will raise an IllegalStateException.\n    return LoggerFactory.getLogger("com.example.my.access.logs." + virtualHost.defaultHostname());\n});\n...\n'})}),"\n",(0,t.jsxs)(r.p,{children:["You can also specify your own logger for the specific ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/VirtualHost.html",children:"VirtualHost"}),". In this case, the mapper or logger\nyou set for a specific ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/VirtualHost.html",children:"VirtualHost"})," will override the access logger set via\n",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/ServerBuilder.html#accessLogger(org.slf4j.Logger)",children:"ServerBuilder#accessLogger(Logger)"}),"."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'// Using the specific logger name.\nsb.virtualHost("*.example.com")\n  .accessLogger("com.example.my.access.logs")\n  .and()\n...\n\n// Using your own logger.\nLogger logger = LoggerFactory.getLogger("com.example2.my.access.logs");\nsb.virtualHost("*.example2.com")\n  .accessLogger(Logger)\n  .and()\n...\n\n// Using the mapper which sets an access logger with the given VirtualHost instance.\nsb.virtualHost("*.example3.com")\n  .accessLogger(virtualHost -> {\n    // Return the logger.\n    // Do not return null. Otherwise, it will raise an IllegalStateException.\n    return LoggerFactory.getLogger("com.example.my.access.logs." + virtualHost.defaultHostname());\n  })\n...\n'})})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);