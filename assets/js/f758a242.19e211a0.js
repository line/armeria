"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[1126],{28453:(e,r,i)=>{i.d(r,{R:()=>t,x:()=>c});var n=i(96540);const s={},a=n.createContext(s);function t(e){const r=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),n.createElement(a.Provider,{value:r},e.children)}},61410:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>o,contentTitle:()=>c,default:()=>d,frontMatter:()=>t,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"1.22.0","title":"v1.22.0","description":"\ud83c\udf1f New features","source":"@site/src/content/release-notes/1.22.0.mdx","sourceDirName":".","slug":"/1.22.0","permalink":"/release-notes/1.22.0","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site-new/src/content/release-notes/1.22.0.mdx","tags":[],"version":"current","frontMatter":{"date":"2023-02-09T00:00:00.000Z"},"sidebar":"defaultSidebar","previous":{"title":"v1.22.1","permalink":"/release-notes/1.22.1"},"next":{"title":"v1.21.0","permalink":"/release-notes/1.21.0"}}');var s=i(74848),a=i(28453);const t={date:new Date("2023-02-09T00:00:00.000Z")},c="v1.22.0",o={},l=[{value:"\ud83c\udf1f New features",id:"-new-features",level:2},{value:"\ud83d\udcc8 Improvements",id:"-improvements",level:2},{value:"\ud83d\udee0\ufe0f Bug fixes",id:"\ufe0f-bug-fixes",level:2},{value:"\ud83c\udfda\ufe0f Deprecations",id:"\ufe0f-deprecations",level:2},{value:"\u2622\ufe0f Breaking changes",id:"\ufe0f-breaking-changes",level:2},{value:"\u26d3 Dependencies",id:"-dependencies",level:2},{value:"\ud83d\ude47 Thank you",id:"-thank-you",level:2}];function h(e){const r={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components},{ThankYou:i}=r;return i||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ThankYou",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.header,{children:[(0,s.jsx)(r.h1,{id:"v1220",children:"v1.22.0"}),(0,s.jsx)(r.p,{children:(0,s.jsx)(r.em,{children:"February 9, 2023"})})]}),"\n",(0,s.jsx)(r.h2,{id:"-new-features",children:"\ud83c\udf1f New features"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/circuitbreaker/CircuitBreakerClient.html",children:"CircuitBreakerClient"})," integration with Resilience4j's circuit breaker is now available. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/1469",children:"#1469"})," ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4139",children:"#4139"})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Note that ",(0,s.jsx)(r.code,{children:"armeria-resilience4j2"})," requires Java 17 or higher."]}),"\n"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-java",children:"Resilience4jCircuitBreakerMapping mapping =\n  Resilience4jCircuitBreakerMapping.of();\nWebClient client = WebClient\n  .builder()\n  .decorator(CircuitBreakerClient\n    .builder(CircuitBreakerRule.onException())\n    .handler(Resilience4JCircuitBreakerClientHandler.of(mapping)) // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n    .newDecorator())\n  ...\n"})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["You can now use ",(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/grpc/AsyncServerInterceptor.html",children:"AsyncServerInterceptor"})," to asynchronously intercept gRPC service calls. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4647",children:"#4647"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-java",children:'class AuthServerInterceptor implements AsyncServerInterceptor {\n  @Override\n  <I, O> CompletableFuture<Listener<I>> asyncInterceptCall(\n        ServerCall<I, O> call, Metadata headers, ServerCallHandler<I, O> next) {\n    return authorizer.authorize(headers).thenApply(result -> {\n      if (result) {\n        return next.startCall(call, headers);\n      } else {\n        throw new AuthenticationException("Invalid access");\n      }\n    });\n  }\n}\n\nGrpcService.builder()\n           .intercept(new AuthServerInterceptor()) // \ud83d\udc48\ud83d\udc48\ud83d\udc48\n           .addService(...)\n           ...\n'})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/annotation/Blocking.html",children:"@Blocking"})," annotation can now be used with gRPC services. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4389",children:"#4389"})," ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4585",children:"#4585"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-java",children:"@Blocking // \ud83d\udc48\ud83d\udc48\ud83d\udc48 applies to all methods in the class\nclass MyGrpcServiceImpl extends MyGrpcServiceImplBase {\n  @Blocking // \ud83d\udc48\ud83d\udc48\ud83d\udc48 applies to a single method\n  public void blockingCall(...) {\n    ...\n  }\n}\n"})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Armeria server with Spring integration can now be configured to bind to non-ip addresses. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4597",children:"#4597"})," ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4598",children:"#4598"})]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["The authenticated remote user set by ",(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RequestLogBuilder.html#authenticatedUser(java.lang.String)",children:"RequestLogBuilder#authenticatedUser(String)"})," is now logged in access\nlogs. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4634",children:"#4634"})]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})," now exposes ",(0,s.jsx)(r.a,{href:"https://json-schema.org/",children:"JSON Schema"})," via the ",(0,s.jsx)(r.code,{children:"/schemas.json"})," endpoint. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4518",children:"#4518"})]}),"\n"]}),"\n"]}),"\n","\n",(0,s.jsx)(r.h2,{id:"-improvements",children:"\ud83d\udcc8 Improvements"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/Server.html#reconfigure(com.linecorp.armeria.server.ServerConfigurator)",children:"Server#reconfigure(ServerConfigurator)"})," now dynamically updates TLS configurations correctly. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4637",children:"#4637"})]}),"\n",(0,s.jsxs)(r.li,{children:["Thrift ",(0,s.jsx)(r.a,{href:"http://diwakergupta.github.io/thrift-missing-guide/#_typedefs",children:"typedefs"})," are\nnow correctly displayed in ",(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"}),". ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4628",children:"#4628"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})," front-end assets are now compressed using gzip instead of Brotli. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4616",children:"#4616"})]}),"\n",(0,s.jsxs)(r.li,{children:["An exception is raised if TLS is set for a port-based virtual host. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4588",children:"#4588"})]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"\ufe0f-bug-fixes",children:"\ud83d\udee0\ufe0f Bug fixes"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["A ",(0,s.jsx)(r.code,{children:"NullPointerException"})," is not raised anymore when an aborted ",(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/stream/StreamMessage.html",children:"StreamMessage"})," is collected. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4652",children:"#4652"})]}),"\n",(0,s.jsxs)(r.li,{children:["A ",(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/ClosedSessionException.html",children:"ClosedSessionException"})," is not set to ",(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RequestLog.html#responseCause()",children:"RequestLog#responseCause()"})," anymore when\nan HTTP/1 connection is closed after response data has been fully sent. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4632",children:"#4632"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"https://cloud.google.com/endpoints/docs/grpc/transcoding",children:"gRPC HTTP/JSON transcoding"})," now doesn't throw an exception when used with nested messages. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4631",children:"#4631"})," ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4641",children:"#4641"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"431 Request Header Fields Too Large"})," is now returned instead of ",(0,s.jsx)(r.code,{children:"400 Bad Request"})," if the header size exceeds ",(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/ServerConfig.html#http1MaxHeaderSize()",children:"ServerConfig#http1MaxHeaderSize()"}),". ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4609",children:"#4609"})," ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4655",children:"#4655"})]}),"\n",(0,s.jsxs)(r.li,{children:["Warnings on duplicate parameters in ",(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})," are no longer visible when annotations are added to Kotlin data classes. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4645",children:"#4645"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"https://cloud.google.com/endpoints/docs/grpc/transcoding",children:"gRPC HTTP/JSON transcoding"})," now correctly interprets ",(0,s.jsx)(r.code,{children:"google.protobuf.FieldMask"})," type as a string. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4633",children:"#4633"})," ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4640",children:"#4640"})]}),"\n",(0,s.jsxs)(r.li,{children:["gRPC metadata is now exposed via ",(0,s.jsx)(r.a,{href:"type://#",children:"StatusRuntimeException"})," in ",(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RequestLog.html#responseCause()",children:"RequestLog#responseCause()"}),". ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4635",children:"#4635"})," ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4636",children:"#4636"})]}),"\n",(0,s.jsxs)(r.li,{children:['Square brackets "',(0,s.jsx)(r.code,{children:"[]"}),'" that are specified in path segments are correctly encoded. ',(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4607",children:"#4607"})," ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4615",children:"#4615"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/encoding/DecodingService.html",children:"DecodingService"})," and ",(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/encoding/DecodingClient.html",children:"DecodingClient"})," now correctly limit the max length of decompressed streaming data. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4613",children:"#4613"})]}),"\n",(0,s.jsxs)(r.li,{children:["Client-side gRPC callback ",(0,s.jsx)(r.code,{children:"ClientCall.Listener.onHeaders()"})," is now invoked correctly. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4583",children:"#4583"})," ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4608",children:"#4608"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})," now correctly displays multiple example requests for a single endpoint. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4576",children:"#4576"})," ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4605",children:"#4605"})]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"\ufe0f-deprecations",children:"\ud83c\udfda\ufe0f Deprecations"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"ArmeriaSettings.ports.ip"})," is deprecated in favor of ",(0,s.jsx)(r.code,{children:"ArmeriaSettings.ports.address"}),". ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4597",children:"#4597"})," ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4598",children:"#4598"})]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"\ufe0f-breaking-changes",children:"\u2622\ufe0f Breaking changes"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Armeria's gRPC services now try to throw a ",(0,s.jsx)(r.code,{children:"StatusRuntimeException"})," instead of a ",(0,s.jsx)(r.code,{children:"StatusException"}),". ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4658",children:"#4658"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Note that users are still recommended to perform error handling for both ",(0,s.jsx)(r.code,{children:"StatusRuntimeException"})," and ",(0,s.jsx)(r.code,{children:"StatusException"}),"\nfor gRPC services."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["We are planning on stopping support for integration with Spring Boot 1. Please join the discussion at our\n",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4651",children:"Github issue"})," if you have any opinions. ",(0,s.jsx)(r.a,{href:"https://github.com/line/armeria/issues/4651",children:"#4651"})]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"-dependencies",children:"\u26d3 Dependencies"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Brave 5.14.1 \u2192 5.15.0"}),"\n",(0,s.jsx)(r.li,{children:"Dropwizard-metrics 4.2.13 \u2192 4.2.15"}),"\n",(0,s.jsx)(r.li,{children:"GraphQL Kotlin 6.3.2 \u2192 6.3.5"}),"\n",(0,s.jsx)(r.li,{children:"gRPC Java 1.49.1 \u2192 1.52.1"}),"\n",(0,s.jsx)(r.li,{children:"Hibernate Validator 6.2.3.Final \u2192 6.2.5.Final"}),"\n",(0,s.jsx)(r.li,{children:"Jackson 2.14.1 \u2192 2.14.2"}),"\n",(0,s.jsx)(r.li,{children:"java-jwt 4.2.1 \u2192 4.2.2"}),"\n",(0,s.jsx)(r.li,{children:"Kafka client 3.3.1 \u2192 3.4.0"}),"\n",(0,s.jsx)(r.li,{children:"Kotlin 1.7.22 \u2192 1.8.10"}),"\n",(0,s.jsx)(r.li,{children:"Micrometer 1.10.2 \u2192 1.10.3"}),"\n",(0,s.jsx)(r.li,{children:"Netty 4.1.86.Final \u2192 4.1.87.Final"}),"\n",(0,s.jsx)(r.li,{children:"io_uring 0.0.16.Final \u2192 0.0.17.Final"}),"\n",(0,s.jsx)(r.li,{children:"Protobuf 3.21.1 \u2192 3.21.7"}),"\n",(0,s.jsx)(r.li,{children:"Resteasy 5.0.4.Final \u2192 5.0.5.Final"}),"\n",(0,s.jsx)(r.li,{children:"RxJava3 3.1.5 \u2192 3.1.6"}),"\n",(0,s.jsx)(r.li,{children:"Sangria 3.4.1 \u2192 3.5.0"}),"\n",(0,s.jsx)(r.li,{children:"Scala3 3.2.0 \u2192 3.2.2"}),"\n",(0,s.jsx)(r.li,{children:"ScalaPB 0.11.12 \u2192 0.11.13"}),"\n",(0,s.jsx)(r.li,{children:"ScalaPB JSON 0.12.0 \u2192 0.12.1"}),"\n",(0,s.jsx)(r.li,{children:"Spring 5.3.23 \u2192 5.3.25"}),"\n",(0,s.jsx)(r.li,{children:"Spring Boot 2.7.4 \u2192 2.7.8"}),"\n",(0,s.jsx)(r.li,{children:"Tomcat8 8.5.84 \u2192 8.5.85"}),"\n",(0,s.jsx)(r.li,{children:"Tomcat9 9.0.70 \u2192 9.0.71"}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"-thank-you",children:"\ud83d\ude47 Thank you"}),"\n",(0,s.jsx)(i,{usernames:["cormoran","daniel-itunu","Dogacel","heesuk-ahn","hyperxpro","ikhoon","jrhee17","kezhenxu94","kojilin","minwoox","mscheong01","rhodo","sullis","ta7uw","tomatophobia","trustin"]})]})}function d(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);