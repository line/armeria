"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[2820],{28453:(e,r,n)=>{n.d(r,{R:()=>s,x:()=>o});var i=n(96540);const t={},a=i.createContext(t);function s(e){const r=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(a.Provider,{value:r},e.children)}},35653:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"0.99.6","title":"v0.99.6","description":"\ud83c\udf1f New features","source":"@site/src/content/release-notes/0.99.6.mdx","sourceDirName":".","slug":"/0.99.6","permalink":"/release-notes/0.99.6","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site/src/content/release-notes/0.99.6.mdx","tags":[],"version":"current","frontMatter":{"date":"2020-05-28T00:00:00.000Z"},"sidebar":"defaultSidebar","previous":{"title":"v0.99.7","permalink":"/release-notes/0.99.7"},"next":{"title":"v0.99.5","permalink":"/release-notes/0.99.5"}}');var t=n(74848),a=n(28453);const s={date:new Date("2020-05-28T00:00:00.000Z")},o="v0.99.6",c={},l=[{value:"\ud83c\udf1f New features",id:"-new-features",level:2},{value:"\ud83d\udcc8 Improvements",id:"-improvements",level:2},{value:"\ud83d\udee0\ufe0f Bug fixes",id:"\ufe0f-bug-fixes",level:2},{value:"\u2622\ufe0f Breaking changes",id:"\ufe0f-breaking-changes",level:2},{value:"\u26d3 Dependencies",id:"-dependencies",level:2},{value:"\ud83d\ude47 Thank you",id:"-thank-you",level:2}];function h(e){const r={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components},{ThankYou:n}=r;return n||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ThankYou",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.header,{children:[(0,t.jsx)(r.h1,{id:"v0996",children:"v0.99.6"}),(0,t.jsx)(r.p,{children:(0,t.jsx)(r.em,{children:"May 28, 2020"})})]}),"\n",(0,t.jsx)(r.h2,{id:"-new-features",children:"\ud83c\udf1f New features"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsxs)(r.p,{children:["New ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/circuitbreaker/CircuitBreakerRule.html",children:"CircuitBreakerRule"})," and ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/circuitbreaker/CircuitBreakerRuleWithContent.html",children:"CircuitBreakerRuleWithContent"})," API let you define a complex\ncircuit breaking policy conveniently. ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2726",children:"#2726"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:"CircuitBreakerRule myRule =\n    CircuitBreakerRule.of(\n        // A failure if an Exception is raised.\n        CircuitBreakerRule.onException(),\n        // Neither a success nor a failure because\n        // the request has not been handled by the server.\n        CircuitBreakerRule.builder()\n                          .onUnprocessed()\n                          .thenIgnore(),\n        // A failure if the response is 5xx.\n        CircuitBreakerRule.onServerErrorStatus(),\n        // A success if the response is 2xx.\n        CircuitBreakerRule.builder()\n                          .onStatusClass(HttpStatusClass.SUCCESS)\n                          .thenSuccess(),\n        // Neither a success nor a failure. Do not take this response into account.\n        CircuitBreakerRule.builder().thenIgnore());\n"})}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsxs)(r.p,{children:["You can now easily bind an MDC property to a ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/RequestContext.html",children:"RequestContext"})," and log it using a logging framework.\n",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2634",children:"#2634"})," ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2724",children:"#2724"})," ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2729",children:"#2729"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'MDC.put("transactionId", "1234");\nWebClient client = ...;\ntry (SafeCloseable ignored = Clients.withContextCustomizer(ctx -> {\n    RequestScopedMdc.copy(ctx, "transactionId");\n}) {\n    assert MDC.get("transactionId").equals("1234");\n\n    client.execute(...);\n}\n'})}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsxs)(r.p,{children:["You can now install a custom hook to ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/RequestContextStorage.html",children:"RequestContextStorage"})," in runtime, usually at startup time. ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2723",children:"#2723"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'RequestContextStorage.hook(delegate -> new RequestContextStorageWrapper(delegate) {\n    @Nullable\n    @Override\n    public <T extends RequestContext> T push(RequestContext toPush) {\n        // Usually, you can just use RequestScopedMdc for this purpose.\n        MDC.put("foo", toPush.attr(FOO));\n        return super.push(toPush);\n    }\n\n    @Override\n    public void pop(RequestContext current, @Nullable RequestContext toRestore) {\n        MDC.remove("foo");\n        super.pop(current, toRestore);\n    }\n\n    ...\n}\n'})}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsxs)(r.p,{children:["You can now set method parameter descriptions for annotated services in\n",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})," using Javadoc. ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2697",children:"#2697"})]}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsxs)(r.p,{children:["You can now easily sanitize headers and content using ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RegexBasedSanitizer.html",children:"RegexBasedSanitizer"}),". ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/1810",children:"#1810"})," ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2721",children:"#2721"})]}),"\n"]}),"\n"]}),"\n","\n",(0,t.jsx)(r.h2,{id:"-improvements",children:"\ud83d\udcc8 Improvements"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["You can now easily call ",(0,t.jsx)(r.code,{children:"ownAttr()"})," from ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/RequestContext.html",children:"RequestContext"}),". ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2727",children:"#2727"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["You don't have to check if the context is ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/ClientRequestContext.html",children:"ClientRequestContext"})," or not anymore."]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"root()"})," and ",(0,t.jsx)(r.code,{children:"ownAttrs()"})," are pulled up as well."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"\ufe0f-bug-fixes",children:"\ud83d\udee0\ufe0f Bug fixes"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["You can now use Armeria 0.99.6 with Micrometer 1.3.9.\n(It is recommended to use Micrometer 1.5.1, though.) ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2742",children:"#2742"})]}),"\n",(0,t.jsxs)(r.li,{children:["You can now retry even when the current ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/endpoint/EndpointGroup.html",children:"EndpointGroup"})," is empty. ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2736",children:"#2736"})]}),"\n",(0,t.jsxs)(r.li,{children:["You can send a request by setting the authority and scheme header to ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/RequestHeaders.html",children:"RequestHeaders"}),". ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2730",children:"#2730"})," ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2734",children:"#2734"})]}),"\n",(0,t.jsxs)(r.li,{children:["You no longer see ",(0,t.jsx)(r.code,{children:"&lt;zero-length response&gt;"})," in ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/docs/DocService.html",children:"DocService"})," anymore. ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2732",children:"#2732"})]}),"\n",(0,t.jsxs)(r.li,{children:["A ",(0,t.jsx)(r.code,{children:"NullPointerException"})," is not raised anymore due to the dependency order when Armeria is shaded.\n",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2731",children:"#2731"})," ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2735",children:"#2735"})]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"\ufe0f-breaking-changes",children:"\u2622\ufe0f Breaking changes"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"RetryStrategy"})," and ",(0,t.jsx)(r.code,{children:"RetryStrategyWithContent"})," are gone in favor of\n",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/retry/RetryRule.html",children:"RetryRule"})," and ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/retry/RetryRuleWithContent.html",children:"RetryRuleWithContent"}),". ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2726",children:"#2726"})]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"CircuitBreakerStrategy"})," and ",(0,t.jsx)(r.code,{children:"CircuitBreakerStrategyWithContent"})," are gone in favor of\n",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/circuitbreaker/CircuitBreakerRule.html",children:"CircuitBreakerRule"})," and ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/circuitbreaker/CircuitBreakerRuleWithContent.html",children:"CircuitBreakerRuleWithContent"}),". ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2726",children:"#2726"})]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"EndpointSelector.select()"})," (and thus EndpointGroup.select() as well) now returns ",(0,t.jsx)(r.code,{children:"null"}),"\ninstead of throwing an ",(0,t.jsx)(r.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/endpoint/EmptyEndpointGroupException.html",children:"EmptyEndpointGroupException"}),". ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2736",children:"#2736"})]}),"\n",(0,t.jsxs)(r.li,{children:["The method signature of ",(0,t.jsx)(r.code,{children:"ClientFactory.acquireEventLoop()"})," and ",(0,t.jsx)(r.code,{children:"EventLoopScheduler.acquire()"}),"\nhave been changed. ",(0,t.jsx)(r.a,{href:"https://github.com/line/armeria/issues/2736",children:"#2736"})]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"-dependencies",children:"\u26d3 Dependencies"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Brave 5.11.2 \u2192 5.12.3"}),"\n",(0,t.jsx)(r.li,{children:"grpc-kotlin-stub 0.1.1 \u2192 0.1.2"}),"\n",(0,t.jsx)(r.li,{children:"io.dropwizard.metrics 4.1.7 \u2192 4.1.9"}),"\n",(0,t.jsx)(r.li,{children:"Jetty 9.4.28.v20200408 \u2192 9.4.29.v20200521"}),"\n",(0,t.jsx)(r.li,{children:"reactor-grpc 1.0.0 \u2192 1.0.1"}),"\n",(0,t.jsx)(r.li,{children:"Retrofit 2.8.1 \u2192 2.9.0"}),"\n",(0,t.jsx)(r.li,{children:"Rxjava3 3.0.3 \u2192 3.0.4"}),"\n",(0,t.jsxs)(r.li,{children:["Shaded dependencies","\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Caffeine 2.8.2 \u2192 2.8.4"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["Example dependencies","\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Kotlin 1.3.71 \u2192 1.3.72"}),"\n",(0,t.jsx)(r.li,{children:"Kotlin Coroutines 1.3.6 \u2192 1.3.7"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"-thank-you",children:"\ud83d\ude47 Thank you"}),"\n",(0,t.jsx)(n,{usernames:["amitvc","andrey-tpt","anuraaga","codefromthecrypt","hueneburg","ikhoon","imasahiro","jrhee17","KarboniteKream","matsumana","minwoox","okue","trustin"]})]})}function d(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);