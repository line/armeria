"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[4880],{17282:(e,r,i)=>{i.d(r,{A:()=>n});const n=i.p+"assets/images/applying-circuitbreaker-to-channel-gateway-1-537a3aa178c1835906c7a42d541dac55.png"},24542:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>l,metadata:()=>n,toc:()=>a});var n=i(75614),t=i(74848),c=i(28453);const l={authors:["shinjonghun"],other_languages:{en:"/blog/2016/08/04/applying-circuitbreaker-to-channel-gateway",ko:"/blog/ko/2016/08/04/applying-circuitbreaker-to-channel-gateway"}},s="\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3078\u306eCircuitBreaker\u306e\u9069\u7528",d={authorsImageUrls:[void 0]},a=[{value:"\u306f\u3058\u3081\u306b",id:"\u306f\u3058\u3081\u306b",level:2},{value:"\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306bCircuitBreaker\u3092\u9069\u7528\u3059\u308b",id:"\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306bcircuitbreaker\u3092\u9069\u7528\u3059\u308b",level:2},{value:"CircuitBreaker\u306e\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306e\u4f7f\u7528",id:"circuitbreaker\u306e\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306e\u4f7f\u7528",level:2},{value:"CircuitBreaker\u306b\u304a\u3051\u308bproceed()\u306e\u5b9f\u88c5",id:"circuitbreaker\u306b\u304a\u3051\u308bproceed\u306e\u5b9f\u88c5",level:2},{value:"CircuitBreaker\u306e\u8a2d\u5b9a\u5909\u66f4\u30e1\u30bd\u30c3\u30c9",id:"circuitbreaker\u306e\u8a2d\u5b9a\u5909\u66f4\u30e1\u30bd\u30c3\u30c9",level:2},{value:"\u307e\u3068\u3081",id:"\u307e\u3068\u3081",level:2},{value:"\u4f5c\u6210\u8005\u306e\u7d39\u4ecb",id:"\u4f5c\u6210\u8005\u306e\u7d39\u4ecb",level:2}];function o(e){const r={a:"a",code:"code",em:"em",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.h2,{id:"\u306f\u3058\u3081\u306b",children:"\u306f\u3058\u3081\u306b"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.a,{href:"/blog/ja/2016/07/14/circuit-breakers-for-distributed-services",children:"Circuit Breaker\u306e\u7d39\u4ecb\u8a18\u4e8b"}),"\u3092\u5148\u306b\u8aad\u3080\u3053\u3068\u3092\u63a8\u5968\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.h2,{id:"\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306bcircuitbreaker\u3092\u9069\u7528\u3059\u308b",children:"\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306bCircuitBreaker\u3092\u9069\u7528\u3059\u308b"}),"\n",(0,t.jsx)(r.p,{children:"\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u30b5\u30fc\u30d0\u306f\u3001LINE\u306e\u591a\u69d8\u306a\u30b5\u30fc\u30d0\u306e\u6a5f\u80fd\u3092CP(Contents Provider)\u306b\u63d0\u4f9b\u3059\u308b\u5f79\u5272\u3092\u62c5\u3063\u3066\u3044\u307e\u3059\u3002\u305d\u306e\u305f\u3081\u3001\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u30b5\u30fc\u30d0\u306f\u63a5\u7d9a\u3055\u308c\u3066\u3044\u308b\u30b5\u30fc\u30d0\u306b\u5927\u304d\u304f\u5f71\u97ff\u3055\u308c\u307e\u3059\u3002\u306a\u304a\u3001\u305d\u3046\u3057\u305f\u5f71\u97ff\u306f\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u30b5\u30fc\u30d0\u5168\u4f53\u306b\u5bb9\u6613\u306b\u62e1\u6563\u3057\u307e\u3059\u3002"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:i(17282).A+"",width:"870",height:"328"})}),"\n","\n",(0,t.jsx)(r.p,{children:"\u3053\u306e\u554f\u984c\u306e\u89e3\u6c7a\u306b\u60a9\u3093\u3067\u3044\u305f\u3068\u3053\u308d\u3001CircuitBreaker\u306b\u95a2\u3059\u308b\u5185\u5bb9\u3092\u805e\u304d\u307e\u3057\u305f\u3002\u7279\u5b9a\u306e\u30b5\u30fc\u30d0\u306b\u969c\u5bb3\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u3001CircuitBreaker\u304c\u305d\u308c\u3092\u691c\u77e5\u3057\u3066\u305d\u306e\u30b5\u30fc\u30d0\u306b\u6295\u3052\u3089\u308c\u308b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u906e\u65ad\u3059\u308c\u3070\u3001\u554f\u984c\u3092\u5341\u5206\u89e3\u6c7a\u3067\u304d\u308b\u3068\u601d\u3044\u307e\u3057\u305f\u3002\u305d\u306e\u305f\u3081\u3001\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306bCircuitBreaker\u3092\u9069\u7528\u3059\u308b\u3053\u3068\u3092\u6c7a\u3081\u307e\u3057\u305f\u3002"}),"\n",(0,t.jsxs)(r.p,{children:["\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u7528\u306eCircuitBreaker\u3092\u76f4\u63a5\u5b9f\u88c5\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3057\u305f\u304c\u3001",(0,t.jsx)(r.a,{href:"http://line.github.io/armeria/",children:"Armeria"}),"\u306b\u3059\u3067\u306b\u898b\u4e8b\u306aCircuit Breaker\u304c\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002Armeria\u306eCircuitBreaker\u306f\u3001\u69d8\u3005\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u30cb\u30fc\u30ba\u306b\u5408\u308f\u305b\u3066\u8a2d\u5b9a\u3057\u3001",(0,t.jsx)(r.code,{children:"CircuitBreakerBuilder"}),"\u3067\u5b9f\u88c5\u3055\u308c\u305fCircuitBreaker\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u3088\u3063\u3066\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306b\u5408\u308f\u305b\u3066\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u7c21\u5358\u306b\u9069\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002"]}),"\n",(0,t.jsx)(r.h2,{id:"circuitbreaker\u306e\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306e\u4f7f\u7528",children:"CircuitBreaker\u306e\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306e\u4f7f\u7528"}),"\n",(0,t.jsxs)(r.p,{children:["talk-channel-gateway\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u304a\u3044\u3066CircuitBreaker\u306f\u3001",(0,t.jsx)(r.code,{children:"@CircuitBreakable"}),"\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u4f7f\u7528\u3057\u3066\u9069\u7528\u3067\u304d\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"@CircuitBreakable(CircuitBreakerGroup.HBASE_CLIENT_USER_SETTINGS)\npublic ChannelSettings findBy(String mid) {\n    ...\n}\n"})}),"\n",(0,t.jsxs)(r.p,{children:["\u4e0a\u8a18\u306e\u3088\u3046\u306b\u9069\u7528\u3057\u305f\u5834\u5408\u3001",(0,t.jsx)(r.code,{children:"findBy()"}),"\u30e1\u30bd\u30c3\u30c9\u304c\u547c\u3073\u51fa\u3055\u308c\u308b\u5ea6\u306b\u6210\u529f/\u5931\u6557\u3092\u76e3\u8996\u3057\u3001\u305d\u306e\u7d50\u679c\u306b\u3088\u3063\u3066CircuitBreaker\u304c\u958b\u9589\u3057\u307e\u3059\u3002HBASE_CLIENT_USER_SETTINGS\u306fCircuitBreaker\u3067\u675f\u306d\u308b\u30b0\u30eb\u30fc\u30d7\u3092\u6307\u5b9a\u3059\u308b\u3082\u306e\u3067\u3001\u5404\u30e1\u30bd\u30c3\u30c9\u306e\u5931\u6557\u7387\u3092\u8a08\u7b97\u3059\u308b\u969b\u3082\u30b0\u30eb\u30fc\u30d7\u5168\u4f53\u306e\u547c\u3073\u51fa\u3057\u56de\u6570\u306b\u5bfe\u3059\u308b\u5931\u6557\u56de\u6570\u3067\u8a08\u7b97\u3057\u3001CircuitBreaker\u306e\u958b\u9589\u6642\u3082\u4e00\u7dd2\u306b\u958b\u9589\u3057\u307e\u3059\u3002"]}),"\n",(0,t.jsxs)(r.p,{children:["CircuitBreaker\u306e\u8a2d\u5b9a\u306f\u3001",(0,t.jsx)(r.code,{children:"CircuitBreakerGroup"}),"\u3068\u3044\u3046enum\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u6b21\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"public enum CircuitBreakerGroup implements ExceptionFilter {\n    SAMPLE_DEFAULT {\n    },\n    SAMPLE_API {\n        @Override\n        protected ExceptionFilter exceptionFilter() {\n            return cause -> !(cause instanceof AuthenticationException\n                              || cause instanceof ApiPermissionException\n                              || cause instanceof ImproperRequestException);\n        }\n    },\n    HBASE_CLIENT_CHANNEL_MATRIX {\n    },\n    HBASE_CLIENT_USER_SETTINGS {\n    };\n\n    protected ExceptionFilter exceptionFilter() {\n        return cause -> true;\n    }\n\n    public CircuitBreaker circuitBreaker(CircuitBreakerListener listener) {\n        return new `CircuitBreakerBuilder`(name()).exceptionFilter(exceptionFilter())\n                                                .listener(listener)\n                                                .build();\n    }\n\n    @Override\n    public boolean shouldDealWith(Throwable throwable) throws Exception {\n        return exceptionFilter().shouldDealWith(throwable);\n    }\n}\n"})}),"\n",(0,t.jsxs)(r.p,{children:["\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3067\u306f",(0,t.jsx)(r.code,{children:"ExceptionFilter"}),"\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u3066\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\u305d\u308c\u4ee5\u5916\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u3001Armeria\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u305d\u306e\u307e\u307e\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\u3082\u3057\u3001\u4ed6\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u5909\u66f4\u3057\u3066\u4f7f\u3044\u305f\u3044\u5834\u5408\u306f\u3001",(0,t.jsx)(r.code,{children:"circuitBreaker()"}),"\u30e1\u30bd\u30c3\u30c9\u3092\u4fee\u6b63\u3057\u3066\u4f7f\u7528\u3067\u304d\u308b\u3067\u3057\u3087\u3046\u3002"]}),"\n",(0,t.jsxs)(r.p,{children:["Armeria\u3067\u306f\u3001\u3069\u3093\u306a\u3082\u306e\u3067\u3042\u3063\u3066\u3082Exception\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306f\u57fa\u672c\u7684\u306b\u5931\u6557\u3068\u307f\u306a\u3059\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3067\u306f\u3001\u6a29\u9650\u304c\u306a\u3044\u5834\u5408\u306a\u3069\u3092Exception\u3068\u3057\u3066\u51e6\u7406\u3057\u3066\u8fd4\u3059\u306e\u3067\u3001\u305d\u308c\u3092\u533a\u5206\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u305d\u306e\u305f\u3081\u3001",(0,t.jsx)(r.code,{children:"ExceptionFilter"}),"\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u3066\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\u305d\u3057\u3066\u3001CircuitBreaker\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u304c\u5909\u308f\u308b\u5ea6\u306b\u30ed\u30b0\u3092\u84c4\u7a4d\u3067\u304d\u308b\u3088\u3046\u306b\u3001\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306e\u305f\u3081\u306eListener\u3082\u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002"]}),"\n",(0,t.jsx)(r.p,{children:"\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u9069\u7528\u3059\u308b\u30b0\u30eb\u30fc\u30d7\u306fenum\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u6307\u5b9a\u3067\u304d\u3001enum\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5b9f\u88c5\u90e8\u306b\u304a\u3044\u3066\u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306b\u8a2d\u5b9a\u3092\u5909\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002"}),"\n",(0,t.jsx)(r.h2,{id:"circuitbreaker\u306b\u304a\u3051\u308bproceed\u306e\u5b9f\u88c5",children:"CircuitBreaker\u306b\u304a\u3051\u308bproceed()\u306e\u5b9f\u88c5"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.a,{href:"https://en.wikipedia.org/wiki/AspectJ",children:"Aspect"})," \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e",(0,t.jsx)(r.code,{children:"proceed()"}),"\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"public class CircuitBreakerAspect implements Ordered {\n\n    private final Map&lt;CircuitBreakerGroup, CircuitBreaker>\n    circuitBreakers = new EnumMap&lt;>(CircuitBreakerGroup.class);\n\n    @PostConstruct\n    public void initialize() {\n\n        final CircuitBreakerListener listener = new\n        CircuitBreakerListenerImpl(circuitBreakerLogger);\n        for (CircuitBreakerGroup group : CircuitBreakerGroup.values()) {\n            circuitBreakers.put(group, group.circuitBreaker(listener));\n        }\n    }\n\n    public Object proceed(final ProceedingJoinPoint pjp, final CircuitBreakable\n    circuitBreakable) throws Throwable {\n\n        final CircuitBreakerGroup group = circuitBreakable.value();\n        final CircuitBreaker circuitBreaker = circuitBreakers.get(group);\n\n        if (circuitBreaker.canRequest()) {\n            final Object result;\n\n            try {\n                result = pjp.proceed();\n            } catch (Throwable e) {\n                if (group.shouldDealWith(e)) {\n                    circuitBreaker.onFailure(e);\n                } else {\n                    circuitBreaker.onSuccess();\n                }\n                throw e;\n            }\n\n            circuitBreaker.onSuccess();\n            return result;\n        } else {\n            throw CircuitBreakerException.circuitBroken();\n        }\n    }\n}\n"})}),"\n",(0,t.jsxs)(r.p,{children:["\u30b3\u30fc\u30c9\u306f\u6bd4\u8f03\u7684\u306b\u7c21\u5358\u3067\u3059\u3002",(0,t.jsx)(r.code,{children:"CircuitBreaker.canRequest()"}),"\u306b\u3088\u3063\u3066CircuitBreaker\u304c\u958b\u653e\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3001Exception\u3092\u767a\u751f\u3055\u305b\u307e\u3059\u3002\u305d\u3046\u3067\u306a\u3044\u5834\u5408\u306f\u3001\u30e1\u30bd\u30c3\u30c9\u3092\u6b63\u5e38\u306b\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\u547c\u3073\u51fa\u3057\u305f\u7d50\u679cException\u304c\u767a\u751f\u3057\u3001\u305d\u306eException\u3092\u5931\u6557\u3068\u3057\u3066\u51e6\u7406\u3059\u3079\u304d\u5834\u5408\u306f\u3001CircuitBreaker\u306b\u5931\u6557\u3057\u305f\u3068\u77e5\u3089\u305b\u307e\u3059\u3002\u305d\u3046\u3067\u306a\u3044\u5834\u5408\u306f\u3001CircuitBreaker\u306b\u6210\u529f\u3057\u305f\u3068\u77e5\u3089\u305b\u308b\u3060\u3051\u3067\u6e08\u307f\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.p,{children:"\u3061\u306a\u307f\u306b\u3001\u5b9f\u969b\u306b\u9069\u7528\u3057\u305f\u30b3\u30fc\u30c9\u306b\u306fCircuitBreaker\u304c\u6b63\u3057\u304f\u9069\u7528\u3055\u308c\u305f\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306bIMON Logger\u203b\u6ce8\u3068\u95a2\u9023\u3059\u308b\u30b3\u30fc\u30c9\u304c\u5165\u3063\u3066\u3044\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u3053\u3053\u3067\u306fCircuitBreaker\u90e8\u5206\u306b\u96c6\u4e2d\u3067\u304d\u308b\u3088\u3046\u306b\u7701\u7565\u3057\u307e\u3057\u305f\u3002"}),"\n",(0,t.jsx)(r.p,{children:"\u203b\u6ce8\uff1aIMON\u306f\u3001\u793e\u5185\u306e\u591a\u69d8\u306a\u30b5\u30fc\u30d3\u30b9\u3092\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3059\u308b\u305f\u3081\u306e\u30b7\u30b9\u30c6\u30e0\u3067\u3059\u3002IMON Logger\u306f\u3001\u5bfe\u8c61\u30b5\u30fc\u30d3\u30b9\u306e\u7d71\u8a08\u6307\u6a19\u3068\u30ed\u30b0\u3092\u53d6\u308a\u307e\u3068\u3081\u3066IMON\u306b\u9001\u308b\u6a5f\u80fd\u3092\u679c\u305f\u3057\u3066\u3044\u307e\u3059\u3002"}),"\n",(0,t.jsx)(r.h2,{id:"circuitbreaker\u306e\u8a2d\u5b9a\u5909\u66f4\u30e1\u30bd\u30c3\u30c9",children:"CircuitBreaker\u306e\u8a2d\u5b9a\u5909\u66f4\u30e1\u30bd\u30c3\u30c9"}),"\n",(0,t.jsxs)(r.p,{children:["CircuitBreaker\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u3063\u3066\u304f\u308c\u308b",(0,t.jsx)(r.code,{children:"CircuitBreakerBuilder"}),"\u306f\u3001CircuitBreaker\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3067\u304d\u308b\u69d8\u3005\u306a\u30e1\u30bd\u30c3\u30c9\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\u306a\u308b\u3079\u304f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u3092\u305d\u306e\u307e\u307e\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u63a8\u5968\u3057\u307e\u3059\u304c\u3001CircuitBreaker\u306e\u8a2d\u5b9a\u306b\u3064\u3044\u3066\u3001\u3082\u3063\u3068\u5206\u304b\u308a\u3084\u3059\u304f\u8aac\u660e\u3057\u3066\u304a\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"]}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Method"}),(0,t.jsx)(r.th,{children:"Parameter"}),(0,t.jsx)(r.th,{children:"Default"}),(0,t.jsx)(r.th,{children:"Description"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"failureRateThreshold"}),(0,t.jsx)(r.td,{children:"double"}),(0,t.jsx)(r.td,{children:"0.8"}),(0,t.jsxs)(r.td,{children:["CircuitBreaker\u306e\u958b\u9589\u3092\u5224\u65ad\u3059\u308b\u969b\u306b\u4f7f\u7528\u3059\u308b\u305f\u3081\u306e\u5931\u6557\u7387\u3067\u3059\u3002",(0,t.jsx)(r.code,{children:"counterSlidingWindow"}),"\u671f\u9593\u4e2d\u306e\u5931\u6557\u7387\u304c\u3053\u306e\u5024\u3092\u4e0a\u56de\u308b\u5834\u5408\u306fCircuitBreaker\u304c\u958b\u653e\u3055\u308c\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u305d\u306e\u307e\u307e\u4f7f\u7528\u3059\u308b\u5834\u5408\u300180%\u4ee5\u4e0a\u5931\u6557\u3059\u308b\u3068CircuitBreaker\u304c\u958b\u653e\u3055\u308c\u307e\u3059\u3002\u3064\u307e\u308a\u3001\u6210\u529f\u7387\u304c20%\u672a\u6e80\u306a\u3089CircuitBreaker\u304c\u958b\u653e\u3055\u308c\u308b\u308f\u3051\u3067\u3059\u3002"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"minimumRequestThreshold"}),(0,t.jsx)(r.td,{children:"long"}),(0,t.jsx)(r.td,{children:"10"}),(0,t.jsxs)(r.td,{children:["CircuitBreaker\u3092\u958b\u9589\u3092\u5224\u65ad\u3059\u308b\u305f\u3081\u306e\u6700\u4f4e\u547c\u3073\u51fa\u3057\u56de\u6570\u3067\u3059\u3002",(0,t.jsx)(r.code,{children:"counterSlidingWindow"}),"\u671f\u9593\u4e2d\u306e\u547c\u3073\u51fa\u3057\u56de\u6570\u304c\u3053\u306e\u5024\u3092\u4e0b\u56de\u308b\u5834\u5408\u306f CircuitBreaker\u306e\u958b\u9589\u3092\u5224\u65ad\u3057\u307e\u305b\u3093\u3002"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"circuitOpenWindow"}),(0,t.jsx)(r.td,{children:"Duration"}),(0,t.jsx)(r.td,{children:"10 seconds"}),(0,t.jsxs)(r.td,{children:["CircuitBreaker\u304cOpen\u72b6\u614b\u306b\u306a\u3063\u3066\u304b\u3089Half-Open\u72b6\u614b\u306b\u5909\u308f\u308b\u307e\u3067\u306e\u6642\u9593\u3067\u3059\u3002CircuitBreaker\u306e\u958b\u653e\u5f8c\u306f\u3001",(0,t.jsx)(r.code,{children:"circuitOpenWindow"}),"\u671f\u9593\u3060\u3051\u306e\u6642\u9593\u304c\u904e\u304e\u3066\u304b\u3089Half-Open\u72b6\u614b\u306b\u5909\u308f\u308a\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"circuitOpenWindowMillis"}),(0,t.jsx)(r.td,{children:"long"}),(0,t.jsx)(r.td,{children:"10000"}),(0,t.jsx)(r.td,{})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"trialRequestInterval"}),(0,t.jsx)(r.td,{children:"Duration"}),(0,t.jsx)(r.td,{children:"3 seconds"}),(0,t.jsxs)(r.td,{children:["Half-Open\u72b6\u614b\u3067\u6295\u3052\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u304cClosed\u5fdc\u7b54\u3092\u8fd4\u3055\u306a\u304b\u3063\u305f\u5834\u5408\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u30ea\u30c8\u30e9\u30a4\u3059\u308b\u305f\u3081\u306e\u5f85\u3061\u6642\u9593\u3067\u3059\u3002",(0,t.jsx)(r.code,{children:"trialRequestInterval"}),"\u6642\u9593\u4ee5\u5185\u306b\u5fdc\u7b54\u304c\u8fd4\u3063\u3066\u304d\u305f\u5834\u5408\u306f\u3001\u305d\u306e\u7d50\u679c\u306b\u3088\u3063\u3066Closed\u307e\u305f\u306fOpen\u72b6\u614b\u306b\u5909\u308f\u308a\u307e\u3059\u3002\u3082\u3057\u3001Open\u72b6\u614b\u306b\u306a\u3063\u305f\u5834\u5408\u306f\u3001\u518d\u5ea6",(0,t.jsx)(r.code,{children:"circuitOpenWindow"}),"\u671f\u9593\u3060\u3051\u5f85\u6a5f\u3057\u3066\u304b\u3089\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u6295\u3052\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u304c",(0,t.jsx)(r.code,{children:"trialRequestInterval"}),"\u671f\u9593\u4e2d\u306b\u4f55\u3082\u5fdc\u7b54\u3082\u8fd4\u3055\u306a\u304b\u3063\u305f\u5834\u5408\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u30ea\u30c8\u30e9\u30a4\u3057\u307e\u3059\u3002"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"trialRequestIntervalMillis"}),(0,t.jsx)(r.td,{children:"long"}),(0,t.jsx)(r.td,{children:"3000"}),(0,t.jsx)(r.td,{})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"counterSlidingWindow"}),(0,t.jsx)(r.td,{children:"Duration"}),(0,t.jsx)(r.td,{children:"20 seconds"}),(0,t.jsxs)(r.td,{children:["CircuitBreaker\u306e\u958b\u9589\u3092\u5224\u65ad\u3059\u308b\u969b\u3001\u6700\u8fd1\u306e",(0,t.jsx)(r.code,{children:"counterSlidingWindow"}),"\u671f\u9593\u5206\u306e\u8a18\u9332\u3092\u3082\u3063\u3066\u5224\u65ad\u3057\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u305d\u306e\u307e\u307e\u4f7f\u7528\u3059\u308c\u3070\u3001\u3053\u305320\u79d2\u9593\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u7d50\u679c\u3060\u3051\u3067\u5224\u65ad\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"counterSlidingWindowMillis"}),(0,t.jsx)(r.td,{children:"long"}),(0,t.jsx)(r.td,{children:"20000"}),(0,t.jsx)(r.td,{})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"counterUpdateInterval"}),(0,t.jsx)(r.td,{children:"Duration"}),(0,t.jsx)(r.td,{children:"1 second"}),(0,t.jsxs)(r.td,{children:["CircuitBreaker\u3067\u306f\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u7d50\u679c\u3092",(0,t.jsx)(r.code,{children:"SlidingWindowCounter"}),"\u306b\u3088\u3063\u3066\u4fdd\u7ba1\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u4fdd\u7ba1\u3059\u308b\u5358\u4f4d\u3068\u306a\u308b\u6642\u9593\u3092\u610f\u5473\u3057\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u305d\u306e\u307e\u307e\u4f7f\u7528\u3059\u308b\u3068\u30011\u79d2\u5358\u4f4d\u3067\u8a18\u9332\u3092\u4fdd\u6301\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\u3053\u305320\u79d2\u524d=\u6210\u529f20\u56de\u3001\u5931\u65570\u56de / \u3053\u305319\u79d2\u524d=\u6210\u529f25\u56de\u3001\u5931\u65571\u56de / \u2026 / \u3053\u30531\u79d2\u524d=\u6210\u529f21\u56de\u3001\u5931\u65570\u56de\u306a\u3069\u306e\u8a18\u9332\u3092\u4fdd\u6301\u3057\u307e\u3059\u3002\u3053\u306e1\u79d2\u5358\u4f4d\u306e\u8a18\u9332\u3067",(0,t.jsx)(r.code,{children:"counterSlidingWindow"}),"\u671f\u9593\u5206\u3092\u8a08\u7b97\u3057\u3001\u5931\u6557\u7387\u3092\u51fa\u3057\u307e\u3059\u3002"]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"counterUpdateIntervalMillis"}),(0,t.jsx)(r.td,{children:"long"}),(0,t.jsx)(r.td,{children:"1000"}),(0,t.jsx)(r.td,{})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"exceptionFilter"}),(0,t.jsx)(r.td,{children:"ExceptionFilter"}),(0,t.jsx)(r.td,{children:"\u3059\u3079\u3066\u306eException\u3092\u5931\u6557\u3068\u3057\u3066\u307f\u306a\u3059"}),(0,t.jsx)(r.td,{children:"Exception\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u3001\u305d\u306eException\u3092\u5931\u6557\u3068\u3057\u3066\u307f\u306a\u3059\u304b\u3069\u3046\u304b\u3092\u8fd4\u3059\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u305d\u306e\u307e\u307e\u4f7f\u7528\u3059\u308c\u3070\u3001\u3059\u3079\u3066\u306eException\u3092\u5931\u6557\u3068\u307f\u306a\u3057\u307e\u3059\u3002"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"listener"}),(0,t.jsx)(r.td,{children:"CircuitBreakerListener"}),(0,t.jsx)(r.td,{}),(0,t.jsxs)(r.td,{children:["CircuitBreaker\u306eState\u304c\u5909\u308f\u3063\u305f\u5834\u5408\u3001",(0,t.jsx)(r.code,{children:"counterUpdateInterval"}),"\u306e\u6642\u9593\u304c\u904e\u304e\u305f\u5834\u5408\u3001CircuitBreaker\u304c\u958b\u653e\u3055\u308c\u3066\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u30ea\u30b8\u30a7\u30af\u30c8\u3055\u308c\u305f\u5834\u5408\u306b\u5bfe\u3059\u308b\u30a4\u30d9\u30f3\u30c8\u3092\u53d7\u4fe1\u3067\u304d\u308bListener\u3067\u3059\u3002"]})]})]})]}),"\n",(0,t.jsx)(r.h2,{id:"\u307e\u3068\u3081",children:"\u307e\u3068\u3081"}),"\n",(0,t.jsx)(r.p,{children:"\u3053\u308c\u307e\u3067\u306f\u3001\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306e\u4e00\u90e8\u3067\u969c\u5bb3\u304c\u767a\u751f\u3059\u308b\u3068\u3001\u5bfe\u5fdc\u3059\u308b\u524d\u306b\u3059\u3067\u306b\u5927\u304d\u306a\u88ab\u5bb3\u304c\u51fa\u3066\u3044\u307e\u3057\u305f\u3002\u4e00\u90e8\u3067\u767a\u751f\u3057\u305f\u969c\u5bb3\u304cThread Full\u73fe\u8c61\u3092\u307e\u306d\u304d\u3001\u7d50\u5c40\u306f\u30b5\u30fc\u30d3\u30b9\u5168\u4f53\u306b\u5f71\u97ff\u3092\u4e0e\u3048\u305f\u305f\u3081\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u3053\u308c\u304b\u3089\u306fCircuitBreaker\u304c\u305d\u306e\u3088\u3046\u306a\u90e8\u5206\u3092\u906e\u65ad\u3057\u3066\u304f\u308c\u308b\u306e\u3067\u3001\u3088\u308a\u4f59\u88d5\u3092\u6301\u3063\u3066\u5bfe\u5fdc\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u3002"}),"\n",(0,t.jsx)(r.p,{children:"\u6700\u5f8c\u306b\u3001\u4e0a\u8ff0\u306e\u8a2d\u5b9a\u3092\u5229\u7528\u3057\u3066CircuitBreaker\u306e\u52d5\u4f5c\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["CircuitBreaker\u306e\u521d\u671f\u72b6\u614b\u306f",(0,t.jsx)(r.em,{children:"Closed"}),"\u3067\u3059\u3002"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.em,{children:"Closed"})," : \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9042\u884c\u3057\u305f\u5f8c\u3001",(0,t.jsx)(r.code,{children:"ExceptionFilter"}),"\u306b\u3088\u3063\u3066\u6b21\u306e\u3088\u3046\u306b\u52d5\u4f5c\u3057\u307e\u3059\u3002","\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["\u7d50\u679c\u304c\u6210\u529f\u306a\u3089\u3001\u6210\u529f\u3057\u305f\u3068\u3044\u3046\u8a18\u9332\u3092\u6b8b\u3057\u3001",(0,t.jsx)(r.em,{children:"Closed"}),"\u72b6\u614b\u306b\u5909\u308f\u308a\u307e\u3059\u3002"]}),"\n",(0,t.jsxs)(r.li,{children:["\u7d50\u679c\u304c\u5931\u6557\u306a\u3089\u3001",(0,t.jsx)(r.code,{children:"counterSlidingWindow"}),"\u671f\u9593\u5206\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u7d50\u679c\u3092\u78ba\u8a8d\u3057\u3066","\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["minimumRequestThreshold\u6570\u3088\u308a\u591a\u304f\u3001\u5931\u6557\u7387\u304cfailureRateThreshold\u4ee5\u4e0a\u3067\u3042\u308c\u3070\u3001",(0,t.jsx)(r.em,{children:"Open"}),"\u72b6\u614b\u306b\u5909\u308f\u308a\u307e\u3059\u3002"]}),"\n",(0,t.jsx)(r.li,{children:"\u305d\u3046\u3067\u306a\u3044\u5834\u5408\u306f\u3001Closed\u72b6\u614b\u304c\u7dad\u6301\u3055\u308c\u307e\u3059\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.em,{children:"Open"})," : ",(0,t.jsx)(r.code,{children:"circuitOpenWindow"}),"\u671f\u9593\u304c\u904e\u304e\u308c\u3070\u3001",(0,t.jsx)(r.em,{children:"Half-Open"}),"\u72b6\u614b\u306b\u5909\u308f\u308a\u307e\u3059\u3002"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.em,{children:"Half-Open"})," : \u6700\u521d\u306b\u5165\u3063\u3066\u304f\u308b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9042\u884c\u3057\u305f\u5f8c\u3001",(0,t.jsx)(r.code,{children:"ExceptionFilter"}),"\u306b\u3088\u3063\u3066\u6b21\u306e\u3088\u3046\u306b\u52d5\u4f5c\u3057\u307e\u3059\u3002","\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["\u7d50\u679c\u304c\u6210\u529f\u306a\u3089\u3001",(0,t.jsx)(r.em,{children:"Closed"}),"\u72b6\u614b\u306b\u5909\u308f\u308a\u307e\u3059\u3002"]}),"\n",(0,t.jsxs)(r.li,{children:["\u7d50\u679c\u304c\u6210\u529f\u306a\u3089\u3001",(0,t.jsx)(r.em,{children:"Open"}),"\u72b6\u614b\u306b\u5909\u308f\u308a\u307e\u3059\u3002"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"trialRequestInterval"}),"\u306e\u6642\u9593\u4ee5\u5185\u306b\u5fdc\u7b54\u304c\u306a\u3051\u308c\u3070\u3001",(0,t.jsx)(r.em,{children:"Half-Open"}),"\u72b6\u614b\u3067\u305d\u306e\u6b21\u306b\u5165\u3063\u3066\u304f\u308b\u6700\u521d\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u7d50\u679c\u306b\u3088\u3063\u3066\u5206\u5c90\u51e6\u7406\u3057\u307e\u3059\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"\u4f5c\u6210\u8005\u306e\u7d39\u4ecb",children:"\u4f5c\u6210\u8005\u306e\u7d39\u4ecb"}),"\n",(0,t.jsx)(r.p,{children:"Shin Jong Hun\uff1a\u9762\u5012\u306a\u3053\u3068\u304c\u5927\u5acc\u3044\u3067\u3001\u9762\u5012\u3092\u6e1b\u3089\u3059\u305f\u3081\u306b\u60a9\u307f\u7d9a\u3051\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u304c\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u304c\u597d\u304d\u306b\u306a\u3063\u305f\u7406\u7531\u306a\u306e\u3067\u3059\u304c\u3001\u306a\u3093\u3060\u304b\u3084\u308b\u3053\u3068\u304c\u5897\u3048\u305f\u6c17\u304c\u3059\u308b\u306e\u306f\u81ea\u5206\u3060\u3051\u3067\u3057\u3087\u3046\u304b\u306d\uff1f"})]})}function u(e={}){const{wrapper:r}={...(0,c.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},28453:(e,r,i)=>{i.d(r,{R:()=>l,x:()=>s});var n=i(96540);const t={},c=n.createContext(t);function l(e){const r=n.useContext(c);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),n.createElement(c.Provider,{value:r},e.children)}},75614:e=>{e.exports=JSON.parse('{"permalink":"/blog/ja/2016/08/04/applying-circuitbreaker-to-channel-gateway","editUrl":"https://github.com/line/armeria/edit/main/site/src/content/blog/ja/2016-08-04-applying-circuitbreaker-to-channel-gateway.mdx","source":"@site/src/content/blog/ja/2016-08-04-applying-circuitbreaker-to-channel-gateway.mdx","title":"\u30c1\u30e3\u30cd\u30eb\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3078\u306eCircuitBreaker\u306e\u9069\u7528","description":"\u306f\u3058\u3081\u306b","date":"2016-08-04T00:00:00.000Z","tags":[],"readingTime":8.48,"hasTruncateMarker":true,"authors":[{"name":"Shin Jong Hun","title":"\u9762\u5012\u306a\u3053\u3068\u304c\u5927\u5acc\u3044\u3067\u3001\u9762\u5012\u3092\u6e1b\u3089\u3059\u305f\u3081\u306b\u60a9\u307f\u7d9a\u3051\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u304c\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u304c\u597d\u304d\u306b\u306a\u3063\u305f\u7406\u7531\u306a\u306e\u3067\u3059\u304c\u3001\u306a\u3093\u3060\u304b\u3084\u308b\u3053\u3068\u304c\u5897\u3048\u305f\u6c17\u304c\u3059\u308b\u306e\u306f\u81ea\u5206\u3060\u3051\u3067\u3057\u3087\u3046\u304b","imageURL":"/img/author-shinjonghun.png","key":"shinjonghun","page":null}],"frontMatter":{"authors":["shinjonghun"],"other_languages":{"en":"/blog/2016/08/04/applying-circuitbreaker-to-channel-gateway","ko":"/blog/ko/2016/08/04/applying-circuitbreaker-to-channel-gateway"}},"unlisted":false,"prevItem":{"title":"RxJava 2\u3068Armeria\u3067\u30de\u30a4\u30af\u30ed\u30b5\u30fc\u30d3\u30b9\u3092\u975e\u540c\u671f\u5316\u3057\u3066\u307f\u305f","permalink":"/blog/ja/2017/12/01/asynchronous-micro-service-in-rxjava-2-armeria"},"nextItem":{"title":"\u5206\u6563\u30b5\u30fc\u30d3\u30b9\u74b0\u5883\u3078\u306eCircuit Breaker\u306e\u9069\u7528","permalink":"/blog/ja/2016/07/14/circuit-breakers-for-distributed-services"}}')}}]);