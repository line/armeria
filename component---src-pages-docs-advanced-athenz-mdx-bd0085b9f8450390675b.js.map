{"version":3,"file":"component---src-pages-docs-advanced-athenz-mdx-bd0085b9f8450390675b.js","mappings":"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","sources":["webpack://armeria-site/./src/pages/docs/advanced-athenz.mdx","webpack://armeria-site/./src/layouts/docs.tsx"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/armeria/armeria/site/src/layouts/docs.tsx\";\nimport versions from '../../../gen-src/versions.json';\nexport const pageTitle = \"Athenz integration\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\nconst RequiredDependencies = makeShortcode(\"RequiredDependencies\");\nconst Tip = makeShortcode(\"Tip\");\nconst layoutProps = {\n  pageTitle,\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n\n\n    <h1 {...{\n      \"id\": \"athenz-integration\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h1\" {...{\n        \"href\": \"#athenz-integration\",\n        \"aria-label\": \"athenz integration permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Athenz integration`}</h1>\n    <h6 {...{\n      \"className\": \"inlinePageToc\",\n      \"role\": \"navigation\"\n    }}>{`Table of contents`}</h6>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#prerequisites\"\n        }}>{`Prerequisites`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#creating-a-zts-client\"\n        }}>{`Creating a ZTS client`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#checking-permissions-with-the-typeathenzservice-decorator\"\n        }}>{`Checking permissions with the type://AthenzService decorator`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#checking-permissions-with-the-typerequiresathenzrole-annotation\"\n        }}>{`Checking permissions with the type://@RequiresAthenzRole annotation`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#obtaining-athenz-tokens-with-typeathenzclient\"\n        }}>{`Obtaining athenz tokens with type://AthenzClient`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#integrating-with-spring-boot\"\n        }}>{`Integrating with Spring Boot`}</a></li>\n    </ul>\n    <p>{`This document explains how to integrate Armeria with `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.athenz.io/\"\n      }}>{`Athenz`}</a>{`, a platform for service\nauthentication and authorization. It assumes that you have already configured an Athenz domain and installed\nthe necessary service identity certificates locally.`}</p>\n    <h2 {...{\n      \"id\": \"prerequisites\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h2\" {...{\n        \"href\": \"#prerequisites\",\n        \"aria-label\": \"prerequisites permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Prerequisites`}</h2>\n    <p>{`Add the following dependencies to your build.gradle file:`}</p>\n    <RequiredDependencies boms={[{\n      groupId: 'com.linecorp.armeria',\n      artifactId: 'armeria-bom'\n    }]} dependencies={[{\n      groupId: 'com.linecorp.armeria',\n      artifactId: 'armeria-athenz'\n    }]} mdxType=\"RequiredDependencies\" />\n    <h2 {...{\n      \"id\": \"creating-a-zts-client\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h2\" {...{\n        \"href\": \"#creating-a-zts-client\",\n        \"aria-label\": \"creating a zts client permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Creating a ZTS client`}</h2>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"type://ZtsBaseClient:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/athenz/ZtsBaseClient.html\"\n      }}>{`type://ZtsBaseClient`}</a>{` is a client used to interact with the `}<a parentName=\"p\" {...{\n        \"href\": \"https://athenz.github.io/athenz/system_view/#zts-authz-token-system\"\n      }}>{`Athenz ZTS (authZ Token System)`}</a>{`.\nIt is required to create `}<a parentName=\"p\" {...{\n        \"href\": \"type://AthenzClient:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/athenz/AthenzClient.html\"\n      }}>{`type://AthenzClient`}</a>{` and `}<a parentName=\"p\" {...{\n        \"href\": \"type://AthenzService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/athenz/AthenzService.html\"\n      }}>{`type://AthenzService`}</a>{` decorators.\nYou can create an instance of `}<a parentName=\"p\" {...{\n        \"href\": \"type://ZtsBaseClient:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/athenz/ZtsBaseClient.html\"\n      }}>{`type://ZtsBaseClient`}</a>{` as follows:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`import com.linecorp.armeria.client.athenz.ZtsBaseClient;\nimport com.linecorp.armeria.client.athenz.ZtsBaseClientBuilder;\n\nZtsBaseClient ztsBaseClient =\n    ZtsBaseClient\n        .builder(\"https://athenz.example.com:8443/zts/v1\")\n        // You need to specify your Athenz service key and certificate files.\n        .keyPair(\"/var/lib/athenz/service.key.pem\", \n                 \"/var/lib/athenz/service.cert.pem\")\n        // Uncomment the following line to use a proxy.\n        // .proxyUri(\"http://my-proxy.example.com:8080\")\n        .build();\n\n// ...\n\n// Close the client when it is no longer needed.\nztsBaseClient.close();\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"checking-permissions-with-the-typeathenzservice-decorator\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h2\" {...{\n        \"href\": \"#checking-permissions-with-the-typeathenzservice-decorator\",\n        \"aria-label\": \"checking permissions with the typeathenzservice decorator permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Checking permissions with the `}<a parentName=\"h2\" {...{\n        \"href\": \"type://AthenzService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/athenz/AthenzService.html\"\n      }}>{`type://AthenzService`}</a>{` decorator`}</h2>\n    <p>{`You can enforce Athenz authorization on your services by applying the `}<a parentName=\"p\" {...{\n        \"href\": \"type://AthenzService:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/athenz/AthenzService.html\"\n      }}>{`type://AthenzService`}</a>{` decorator.\nThis decorator intercepts incoming requests and validates the client's token against the configured Athenz policies.`}</p>\n    <p>{`The code below configures a decorator for paths under `}<inlineCode parentName=\"p\">{`/files`}</inlineCode>{`. It will only grant access to requests that\npresent a token with the specified `}<inlineCode parentName=\"p\">{`action`}</inlineCode>{` (\"get\") and `}<inlineCode parentName=\"p\">{`resource`}</inlineCode>{` (\"files\") for your Athenz domain.\nThe `}<inlineCode parentName=\"p\">{`action`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`resource`}</inlineCode>{` must correspond to an assertion you have configured in Athenz.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`import com.linecorp.armeria.server.Server;\nimport com.linecorp.armeria.server.ServerBuilder;\nimport com.linecorp.armeria.server.athenz.AthenzService;\nimport com.linecorp.armeria.server.athenz.AthenzPolicyConfig;\n\nServerBuilder serverBuilder = Server.builder();\nserverBuilder.decoratorUnder(\n    \"/files\",\n    AthenzService.builder(ztsBaseClient)\n                 .action(\"get\")\n                 .resource(\"files\")\n                 .policyConfig(new AthenzPolicyConfig(\"your-domain\"))\n                 .newDecorator());\nserverBuilder.serviceUnder(\"/files\", FileService.of(...));\n...\n`}</code></pre>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"type://AthenzPolicyConfig:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/athenz/AthenzPolicyConfig.html\"\n      }}>{`type://AthenzPolicyConfig`}</a>{` object replaces the need for a `}<inlineCode parentName=\"p\">{`zpu.conf`}</inlineCode>{` file. It allows the server to download\npolicy files directly at startup and perform authorization checks without relying on the `}<a parentName=\"p\" {...{\n        \"href\": \"https://athenz.github.io/athenz/setup_zpu/\"\n      }}><inlineCode parentName=\"a\">{`zpu`}</inlineCode></a>{`\ncommand-line utility.`}</p>\n    <p>{`If you are only using the decorator for permission checks, this is all the configuration required to integrate Athenz with Armeria.`}</p>\n    <h2 {...{\n      \"id\": \"checking-permissions-with-the-typerequiresathenzrole-annotation\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h2\" {...{\n        \"href\": \"#checking-permissions-with-the-typerequiresathenzrole-annotation\",\n        \"aria-label\": \"checking permissions with the typerequiresathenzrole annotation permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Checking permissions with the `}<a parentName=\"h2\" {...{\n        \"href\": \"type://@RequiresAthenzRole:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/athenz/RequiresAthenzRole.html\"\n      }}>{`type://@RequiresAthenzRole`}</a>{` annotation`}</h2>\n    <p>{`As an alternative to programmatically applying decorators, you can use the `}<a parentName=\"p\" {...{\n        \"href\": \"type://@RequiresAthenzRole:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/athenz/RequiresAthenzRole.html\"\n      }}>{`type://@RequiresAthenzRole`}</a>{` annotation\non service methods or classes for a more declarative approach.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`import com.linecorp.armeria.server.athenz.RequiresAthenzRole;\n\nclass MyService {\n    // Decorate the method with \\`@RequiresAthenzRole\\` to check the Athenz role.\n    @RequiresAthenzRole(resource = \"user\", action = \"get\")\n    @ProducesJson\n    @Get(\"/user\")\n    public CompletableFuture<User> getUser() {\n        // ...\n    }\n}\n`}</code></pre>\n    <p>{`To enable this annotation, you must register an `}<a parentName=\"p\" {...{\n        \"href\": \"type://AthenzServiceDecoratorFactory:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/athenz/AthenzServiceDecoratorFactory.html\"\n      }}>{`type://AthenzServiceDecoratorFactory`}</a>{` with the server.\nThis factory uses the `}<a parentName=\"p\" {...{\n        \"href\": \"type://ZtsBaseClient:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/athenz/ZtsBaseClient.html\"\n      }}>{`type://ZtsBaseClient`}</a>{` to create the necessary decorators that enforce the roles specified\nin the annotations.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`import com.linecorp.armeria.common.DependencyInjector;\nimport com.linecorp.armeria.server.athenz.AthenzPolicyConfig;\nimport com.linecorp.armeria.server.athenz.AthenzServiceDecoratorFactory;\nimport com.linecorp.armeria.server.athenz.AthenzServiceDecoratorFactoryBuilder;\n\n// Create and register \\`AthenzServiceDecoratorFactory\\`.\nAthenzServiceDecoratorFactory athenzDecoratorFactory =\n  AthenzServiceDecoratorFactory\n    .builder(ztsBaseClient)\n    .policyConfig(new AthenzPolicyConfig(\"my-domain\"))\n    .build();\n\nDependencyInjector di =\n  DependencyInjector.ofSingletons(athenzDecoratorFactory)\n                    .orElse(DependencyInjector.ofReflective());\nserverBuilder.dependencyInjector(di, true);\n`}</code></pre>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"type://@RequiresAthenzRole:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/athenz/RequiresAthenzRole.html\"\n      }}>{`type://@RequiresAthenzRole`}</a>{` annotation can be applied not only to annotated services but also to methods in\nThrift and gRPC services.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`class UserGrpcServiceImpl extends UserGrpcServiceImplBase {\n  @RequiresAthenzRole(resource = \"user\", action = \"get\")\n  public void getUser(UserRequest request,\n                      StreamObserver<UserResponse> responseObserver) {\n    // ...\n  }\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"obtaining-athenz-tokens-with-typeathenzclient\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h2\" {...{\n        \"href\": \"#obtaining-athenz-tokens-with-typeathenzclient\",\n        \"aria-label\": \"obtaining athenz tokens with typeathenzclient permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Obtaining athenz tokens with `}<a parentName=\"h2\" {...{\n        \"href\": \"type://AthenzClient:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/athenz/AthenzClient.html\"\n      }}>{`type://AthenzClient`}</a></h2>\n    <p>{`To communicate with other Athenz-protected services, you can use the `}<a parentName=\"p\" {...{\n        \"href\": \"type://AthenzClient:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/athenz/AthenzClient.html\"\n      }}>{`type://AthenzClient`}</a>{` decorator.\nThis client automatically acquires an Athenz token from the ZTS, caches it, and attaches it to outgoing requests.\nIt also handles token refreshes before expiration, so you do not need to manage the token lifecycle yourself.`}</p>\n    <p>{`To obtain an access token and send it in the `}<inlineCode parentName=\"p\">{`Authorization`}</inlineCode>{` header, configure the decorator with `}<a parentName=\"p\" {...{\n        \"href\": \"type://TokenType#ACCESS_TOKEN:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/athenz/TokenType.html#ACCESS_TOKEN\"\n      }}>{`type://TokenType#ACCESS_TOKEN`}</a>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`import com.linecorp.armeria.client.athenz.AthenzClient;\nimport com.linecorp.armeria.common.athenz.TokenType;\n\nWebClient client =\n  WebClient\n    .builder(\"https://api.example.com/\")\n    .decorator(AthenzClient.newDecorator(ztsBaseClient, \"my-domain\",\n                                         TokenType.ACCESS_TOKEN))\n    .build();\n \n// An Athenz access token is automatically acquired and set in the \\`Authorization\\` header.\nclient.get(\"/files\");\n`}</code></pre>\n    <p>{`To obtain a role token and send it in a role token header (e.g., Athenz-Role-Auth or Yahoo-Role-Auth), specify\n`}<a parentName=\"p\" {...{\n        \"href\": \"type://TokenType#ATHENZ_ROLE_TOKEN:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/athenz/TokenType.html#ATHENZ_ROLE_TOKEN\"\n      }}>{`type://TokenType#ATHENZ_ROLE_TOKEN`}</a>{` or `}<a parentName=\"p\" {...{\n        \"href\": \"type://TokenType#YAHOO_ROLE_TOKEN:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/athenz/TokenType.html#YAHOO_ROLE_TOKEN\"\n      }}>{`type://TokenType#YAHOO_ROLE_TOKEN`}</a>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`WebClient client =\nWebClient\n  .builder(\"https://api.example.com/\")\n  .decorator(AthenzClient.newDecorator(ztsBaseClient, \"my-domain\",\n                                       TokenType.ATHENZ_ROLE_TOKEN))\n  .build();\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"integrating-with-spring-boot\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h2\" {...{\n        \"href\": \"#integrating-with-spring-boot\",\n        \"aria-label\": \"integrating with spring boot permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Integrating with Spring Boot`}</h2>\n    <p>{`If you are using Spring Boot, you can enable the `}<a parentName=\"p\" {...{\n        \"href\": \"type://@RequiresAthenzRole:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/athenz/RequiresAthenzRole.html\"\n      }}>{`type://@RequiresAthenzRole`}</a>{` annotation\nby configuring Athenz properties in `}<inlineCode parentName=\"p\">{`application.yml`}</inlineCode>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`// in application.yml\narmeria:\n  athenz:\n    zts-uri: https://athenz.example.com:8443/zts/v1\n    domains: my-athenz-provider-domain\n    athenz-private-key: /path/to/athenz_private.pem\n    athenz-public-key: /path/to/athenz_public.pem\n`}</code></pre>\n    <Tip mdxType=\"Tip\">\n      <p>{`Visit `}<a parentName=\"p\" {...{\n          \"href\": \"https://github.com/line/armeria/tree/main/examples/athenz\"\n        }}>{`athenz-example`}</a>{` to check out a fully working example.`}</p>\n    </Tip>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","import { RouteComponentProps } from '@reach/router';\nimport { graphql, useStaticQuery } from 'gatsby';\nimport React from 'react';\n\nimport docsIndex from '../pages/docs/toc.json';\nimport MdxLayout from './mdx';\n\ninterface DocsLayoutProps extends RouteComponentProps {\n  pageContext: any;\n  pageTitle: string;\n}\n\nconst DocsLayout: React.FC<DocsLayoutProps> = (props) => {\n  const {\n    allMdx: { nodes: candidateMdxNodes },\n  } = useStaticQuery(graphql`\n    query {\n      allMdx(filter: { fileAbsolutePath: { glob: \"**/src/pages/docs/**\" } }) {\n        nodes {\n          tableOfContents(maxDepth: 1)\n          excerpt(pruneLength: 256, truncate: true)\n          parent {\n            ... on File {\n              sourceInstanceName\n              name\n            }\n          }\n        }\n      }\n    }\n  `);\n\n  return (\n    <MdxLayout\n      {...props}\n      candidateMdxNodes={candidateMdxNodes}\n      index={docsIndex}\n      prefix=\"docs\"\n      pageTitleSuffix=\"Armeria documentation\"\n    />\n  );\n};\n\nexport default DocsLayout;\n"],"names":["pageTitle","_frontmatter","makeShortcode","name","props","console","warn","mdx","RequiredDependencies","Tip","layoutProps","MDXLayout","DefaultLayout","MDXContent","_ref","components","_objectWithoutProperties","_excluded","Object","assign","mdxType","parentName","boms","groupId","artifactId","dependencies","isMDXComponent","allMdx","nodes","candidateMdxNodes","useStaticQuery","React","MdxLayout","index","docsIndex","prefix","pageTitleSuffix"],"sourceRoot":""}