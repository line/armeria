---
date: 2023-02-08
---

## ğŸŒŸ New features

- gRPC calls can now be intercepted asynchronously using <type://AsyncServerInterceptor>. #4647
  ```java
  class AuthServerInterceptor implements AsyncServerInterceptor {
    @Override
    <I, O> CompletableFuture<Listener<I>> asyncInterceptCall(
          ServerCall<I, O> call, Metadata headers, ServerCallHandler<I, O> next) {
      return authorizer.authorize(headers).thenApply(result -> {
        if (result) {
          return next.startCall(call, headers);
        } else {
          throw new AuthenticationException("Invalid access");
        }
      });
   }
  }

  GrpcService.builder()
             .intercept(new AuthServerInterceptor()
             .addService(...)
             ...
  ```
- <type://CircuitBreaker> integration with Resilience4j's circuit breaker is now available. #1469 #4139
  ```java
  Resilience4jCircuitBreakerMapping mapping = Resilience4jCircuitBreakerMapping.of();
  BlockingWebClient client = WebClient
    .builder()
    .decorator(CircuitBreakerClient
      .builder(CircuitBreakerRule.onException())
      .handler(Resilience4JCircuitBreakerClientHandler.of(mapping))
      .newDecorator())
    ...
  ```
<Tip>
  Note that `armeria-resilience4j2` requires Java 17 or higher.
</Tip>
- `@Blocking` annotation can now be used with gRPC services. #4389 #4585
  ```java
  @Blocking // ğŸ‘ˆğŸ‘ˆğŸ‘ˆ applies to all methods in the class
  class MyGrpcServiceImpl extends MyGrpcServiceImplBase {
    @Blocking // ğŸ‘ˆğŸ‘ˆğŸ‘ˆ applies to a single method
    public void blockingCall(...) {
      ...
    }
  }
  ```
- Armeria server with Spring integration can now be configured to bind to non-ip addresses. #4597 #4598
- The authenticated remote user for requests are now logged in access logs. #4634
- <type://DocService>'s debug page is lifted to a dedicated popup for better user experience. #4599
- DocService now exposes a JSON specification via the `/schemas.json` endpoint. #4518

## ğŸ“ˆ Improvements

- `Server.reconfigure()` now dynamically updates TLS configurations correctly. #4637
- Thrift typedefs are now correctly displayed in <type://DocService>. #4628
- DocService front-end assets are now compressed using Gzip instead of Brotli. #4616
- An exception is raised if TLS is set for a port-based virtual host. #4588

## ğŸ› ï¸ Bug fixes

- `431 Request Header Fields Too Large` is now returned instead of `400 Bad Request` if the header size exceeds `ServerBuilder.http1MaxHeaderSize()`. #4609 #4655
- A `NullPointerException` is no longer visible when an aborted <type://StreamMessage> is collected. #4652
- Warning on duplicate parameters in <type://DocService> are no longer visible when annotations are added to a Kotlin data class. #4645
- gRPC HTTP/JSON transcoding now doesn't throw an exception for nested types. #4631 #4641
- gRPC HTTP/JSON transcoding now interprets the `google.protobuf.FieldMask` type as a string. #4633 #4640
- gRPC metadata is now exposed via <type://StatusRuntimeException> in `RequestLog.responseCause()`. #4635 #4636
- `RequestLog.cause()` is not set when an HTTP/1 connection is closed after response data has been fully sent. #4632
- Square brackets (`[]`) are correctly encoded when specified in query and path parameters. #4607 #4615
- <type://DecodingService> and <type://DecodingClient> now correctly limit the max length of decompressed streaming data. #4613
- Client-side gRPC callback `ClientCall.Listener#onHeaders` is now invoked correctly. #4583 #4608
- DocService now correctly displays multiple example requests for a single endpoint. #4576 #4605

## ğŸšï¸ Deprecations

- `ArmeriaSettings.ip` is deprecated in favor of `ArmeriaSettings.address` #4597 #4598

## â˜¢ï¸ Breaking changes

- TBU

## â›“ Dependencies

- Brave 5.14.1 -> 5.15.0
- Dropwizard-metrics 4.2.13 -> 4.2.15
- GraphQL Kotlin 6.3.2 -> 6.3.5
- gRPC Java 1.49.1 -> 1.52.1
- Hibernate Validator 6.2.3.Final -> 6.2.5.Final
- Jackson 2.14.1 -> 2.14.2
- java-jwt 4.2.1 -> 4.2.2
- Kafka client 3.3.1 -> 3.4.0
- Kotlin 1.7.22 -> 1.8.10
- Micrometer 4.10.0 -> 4.11.0
- Netty 4.1.86.Final -> 4.1.87.Final
- io_uring 0.0.16.Final -> 0.0.17.Final
- Protobuf 3.21.1 -> 3.21.7
- Resteasy 5.0.4.Final -> 5.0.5.Final
- RxJava3 3.1.5 -> 3.1.6
- Sangria 3.4.1 -> 3.5.0
- Scala3 3.2.0 -> 3.2.2
- ScalaPB 0.11.12 -> 0.11.13
- ScalaPB JSON 0.12.0 -> 0.12.1
- Spring 5.3.23 -> 5.3.25
- Spring Boot 2.7.4 -> 2.7.8
- Tomcat8 8.5.84 -> 8.5.85
- Tomcat9 9.0.70 -> 9.0.71

## ğŸ—‘ Build improvement

- - <type://PropertiesEndpointGroup> related tests now pass for directories with a space. #4617

## ğŸ™‡ Thank you

<ThankYou usernames={[
  'Dogacel',
  'cormoran',
  'daniel-itunu',
  'dependabot[bot]',
  'heesuk-ahn',
  'hyperxpro',
  'ikhoon',
  'j-min5u',
  'jrhee17',
  'kezhenxu94',
  'kojilin',
  'minwoox',
  'sullis',
  'ta7uw',
  'tomatophobia',
  'trustin'
]} />