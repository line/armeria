"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[5809],{28453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>l});var r=i(96540);const s={},t=r.createContext(s);function c(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(t.Provider,{value:n},e.children)}},82597:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"0.88.0","title":"v0.88.0","description":"New features","source":"@site/src/content/release-notes/0.88.0.mdx","sourceDirName":".","slug":"/0.88.0","permalink":"/release-notes/0.88.0","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site-new/src/content/release-notes/0.88.0.mdx","tags":[],"version":"current","frontMatter":{"date":"2019-07-03T00:00:00.000Z"},"sidebar":"defaultSidebar","previous":{"title":"v0.89.0","permalink":"/release-notes/0.89.0"},"next":{"title":"v0.87.0","permalink":"/release-notes/0.87.0"}}');var s=i(74848),t=i(28453);const c={date:new Date("2019-07-03T00:00:00.000Z")},l="v0.88.0",a={},o=[{value:"New features",id:"new-features",level:2},{value:"Improvements",id:"improvements",level:2},{value:"Bug fixes",id:"bug-fixes",level:2},{value:"Deprecations",id:"deprecations",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Thank you",id:"thank-you",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components},{ThankYou:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ThankYou",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.header,{children:[(0,s.jsx)(n.h1,{id:"v0880",children:"v0.88.0"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"July 3, 2019"})})]}),"\n",(0,s.jsx)(n.h2,{id:"new-features",children:"New features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"ClientRequestContext.current()"})," and ",(0,s.jsx)(n.code,{children:"ServiceRequestContext.current()"})," have been added so you don't need to downcast ",(0,s.jsx)(n.code,{children:"RequestContext"})," to ",(0,s.jsx)(n.code,{children:"ClientRequestContext"})," or ",(0,s.jsx)(n.code,{children:"ServiceRequestContext"}),". It also makes sure the current context is client-side (or server-side), preventing a ",(0,s.jsx)(n.code,{children:"ClassCastException"}),". ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1869",children:"#1869"})," ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1872",children:"#1872"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"ClientRequestContext cctx = ClientRequestContext.current();\nServiceRequestContext sctx = ServiceRequestContext.current();\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"currentOrNull()"})," static method has been added to ",(0,s.jsx)(n.code,{children:"(Client|Service)RequestContext"}),", which is similar to ",(0,s.jsx)(n.code,{children:"current()"})," but returning ",(0,s.jsx)(n.code,{children:"null"})," when there's no current context. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1872",children:"#1872"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"// Before:\nRequestContext ctx = RequestContext.mapCurrent(Function.identity(), null);\n// After:\nServiceRequestContext sctx = ServiceRequestContext.currentOrNull();\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["You can now specify different ",(0,s.jsx)(n.code,{children:"AccessLogWriter"}),"s for different services. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1866",children:"#1866"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'Server server = new ServerBuilder()\n        .route().path("/svc1")\n                .accessLogWriter(accessLogWriterForService1, true)\n                .build(service1)\n        .route().path("/svc2") // Will use the fallbackAccessLogWriter.\n                .build(service2)\n        .accessLogWriter(fallbackAccessLogWriter, true)\n        .build();\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The metrics of the ",(0,s.jsx)(n.code,{children:"Executor"})," specified in ",(0,s.jsx)(n.code,{children:"ServerBuilder.blockingTaskExecutor()"})," will be exposed under ",(0,s.jsx)(n.code,{children:"executor{name=armeriaBlockingTaskExecutor}"}),". ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1683",children:"#1683"})," ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1841",children:"#1841"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Armeria client will send a DNS query via TCP when a DNS response is truncated due to UDP packet size limitation. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1873",children:"#1873"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["You can now specify health check request interval using a ",(0,s.jsx)(n.code,{children:"Backoff"}),", which means you can have more flexible delay strategy such as adding jitter. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1846",children:"#1846"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"HttpHealthCheckedEndpointGroup group = new HttpHealthCheckedEndpointGroup(...)\n        .retryBackoff(Backoff.fixed(10000).withJitter(0.3))\n        .build();\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["By default, ",(0,s.jsx)(n.code,{children:"HealthCheckedEndpointGroup"})," will now add 20% jitter to the health check request interval."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["A new module ",(0,s.jsx)(n.code,{children:"armeria-brave"})," has been added to replace the deprecated ",(0,s.jsx)(n.code,{children:"armeria-zipkin"}),". ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1840",children:"#1840"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The package name has been changed from ",(0,s.jsx)(n.code,{children:"com.linecorp.armeria.{common,client,server}.tracing"})," to ",(0,s.jsx)(n.code,{children:"com.linecorp.armeria.{common,client,server}.brave"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"HttpTracingClient"})," and ",(0,s.jsx)(n.code,{children:"HttpTracingService"})," have been renamed to ",(0,s.jsx)(n.code,{children:"BraveClient"})," and ",(0,s.jsx)(n.code,{children:"BraveService"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["You can now retrieve the ",(0,s.jsx)(n.code,{children:"retrofit2.Invocation"})," object associated with the current Retrofit call via ",(0,s.jsx)(n.code,{children:"InvocationUtil.get(RequestLog)"}),", which can be useful when building a meter ID prefix. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1591",children:"#1591"})," ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1845",children:"#1845"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public class MyRetrofitMeterIdPrefixFunction implements MeterIdPrefixFunction {\n    @Override\n    public MeterIdPrefix apply(MeterRegistry registry, RequestLog log) {\n        final Invocation invocation = InvocationUtil.getInvocation(log);\n        final String service;\n        final String method;\n        if (invocation != null) {\n            service = invocation.method().getDeclaringClass().getSimpleName();\n            method = invocation.method().getName();\n        } else {\n            service = "unknown";\n            method = log.method().name();\n        }\n        return new MeterIdPrefix("call", "service", service, "method", method);\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["We also added ",(0,s.jsx)(n.code,{children:"RetrofitMeterIdPrefixFunction"})," which provides the sensible default ",(0,s.jsx)(n.code,{children:"MeterIdPrefixFunction"})," for Retrofit calls."]}),"\n"]}),"\n"]}),"\n"]}),"\n","\n",(0,s.jsx)(n.h2,{id:"improvements",children:"Improvements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The content negotiation logic has been relaxed so that the server falls back to the service with less constraint when content negotiation fails. Previously, it was rejecting the request. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1860",children:"#1860"})]}),"\n",(0,s.jsxs)(n.li,{children:["More exceptions are now wrapped by ",(0,s.jsx)(n.code,{children:"UnprocessedRequestException"})," to indicate whether the request can be safely retried without worrying about sending the request more than once. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1653",children:"#1653"})," ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1848",children:"#1848"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Any exceptions that occurred during a connection attempt."}),"\n",(0,s.jsx)(n.li,{children:"Any exceptions that occurred during acquiring an existing connection from a connection pool."}),"\n",(0,s.jsxs)(n.li,{children:["We also made ",(0,s.jsx)(n.code,{children:"UnprocessedRequestException.getCause()"})," is non-null, so you do not need to worry about the case where there is no cause in ",(0,s.jsx)(n.code,{children:"UnprocessedRequestException"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"bug-fixes",children:"Bug fixes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Server will now allow specifying a ",(0,s.jsx)(n.code,{children:"@Default"})," annotation with ",(0,s.jsx)(n.code,{children:"null"})," value. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1858",children:"#1858"})," ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1864",children:"#1864"})]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"DEBUG"})," level log message which occurs when a client sent an ill-formed ",(0,s.jsx)(n.code,{children:"Accept"})," header is now easier to understand. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1849",children:"#1849"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"THttpService"})," now handles ",(0,s.jsx)(n.code,{children:"HttpStatusException"})," and ",(0,s.jsx)(n.code,{children:"HttpResponseException"})," correctly, which means they will not be translated into a ",(0,s.jsx)(n.code,{children:"200 OK"})," response that contains a ",(0,s.jsx)(n.code,{children:"TApplicationException"})," anymore. For example, your Thrift clients will see ",(0,s.jsx)(n.code,{children:"503 Service Unavailable"})," response when your service throws an ",(0,s.jsx)(n.code,{children:"HttpStatusException.of(503)"})," rather than ",(0,s.jsx)(n.code,{children:"200 OK"}),". ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1839",children:"#1839"})," ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1867",children:"#1867"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"DocService"})," debug form will validate the endpoint path properly now. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1856",children:"#1856"})," ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1857",children:"#1857"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"RequestContextCurrentTraceContext"})," now calls ",(0,s.jsx)(n.code,{children:"decorateScope()"})," when necessary. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1840",children:"#1840"})]}),"\n",(0,s.jsxs)(n.li,{children:["Spring Web and WebFlux integration do not ignore the ",(0,s.jsx)(n.code,{children:"ssl.keyAlias"})," property anymore. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1843",children:"#1843"})," ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1865",children:"#1865"})]}),"\n",(0,s.jsxs)(n.li,{children:["You will not see an ",(0,s.jsx)(n.code,{children:"ERROR"})," log message when a client sends a ",(0,s.jsx)(n.code,{children:"HEAD"})," request to your Spring WebFlux endpoint. ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1847",children:"#1847"})," ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1859",children:"#1859"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"deprecations",children:"Deprecations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"HttpHealthCheckedEndpointGroupBuilder.retryInterval(Duration)"})," has been deprecated. Use ",(0,s.jsx)(n.code,{children:"retryBackoff(Backoff)"}),". ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1846",children:"#1846"})]}),"\n",(0,s.jsxs)(n.li,{children:["Everything in ",(0,s.jsx)(n.code,{children:"armeria-zipkin"})," has been deprecated. Use ",(0,s.jsx)(n.code,{children:"armeria-brave"}),". ",(0,s.jsx)(n.a,{href:"https://github.com/line/armeria/issues/1840",children:"#1840"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Brave 5.6.3 -> 5.6.6"}),"\n",(0,s.jsx)(n.li,{children:"FastUtil 8.2.2 -> 8.2.3"}),"\n",(0,s.jsx)(n.li,{children:"Hibernate Validator 6.0.16 -> 6.0.17"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"javax.annotation-api"})," -> ",(0,s.jsx)(n.code,{children:"jakarta.annotation-api"})," 1.3.4"]}),"\n",(0,s.jsx)(n.li,{children:"Jetty 9.4.18 -> 9.4.19"}),"\n",(0,s.jsx)(n.li,{children:"Micrometer 1.1.4 -> 1.2.0"}),"\n",(0,s.jsxs)(n.li,{children:["Netty 4.1.34 -> 4.1.37","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"TCNative BoringSSL 2.0.23 -> 2.0.25"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"protobuf-jackson 0.4.0 -> 1.0.0"}),"\n",(0,s.jsx)(n.li,{children:"RxJava 2.2.9 -> 2.2.10"}),"\n",(0,s.jsx)(n.li,{children:"Spring Boot 2.1.5 -> 2.1.6"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"thank-you",children:"Thank you"}),"\n",(0,s.jsx)(i,{usernames:["Adanz","anuraaga","cj848","codefromthecrypt","hyeonjames","ikhoon","imasahiro","kojilin","minwoox","normanmaurer","southernkasaist","tobias-","trustin"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);