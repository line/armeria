"use strict";(globalThis.webpackChunkarmeria_site=globalThis.webpackChunkarmeria_site||[]).push([[2258],{12793:e=>{e.exports=JSON.parse('{"build.buf.protoc-gen-validate:pgv-java-stub":"1.2.1","build.buf.protoc-gen-validate:protoc-gen-validate":"1.2.1","cglib:cglib":"3.3.0","ch.megard:akka-http-cors_2.13":"1.0.0","ch.qos.logback:logback-classic":"1.5.21","com.aayushatharva.brotli4j:brotli4j":"1.20.0","com.aayushatharva.brotli4j:native-linux-aarch64":"1.20.0","com.aayushatharva.brotli4j:native-linux-x86_64":"1.20.0","com.aayushatharva.brotli4j:native-osx-aarch64":"1.20.0","com.aayushatharva.brotli4j:native-osx-x86_64":"1.20.0","com.aayushatharva.brotli4j:native-windows-x86_64":"1.20.0","com.auth0:java-jwt":"4.5.0","com.expediagroup:graphql-kotlin-client":"8.8.1","com.expediagroup:graphql-kotlin-client-jackson":"8.8.1","com.expediagroup:graphql-kotlin-client-serialization":"8.8.1","com.expediagroup:graphql-kotlin-schema-generator":"8.8.1","com.fasterxml.jackson.core:jackson-annotations":"","com.fasterxml.jackson.core:jackson-core":"","com.fasterxml.jackson.core:jackson-databind":"","com.fasterxml.jackson.dataformat:jackson-dataformat-yaml":"","com.fasterxml.jackson.datatype:jackson-datatype-jdk8":"","com.fasterxml.jackson.datatype:jackson-datatype-jsr310":"","com.fasterxml.jackson.module:jackson-module-kotlin":"","com.fasterxml.jackson.module:jackson-module-scala_2.12":"","com.fasterxml.jackson.module:jackson-module-scala_2.13":"","com.fasterxml.jackson.module:jackson-module-scala_3":"","com.fasterxml.jackson:jackson-bom":"2.20.1","com.github.ben-manes.caffeine:caffeine":"2.9.3","com.github.vladimir-bukhtoyarov:bucket4j-core":"7.6.0","com.google.api:gax-grpc":"2.72.1","com.google.code.findbugs:jsr305":"3.0.2","com.google.dagger:dagger":"2.57.2","com.google.dagger:dagger-compiler":"2.57.2","com.google.dagger:dagger-producers":"2.57.2","com.google.errorprone:error_prone_annotations":"2.44.0","com.google.errorprone:error_prone_core":"2.44.0","com.google.guava:failureaccess":"1.0.1","com.google.guava:guava":"33.5.0-jre","com.google.guava:guava-testlib":"33.5.0-jre","com.google.j2objc:j2objc-annotations":"3.1","com.google.protobuf:protobuf-bom":"4.33.1","com.google.protobuf:protobuf-gradle-plugin":"0.9.5","com.google.protobuf:protobuf-java":"3.25.8","com.google.protobuf:protobuf-java-util":"3.25.8","com.google.protobuf:protoc":"3.25.8","com.google.re2j:re2j":"1.8","com.gradleup.shadow:com.gradleup.shadow.gradle.plugin":"8.3.9","com.graphql-java:graphql-java":"25.0","com.guardsquare:proguard-gradle":"7.8.1","com.lightbend.akka.grpc:akka-grpc-runtime_2.13":"1.0.3","com.linecorp.armeria:armeria-bom":"1.34.1","com.netflix.eureka:eureka-client":"2.0.5","com.netflix.eureka:eureka-test-utils":"2.0.5","com.netflix.graphql.dgs:graphql-dgs-client":"10.4.0","com.puppycrawl.tools:checkstyle":"10.3.2","com.salesforce.servicelibs:reactor-grpc":"1.2.4","com.salesforce.servicelibs:reactor-grpc-stub":"1.2.4","com.spotify:completable-futures":"0.3.6","com.spotify:futures-extra":"4.3.3","com.squareup.okhttp3:okhttp":"5.3.2","com.squareup.okhttp3:okhttp-tls":"5.3.2","com.squareup.okhttp:okhttp":"2.7.5","com.squareup.retrofit2:converter-jackson":"2.12.0","com.squareup.retrofit2:retrofit":"2.12.0","com.thesamet.scalapb:scalapb-json4s_2.12":"0.12.2","com.thesamet.scalapb:scalapb-json4s_2.13":"0.12.2","com.thesamet.scalapb:scalapb-json4s_3":"0.12.2","com.thesamet.scalapb:scalapb-runtime-grpc_2.12":"0.11.20","com.thesamet.scalapb:scalapb-runtime-grpc_2.13":"0.11.20","com.thesamet.scalapb:scalapb-runtime-grpc_3":"0.11.20","com.thesamet.scalapb:scalapb-runtime_2.12":"0.11.20","com.thesamet.scalapb:scalapb-runtime_2.13":"0.11.20","com.thesamet.scalapb:scalapb-runtime_3":"0.11.20","com.twitter:finagle-serversets_2.13":"24.2.0","com.typesafe.akka:akka-actor-typed_2.13":"2.8.8","com.typesafe.akka:akka-discovery_2.13":"2.8.8","com.typesafe.akka:akka-stream_2.13":"2.8.8","com.uber.nullaway:nullaway":"0.12.12","com.yahoo.athenz:athenz-zms-java-client":"1.12.29","com.yahoo.athenz:athenz-zpe-java-client":"1.12.29","com.yahoo.athenz:athenz-zts-java-client":"1.12.29","info.picocli:picocli":"4.7.7","io.dropwizard.metrics:metrics-bom":"4.2.37","io.dropwizard.metrics:metrics-core":"","io.dropwizard.metrics:metrics-json":"","io.dropwizard:dropwizard-core":"2.1.12","io.dropwizard:dropwizard-jackson":"2.1.12","io.dropwizard:dropwizard-jersey":"2.1.12","io.dropwizard:dropwizard-jetty":"2.1.12","io.dropwizard:dropwizard-lifecycle":"2.1.12","io.dropwizard:dropwizard-testing":"2.1.12","io.dropwizard:dropwizard-util":"2.1.12","io.dropwizard:dropwizard-validation":"2.1.12","io.envoyproxy.controlplane:cache":"1.0.49","io.envoyproxy.controlplane:server":"1.0.49","io.fabric8:kubernetes-client":"7.4.0","io.fabric8:kubernetes-client-api":"7.4.0","io.fabric8:kubernetes-junit-jupiter":"7.4.0","io.fabric8:kubernetes-server-mock":"7.4.0","io.github.mscheong01:krotoDC-core":"1.2.2","io.github.mscheong01:protoc-gen-krotoDC":"1.2.2","io.github.resilience4j:resilience4j-circuitbreaker":"2.3.0","io.github.resilience4j:resilience4j-micrometer":"2.3.0","io.github.resilience4j:resilience4j-spring-boot2":"2.3.0","io.grpc:grpc-bom":"1.77.0","io.grpc:grpc-core":"","io.grpc:grpc-interop-testing":"","io.grpc:grpc-kotlin-stub":"1.4.1","io.grpc:grpc-netty-shaded":"","io.grpc:grpc-okhttp":"","io.grpc:grpc-protobuf":"","io.grpc:grpc-services":"","io.grpc:grpc-stub":"","io.grpc:grpc-testing":"","io.grpc:protoc-gen-grpc-kotlin":"1.4.1","io.micrometer:context-propagation":"1.2.0","io.micrometer:micrometer-core":"1.16.0","io.micrometer:micrometer-docs-generator":"1.0.2","io.micrometer:micrometer-observation":"1.16.0","io.micrometer:micrometer-observation-test":"1.16.0","io.micrometer:micrometer-registry-prometheus":"1.16.0","io.micrometer:micrometer-registry-prometheus-simpleclient":"1.16.0","io.micrometer:micrometer-spring-legacy":"1.16.0","io.micrometer:micrometer-tracing-integration-test":"1.6.0","io.modelcontextprotocol.sdk:mcp":"","io.modelcontextprotocol.sdk:mcp-bom":"0.15.0","io.modelcontextprotocol.sdk:mcp-spring-webflux":"","io.modelcontextprotocol.sdk:mcp-test":"","io.monix:monix-reactive_2.12":"3.4.1","io.monix:monix-reactive_2.13":"3.4.1","io.monix:monix-reactive_3":"3.4.1","io.netty:netty-bom":"4.2.7.Final","io.netty:netty-codec-haproxy":"","io.netty:netty-codec-http2":"","io.netty:netty-common":"","io.netty:netty-handler-proxy":"","io.netty:netty-resolver-dns":"","io.netty:netty-resolver-dns-native-macos":"","io.netty:netty-tcnative-boringssl-static":"","io.netty:netty-transport":"","io.netty:netty-transport-native-epoll":"","io.netty:netty-transport-native-io_uring":"","io.netty:netty-transport-native-kqueue":"","io.netty:netty-transport-native-unix-common":"","io.projectreactor.kotlin:reactor-kotlin-extensions":"1.3.0","io.projectreactor.tools:blockhound":"1.0.15.RELEASE","io.projectreactor.tools:blockhound-junit-platform":"1.0.15.RELEASE","io.projectreactor:reactor-core":"3.8.0","io.projectreactor:reactor-test":"3.8.0","io.prometheus:prometheus-metrics-exposition-formats":"1.4.3","io.prometheus:simpleclient_common":"0.16.0","io.reactivex.rxjava2:rxjava":"2.2.21","io.reactivex.rxjava3:rxjava":"3.1.12","io.zipkin.brave:brave":"6.3.0","io.zipkin.brave:brave-context-slf4j":"6.3.0","io.zipkin.brave:brave-instrumentation-http":"6.3.0","io.zipkin.brave:brave-instrumentation-http-tests":"6.3.0","io.zipkin.brave:brave-instrumentation-rpc":"6.3.0","it.unimi.dsi:fastutil":"8.5.18","jakarta.inject:jakarta.inject-api":"2.0.1","jakarta.validation:jakarta.validation-api":"3.1.1","jakarta.websocket:jakarta.websocket-api":"2.2.0","jakarta.websocket:jakarta.websocket-client-api":"2.2.0","javax.annotation:javax.annotation-api":"1.3.2","javax.inject:javax.inject":"1","javax.validation:validation-api":"2.0.1.Final","javax.ws.rs:jsr311-api":"1.1.1","junit:junit":"4.13.2","net.javacrumbs.json-unit:json-unit":"2.38.0","net.javacrumbs.json-unit:json-unit-fluent":"2.38.0","net.shibboleth.utilities:java-support":"7.5.2","org.apache.curator:curator-recipes":"5.9.0","org.apache.curator:curator-x-discovery":"5.9.0","org.apache.hbase:hbase-shaded-client":"1.2.6","org.apache.httpcomponents.client5:httpclient5":"5.5.1","org.apache.httpcomponents:httpclient":"4.5.14","org.apache.kafka:kafka-clients":"3.9.1","org.apache.thrift:libthrift":"0.9.3-1","org.apache.tomcat.embed:tomcat-embed-core":"9.0.96","org.apache.tomcat.embed:tomcat-embed-el":"9.0.96","org.apache.tomcat.embed:tomcat-embed-jasper":"9.0.96","org.apache.zookeeper:zookeeper":"3.9.3","org.assertj:assertj-core":"3.27.6","org.awaitility:awaitility":"4.3.0","org.bouncycastle:bcpkix-jdk18on":"1.82","org.bouncycastle:bcprov-jdk18on":"1.82","org.bouncycastle:bcutil-jdk18on":"1.82","org.checkerframework:checker-compat-qual":"2.5.6","org.curioswitch.curiostack:protobuf-jackson":"2.8.1","org.dmonix.junit:zookeeper-junit":"1.2","org.eclipse.jetty.alpn:alpn-api":"1.1.3.v20160715","org.eclipse.jetty.ee10:jetty-ee10-annotations":"12.0.23","org.eclipse.jetty.ee10:jetty-ee10-apache-jsp":"12.0.23","org.eclipse.jetty.ee10:jetty-ee10-glassfish-jstl":"12.0.23","org.eclipse.jetty.ee10:jetty-ee10-servlet":"12.0.23","org.eclipse.jetty.ee10:jetty-ee10-webapp":"12.0.23","org.eclipse.jetty.http2:http2-server":"9.4.55.v20240627","org.eclipse.jetty.websocket:websocket-jakarta-server":"11.0.26","org.eclipse.jetty:apache-jsp":"9.4.55.v20240627","org.eclipse.jetty:apache-jstl":"9.4.55.v20240627","org.eclipse.jetty:jetty-annotations":"9.4.55.v20240627","org.eclipse.jetty:jetty-server":"9.4.55.v20240627","org.eclipse.jetty:jetty-webapp":"9.4.55.v20240627","org.hamcrest:hamcrest":"3.0","org.hamcrest:hamcrest-library":"3.0","org.hibernate.validator:hibernate-validator":"8.0.1.Final","org.java-websocket:Java-WebSocket":"1.6.0","org.jboss.logging:jboss-logging":"3.4.3.Final","org.jboss.logging:jboss-logging-annotations":"2.2.1.Final","org.jboss.resteasy:resteasy-client":"5.0.9.Final","org.jboss.resteasy:resteasy-core":"5.0.9.Final","org.jboss.resteasy:resteasy-core-spi":"5.0.9.Final","org.jboss.resteasy:resteasy-jackson2-provider":"5.0.9.Final","org.jctools:jctools-core":"4.0.5","org.jetbrains.kotlin:kotlin-allopen":"2.2.21","org.jetbrains.kotlin:kotlin-reflect":"2.2.21","org.jetbrains.kotlin:kotlin-stdlib-jdk8":"2.2.21","org.jetbrains.kotlinx:kotlinx-coroutines-core":"1.10.2","org.jetbrains.kotlinx:kotlinx-coroutines-debug":"1.10.2","org.jetbrains.kotlinx:kotlinx-coroutines-jdk8":"1.10.2","org.jetbrains.kotlinx:kotlinx-coroutines-reactor":"1.10.2","org.jetbrains.kotlinx:kotlinx-coroutines-rx2":"1.10.2","org.jetbrains.kotlinx:kotlinx-coroutines-test":"1.10.2","org.jooq:joor":"0.9.15","org.jsoup:jsoup":"1.21.2","org.jspecify:jspecify":"1.0.0","org.junit-pioneer:junit-pioneer":"1.9.1","org.junit.jupiter:junit-jupiter-api":"","org.junit.jupiter:junit-jupiter-engine":"","org.junit.jupiter:junit-jupiter-params":"","org.junit.platform:junit-platform-commons":"","org.junit.platform:junit-platform-launcher":"","org.junit.support:testng-engine":"1.1.0","org.junit.vintage:junit-vintage-engine":"","org.junit:junit-bom":"5.14.1","org.mockito:mockito-core":"4.11.0","org.mockito:mockito-junit-jupiter":"4.11.0","org.opensaml:opensaml-core":"3.4.6","org.opensaml:opensaml-messaging-api":"3.4.6","org.opensaml:opensaml-messaging-impl":"3.4.6","org.opensaml:opensaml-saml-api":"3.4.6","org.opensaml:opensaml-saml-impl":"3.4.6","org.opensaml:opensaml-soap-api":"3.4.6","org.opensaml:opensaml-soap-impl":"3.4.6","org.ow2.asm:asm":"9.9","org.reactivestreams:reactive-streams":"1.0.4","org.reactivestreams:reactive-streams-tck":"1.0.4","org.reflections:reflections":"0.9.11","org.sangria-graphql:sangria-slowlog_2.12":"3.0.0","org.sangria-graphql:sangria-slowlog_2.13":"3.0.0","org.sangria-graphql:sangria_2.12":"4.2.15","org.sangria-graphql:sangria_2.13":"4.2.15","org.scala-lang.modules:scala-collection-compat_2.12":"2.14.0","org.scala-lang.modules:scala-java8-compat_2.12":"1.0.2","org.scala-lang.modules:scala-java8-compat_2.13":"1.0.2","org.scala-lang.modules:scala-java8-compat_3":"1.0.2","org.scala-lang:scala-library":"2.13.18","org.scala-lang:scala3-library_3":"3.7.4","org.scalameta:munit_2.12":"1.2.1","org.scalameta:munit_2.13":"1.2.1","org.scalameta:munit_3":"1.2.1","org.slf4j:jcl-over-slf4j":"1.7.36","org.slf4j:jul-to-slf4j":"1.7.36","org.slf4j:log4j-over-slf4j":"1.7.36","org.slf4j:slf4j-api":"2.0.17","org.slf4j:slf4j-simple":"1.7.36","org.springframework.boot:spring-boot-actuator-autoconfigure":"4.0.0","org.springframework.boot:spring-boot-autoconfigure":"4.0.0","org.springframework.boot:spring-boot-configuration-processor":"4.0.0","org.springframework.boot:spring-boot-health":"4.0.0","org.springframework.boot:spring-boot-jetty":"4.0.0","org.springframework.boot:spring-boot-micrometer-metrics-test":"4.0.0","org.springframework.boot:spring-boot-micrometer-observation":"4.0.0","org.springframework.boot:spring-boot-starter":"4.0.0","org.springframework.boot:spring-boot-starter-actuator":"4.0.0","org.springframework.boot:spring-boot-starter-jetty":"4.0.0","org.springframework.boot:spring-boot-starter-security":"4.0.0","org.springframework.boot:spring-boot-starter-test":"4.0.0","org.springframework.boot:spring-boot-starter-web":"3.5.8","org.springframework.boot:spring-boot-starter-webflux":"4.0.0","org.springframework.boot:spring-boot-starter-webmvc":"4.0.0","org.springframework.boot:spring-boot-tomcat":"4.0.0","org.springframework.boot:spring-boot-validation":"4.0.0","org.springframework.boot:spring-boot-web-server":"4.0.0","org.springframework.boot:spring-boot-webclient":"4.0.0","org.springframework.boot:spring-boot-webflux-test":"4.0.0","org.springframework.boot:spring-boot-webmvc-test":"4.0.0","org.springframework:spring-aspects":"7.0.1","org.springframework:spring-context":"7.0.1","org.springframework:spring-test":"7.0.1","org.springframework:spring-web":"7.0.1","org.springframework:spring-webflux":"7.0.1","org.testcontainers:consul":"","org.testcontainers:junit-jupiter":"","org.testcontainers:testcontainers":"","org.testcontainers:testcontainers-bom":"1.21.3","org.xerial.snappy:snappy-java":"1.1.10.8","xml-apis:xml-apis":"1.4.01"}')},28453:(e,o,r)=>{r.d(o,{R:()=>i,x:()=>s});var a=r(96540);const t={},n=a.createContext(t);function i(e){const o=a.useContext(n);return a.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function s(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(n.Provider,{value:o},e.children)}},75132:(e,o,r)=>{r.r(o),r.d(o,{assets:()=>l,contentTitle:()=>c,default:()=>m,frontMatter:()=>s,metadata:()=>a,toc:()=>p});const a=JSON.parse('{"id":"advanced/scalapb","title":"ScalaPB integration","description":"Visit here to find a fully working example.","source":"@site/src/content/docs/advanced/scalapb.mdx","sourceDirName":"advanced","slug":"/advanced/scalapb","permalink":"/docs/advanced/scalapb","draft":false,"unlisted":false,"editUrl":"https://github.com/line/armeria/edit/main/site/src/content/docs/advanced/scalapb.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Scala integration","permalink":"/docs/advanced/scala"},"next":{"title":"Configuring global flags","permalink":"/docs/advanced/flags-provider"}}');var t=r(74848),n=r(28453),i=r(12793);const s={},c="ScalaPB integration",l={},p=[{value:"Running a gRPC service",id:"running-a-grpc-service",level:2},{value:"Calling a gRPC service",id:"calling-a-grpc-service",level:2},{value:"Supporting ScalaPB in annotated services.",id:"supporting-scalapb-in-annotated-services",level:2},{value:"Converting an HTTP request to a ScalaPB&#39;s <code>GeneratedMesage</code>",id:"converting-an-http-request-to-a-scalapbs-generatedmesage",level:3},{value:"Returning a ScalaPB&#39;s <code>GeneratedMesage</code>",id:"returning-a-scalapbs-generatedmesage",level:3},{value:"Injecting an ExecutionContext to an annotated service method",id:"injecting-an-executioncontext-to-an-annotated-service-method",level:3}];function g(e){const o={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components},{CodeBlock:r}=o;return r||function(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("CodeBlock",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.header,{children:(0,t.jsx)(o.h1,{id:"scalapb-integration",children:"ScalaPB integration"})}),"\n",(0,t.jsx)(o.admonition,{type:"tip",children:(0,t.jsxs)(o.p,{children:["Visit ",(0,t.jsx)(o.a,{href:"https://github.com/line/armeria/tree/main/examples/grpc-scala",children:"here"})," to find a fully working example."]})}),"\n",(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.a,{href:"https://scalapb.github.io/",children:"ScalaPB"})," is a protocol buffer compiler (protoc) plugin for\n",(0,t.jsx)(o.a,{href:"https://www.scala-lang.org/",children:"Scala"}),". It will generate Scala case classes, parsers and serializers for\nyour ",(0,t.jsx)(o.a,{href:"https://developers.google.com/protocol-buffers",children:"protocol buffers"}),".\nScalaPB also supports a thin wrapper around ",(0,t.jsx)(o.a,{href:"https://grpc.io/docs/languages/java/quickstart/",children:"grpc-java"}),",\nand provides you with an interface that is based on Scala's standard library\n",(0,t.jsx)(o.a,{href:"https://docs.scala-lang.org/overviews/core/futures.html",children:"Future"}),",\nwhile streaming is based on the Observer pattern.\nIf you integrate ScalaPB with Armeria, you can leverage the followings:"]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["Using both ",(0,t.jsx)(o.a,{href:"https://armeria.dev/docs/server-docservice",children:"gRPC server"})," and\n",(0,t.jsx)(o.a,{href:"https://armeria.dev/docs/client-grpc",children:"gRPC client"})," features such as gRPC-over-HTTP/1 and\n",(0,t.jsx)(o.a,{href:"gRPC-Web",children:"gRPC-Web"})," protocol powered by Armeria"]}),"\n",(0,t.jsx)(o.li,{children:"Browsing the list of available RPC operations and invoking a service operation via a web console"}),"\n",(0,t.jsxs)(o.li,{children:["Converting either a Protocol Buffers or JSON to and from an\n",(0,t.jsx)(o.a,{href:"https://scalapb.github.io/docs/generated-code",children:"scalapb.GeneratedMessage"})," in annotated service"]}),"\n"]}),"\n",(0,t.jsxs)(o.p,{children:["First, you need the ",(0,t.jsx)(o.code,{children:"armeria-scalapb_2.12"})," or ",(0,t.jsx)(o.code,{children:"armeria-scalapb_2.13"})," dependency to use the above features:"]}),"\n",(0,t.jsx)(r,{language:"groovy",filename:"build.sbt",children:`\nlibraryDependencies += "com.linecorp.armeria" %% "armeria-scalapb" % "${i["com.linecorp.armeria:armeria-bom"]}"\n`}),"\n",(0,t.jsx)(o.admonition,{type:"tip",children:(0,t.jsxs)(o.p,{children:[(0,t.jsx)(o.code,{children:"armeria-scalapb"})," is only available for Scala 2.12.x and 2.13.x."]})}),"\n",(0,t.jsx)(o.h2,{id:"running-a-grpc-service",children:"Running a gRPC service"}),"\n",(0,t.jsxs)(o.p,{children:["You need to register a ScalaPB gRPC stub to a ",(0,t.jsx)(o.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/grpc/GrpcService.html",children:"GrpcService"})," using a ",(0,t.jsx)(o.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/grpc/GrpcServiceBuilder.html",children:"GrpcServiceBuilder"}),"\nand add it to the ",(0,t.jsx)(o.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/ServerBuilder.html",children:"ServerBuilder"}),":"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-scala",children:'import com.linecorp.armeria.common.scalapb.ScalaPbJsonMarshaller\nimport com.linecorp.armeria.server.Server\nimport com.linecorp.armeria.server.docs.DocService\nimport com.linecorp.armeria.server.grpc.GrpcService\n\n// Creates GrpcService with your gRPC stub generated by ScalaPB.\nval grpcService =\n      GrpcService\n        .builder()\n        // Add your ScalaPB gRPC stub using `bindService()`\n        .addService(YourServiceGrpc.bindService(\n          new YourServiceImpl, ExecutionContext.global))\n        // Register `ScalaPbJsonMarshaller` for supporting gRPC JSON format.\n        .jsonMarshallerFactory(_ => ScalaPbJsonMarshaller())\n        .enableUnframedRequests(true)\n        .build()\n\n// Creates Armeria Server for ScalaPB gRPC stub.\nServer.builder()\n      .http(httpPort)\n      .https(httpsPort)\n      .service(grpcService)\n      // Add DocService for browsing the list of gRPC services and\n      // invoking a service operation from a web form.\n      // See https://armeria.dev/docs/server-docservice for more information.\n      .serviceUnder("/docs", new DocService())\n      .build()\n'})}),"\n",(0,t.jsxs)(o.p,{children:["Please see ",(0,t.jsx)(o.a,{href:"https://armeria.dev/docs/server-grpc",children:"gRPC service"})," for more information."]}),"\n",(0,t.jsx)(o.h2,{id:"calling-a-grpc-service",children:"Calling a gRPC service"}),"\n",(0,t.jsxs)(o.p,{children:["You can also call a gRPC service using a ScalaPB gRPC client.\n",(0,t.jsx)(o.code,{children:"ScalaPbJsonMarshaller"})," should be registered with ",(0,t.jsx)(o.a,{href:"type://https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/client/grpc/GrpcClientBuilder.html#jsonMarshallerFactory(java.util.function.Function)",children:"GrpcClientBuilder#jsonMarshallerFactory(Function)"})," to\nsupport gRPC JSON serialization format."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-scala",children:'import com.linecorp.armeria.client.grpc.GrpcClients\nimport com.linecorp.armeria.common.grpc.GrpcSerializationFormats\nimport com.linecorp.armeria.common.scalapb.ScalaPbJsonMarshaller\n\nval client =\n  GrpcClients.builder("http://127.0.0.1:8080/")\n             .serializationFormat(GrpcSerializationFormats.JSON)\n             // Register \'ScalaPbJsonMarshaller\' for enabling gRPC JSON serialization format\n             .jsonMarshallerFactory(_ => ScalaPbJsonMarshaller())\n             .build(classOf[HelloServiceBlockingStub])\n\nval request = HelloRequest("Armerian World")\nval reply = helloService.hello(request)\nassert(reply.message == "Hello, Armerian World!")\n'})}),"\n",(0,t.jsxs)(o.p,{children:["Please see ",(0,t.jsx)(o.a,{href:"https://armeria.dev/docs/client-grpc",children:"gRPC client"})," for more information."]}),"\n",(0,t.jsx)(o.h2,{id:"supporting-scalapb-in-annotated-services",children:"Supporting ScalaPB in annotated services."}),"\n",(0,t.jsxs)(o.h3,{id:"converting-an-http-request-to-a-scalapbs-generatedmesage",children:["Converting an HTTP request to a ScalaPB's ",(0,t.jsx)(o.code,{children:"GeneratedMesage"})]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["A Protocol Buffers is automatically converted to a ",(0,t.jsx)(o.code,{children:"GeneratedMessage"})," only when\nthe content type is one of followings:","\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.code,{children:"application/probuf"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.code,{children:"application/octet-stream"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.code,{children:"application/x-protobuf"})}),"\n",(0,t.jsx)(o.li,{children:"no media type negotiated"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(o.li,{children:["A JSON is automatically converted to a ",(0,t.jsx)(o.code,{children:"GeneratedMessage"})," only when the content type\nis either ",(0,t.jsx)(o.code,{children:"application/json"})," or ends with ",(0,t.jsx)(o.code,{children:"+json"}),"."]}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:"If you have the following proto file,"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-protobuf",children:'syntax = "proto3";\npackage com.example.testing;\noption java_package = "com.example.testing";\n\nmessage SimpleRequest {\n  string payload = 1;\n  int32 size = 2;\n}\n\nmessage SimpleResponse {\n  string message = 1;\n  int32 status = 2;\n}\n'})}),"\n",(0,t.jsxs)(o.p,{children:["the ",(0,t.jsx)(o.code,{children:"SimpleRequest"})," generated by ScalaPB could be used for a parameter of your service method."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-scala",children:'import com.example.testing.SimpleRequest\nimport com.linecorp.armeria.server.annotation.{ConsumesJson, ConsumesProtobuf, Post}\n\nclass GreetingService {\n  // If a content type is not set, Protoco Buffers\' parser is used by default.\n  @Post("/no-content-type")\n  def noContentType(request: SimpleRequest): String = s"Hello, ${request.payload}!"\n\n  // Convert the Protocol Buffers in an HTTP payload into the \'SimpleRequest\'\n  @Post("/protobuf")\n  @ConsumesProtobuf\n  def consumeProtobuf(request: SimpleRequest): String = s"Hello, ${request.payload}!"\n\n  // Convert the JSON in an HTTP payload into a \'SimpleRequest\'\n  @Post("/json")\n  @ConsumesJson\n  def consumeJson(request: SimpleRequest): String = "Hello, Armeria!"\n}\n'})}),"\n",(0,t.jsxs)(o.h3,{id:"returning-a-scalapbs-generatedmesage",children:["Returning a ScalaPB's ",(0,t.jsx)(o.code,{children:"GeneratedMesage"})]}),"\n",(0,t.jsxs)(o.p,{children:["A ",(0,t.jsx)(o.code,{children:"GeneratedMesage"})," can be converted to either Protocol Buffers or JSON."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-scala",children:'import com.example.testing.SimpleResponse\nimport scala.concurrent.Future\n\nclass GreetingService {\n\n  // Convert \'SimpleResponse\' into Protocol Buffers wire format\n  @Get("/protobuf")\n  @ProducesProtobuf\n  def produceProtobuf: SimpleResponse = SimpleResponse("Hello, Armeria!")\n\n  // Convert \'SimpleResponse\' into JSON format\n  @Get("/json")\n  @ProducesJson\n  def produceJson: SimpleResponse = SimpleResponse("Hello, Armeria!")\n\n  // Convert \'SimpleResponse\' into Protocol Buffers wire format with Scala Future\n  @Get("/protobuf+async")\n  @ProducesProtobuf\n  def produceProtobufFuture: Future[SimpleResponse] =\n    Future { SimpleResponse("Hello, Armeria!") }\n}\n'})}),"\n",(0,t.jsxs)(o.p,{children:["However, a sequence of ",(0,t.jsx)(o.code,{children:"GeneratedMesage"}),"s can be only converted to JSON array because Protocol Buffers\nwire format is ",(0,t.jsx)(o.a,{href:"https://developers.google.com/protocol-buffers/docs/techniques#streaming",children:"not self-delimiting"}),".\nThe following collection types can be converted to JSON array:"]}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.code,{children:"scala.List"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.code,{children:"scala.Vector"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.code,{children:"scala.Set"})}),"\n",(0,t.jsxs)(o.li,{children:["Reactive Stream ",(0,t.jsx)(o.a,{href:"https://www.reactive-streams.org/reactive-streams-1.0.2-javadoc/org/reactivestreams/Publisher.html",children:"Publisher"})]}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.code,{children:"java.util.List"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.code,{children:"java.util.Set"})}),"\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.code,{children:"java.util.stream.Stream"})}),"\n"]}),"\n",(0,t.jsxs)(o.h3,{id:"injecting-an-executioncontext-to-an-annotated-service-method",children:["Injecting an ",(0,t.jsx)(o.a,{href:"https://www.scala-lang.org/api/current/scala/concurrent/ExecutionContext.html",children:"ExecutionContext"})," to an annotated service method"]}),"\n",(0,t.jsxs)(o.p,{children:["An ",(0,t.jsx)(o.code,{children:"ExecutionContext"})," could be automatically injected as a method parameter to execute an asynchronous service\non top of an Armeria's event loop or blocking task executor."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-scala",children:'import com.linecorp.armeria.server.ServiceRequestContext\nimport com.linecorp.armeria.server.annoation.Blocking\nimport scala.concurrent.Future\n\nclass MyAsyncService {\n  @Post("/async")\n  def asyncService(req: SimpleRequest)(implicit ec: ExecutionContext): Future[String] =\n    Future {\n      // This callback will be executed in an Armeria\'s event loop\n      assert(ServiceRequestContext.current() != null)\n      "Hello, Armeria!"\n    }\n\n  @Blocking\n  @Post("/blocking-task")\n  def blockingAsyncService(req: SimpleRequest)(implicit ec: ExecutionContext): Future[String] =\n    Future {\n      // This callback will be executed in an Armeria\'s blocking task executor\n      assert(ServiceRequestContext.current() != null)\n      // Perform a long running task\n      "Hello, Armeria!"\n    }\n  }\n}\n'})})]})}function m(e={}){const{wrapper:o}={...(0,n.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(g,{...e})}):g(e)}}}]);