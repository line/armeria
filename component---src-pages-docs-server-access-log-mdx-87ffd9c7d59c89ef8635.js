"use strict";(self.webpackChunkarmeria_site=self.webpackChunkarmeria_site||[]).push([[6044],{84385:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return i},default:function(){return c},pageTitle:function(){return s}});var n=a(63366),r=(a(67294),a(64983)),o=a(28819),p=["components"],s="Writing an access log",i={},l={pageTitle:s,_frontmatter:i},m=o.Z;function c(e){var t=e.components,a=(0,n.Z)(e,p);return(0,r.kt)(m,Object.assign({},l,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"writing-an-access-log",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h1",href:"#writing-an-access-log","aria-label":"writing an access log permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Writing an access log"),(0,r.kt)("h6",{className:"inlinePageToc",role:"navigation"},"Table of contents"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"#configuring-logging-framework"},"Configuring logging framework")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#logback"},"logback")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#log4j2"},"log4j2")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"#customizing-a-log-format"},"Customizing a log format")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#retrieving-values-from-requestlog"},"Retrieving values from RequestLog")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#customizing-timestamp-format"},"Customizing timestamp format")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"#customizing-an-access-log-writer"},"Customizing an access log writer"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"#customizing-an-access-logger"},"Customizing an access logger")))),(0,r.kt)("h2",{id:"configuring-logging-framework",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h2",href:"#configuring-logging-framework","aria-label":"configuring logging framework permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Configuring logging framework"),(0,r.kt)("p",null,"To write an access log, you need to configure a logging framework first. The following configurations are\nsimple examples of ",(0,r.kt)("inlineCode",{parentName:"p"},"logback.xml")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"log4j2.xml")," respectively."),(0,r.kt)("h3",{id:"logback",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h3",href:"#logback","aria-label":"logback permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"logback"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<configuration>\n  <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">\n    <encoder>\n      <pattern>%-4relative [%thread] %-5level %logger{35} - %msg%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="ACCESS" class="ch.qos.logback.core.rolling.RollingFileAppender">\n    <file>access.log</file>\n    <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">\n      \x3c!-- daily rollover --\x3e\n      <fileNamePattern>access.%d{yyyy-MM-dd}-%i.log</fileNamePattern>\n      \x3c!-- each file should be at most 1GB, keep 30 days worth of history, but at most 30GB --\x3e\n      <maxFileSize>1GB</maxFileSize>\n      <maxHistory>30</maxHistory>\n      <totalSizeCap>30GB</totalSizeCap>\n    </rollingPolicy>\n    <encoder>\n      <pattern>%msg%n</pattern>\n    </encoder>\n  </appender>\n\n  <logger name="com.linecorp.armeria.logging.access" level="INFO" additivity="false">\n    <appender-ref ref="ACCESS"/>\n  </logger>\n\n  <root level="DEBUG">\n    <appender-ref ref="CONSOLE"/>\n  </root>\n</configuration>\n')),(0,r.kt)("h3",{id:"log4j2",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h3",href:"#log4j2","aria-label":"log4j2 permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"log4j2"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<Configuration status="WARN">\n  <Appenders>\n    <Console name="CONSOLE" target="SYSTEM_OUT">\n      <PatternLayout pattern="%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"/>\n    </Console>\n    <RollingFile name="ACCESS" fileName="access.log"\n                 filePattern="access.%d{MM-dd-yyyy}-%i.log.gz">\n      <PatternLayout>\n        <Pattern>%m%n</Pattern>\n      </PatternLayout>\n\n      <Policies>\n        \x3c!-- daily rollover --\x3e\n        <TimeBasedTriggeringPolicy/>\n        \x3c!-- each file should be at most 1GB --\x3e\n        <SizeBasedTriggeringPolicy size="1GB"/>\n      </Policies>\n      \x3c!-- keep 30 archives --\x3e\n      <DefaultRolloverStrategy max="30"/>\n    </RollingFile>\n  </Appenders>\n\n  <Loggers>\n    <Logger name="com.linecorp.armeria.logging.access" level="INFO" additivity="false">\n      <AppenderRef ref="ACCESS"/>\n    </Logger>\n    <Root level="DEBUG">\n      <AppenderRef ref="CONSOLE"/>\n    </Root>\n  </Loggers>\n</Configuration>\n')),(0,r.kt)("h2",{id:"customizing-a-log-format",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h2",href:"#customizing-a-log-format","aria-label":"customizing a log format permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Customizing a log format"),(0,r.kt)("p",null,"Access logging is disabled by default. If you want to enable it, you need to specify an ",(0,r.kt)("a",{parentName:"p",href:"type://AccessLogWriter:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/logging/AccessLogWriter.html"},"type://AccessLogWriter"),".\nYou may use one of the pre-defined log formats."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'import com.linecorp.armeria.server.ServerBuilder;\nimport com.linecorp.armeria.server.logging.AccessLogWriter;\n\nServerBuilder sb = Server.builder();\n// Use NCSA common log format.\nsb.accessLogWriter(AccessLogWriter.common(), true);\n// Use NCSA combined log format.\nsb.accessLogWriter(AccessLogWriter.combined(), true);\n// Use your own log format.\nsb.accessLogFormat("...log format...");\n...\n')),(0,r.kt)("p",null,"You can have different ",(0,r.kt)("a",{parentName:"p",href:"typeplural://AccessLogWriter:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/logging/AccessLogWriter.html"},"typeplural://AccessLogWriter")," for ",(0,r.kt)("a",{parentName:"p",href:"typeplural://VirtualHost:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/VirtualHost.html"},"typeplural://VirtualHost")," and ",(0,r.kt)("a",{parentName:"p",href:"typeplural://Service:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/Service.html"},"typeplural://Service"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'ServerBuilder sb = Server.builder();\nAccessLogWriter fallbackLogWriter = ...\nsb.accessLogWriter(fallbackLogWriter);\n\nsb.virtualHost("foo.com")\n  .accessLogWriter(AccessLogWriter.combined(), true)\n  .service((ctx, req) -> HttpResponse.of(OK)); // This service will log using the combined format.\n  ...\n\nsb.route()\n  .get("/commonAccessLog")\n  .accessLogWriter(AccessLogWriter.common(), true)\n  .build((ctx, req) -> HttpResponse.of(OK)); // This service will log using the common format.\n\n// This service will log using the fallbackLogWriter.\nsb.service("/fallbackLogWriter", (ctx, req) -> HttpResponse.of(OK));\n')),(0,r.kt)("p",null,"Pre-defined log formats are as follows."),(0,r.kt)("p",null,"Tokens for the log format are listed in the following table."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("div",{style:{width:"12rem"}},"Tokens")),(0,r.kt)("th",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"th"},"Condition support")),(0,r.kt)("th",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"th"},"Description")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%A"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"No")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the local IP address"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%a"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"No")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the IP address of the client who initiated a\nrequest. Use ",(0,r.kt)("inlineCode",{parentName:"p"},"%{c}a")," format string to get the\nremote IP address where the channel is connected\nto, which may yield a different value when there\nis an intermediary proxy server.\nThis value relies on the ",(0,r.kt)("inlineCode",{parentName:"p"},"clientAddress()")," and\n",(0,r.kt)("inlineCode",{parentName:"p"},"remoteAddress()")," methods of\n",(0,r.kt)("a",{parentName:"p",href:"type://ServiceRequestContext:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/ServiceRequestContext.html"},"type://ServiceRequestContext"),", please refer to\n",(0,r.kt)("a",{parentName:"p",href:"/docs/server-basics#getting-an-ip-address-of-a-client-who-initiated-a-request"},"Getting an IP address of a client who initiated a request"),"\nabout how to configure the\n",(0,r.kt)("a",{parentName:"p",href:"type://ServerBuilder:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/ServerBuilder.html"},"type://ServerBuilder")," to get the client address\nyou interest."))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%h"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"No")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the remote hostname or IP address if DNS\nhostname lookup is not available"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%I"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"No")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the request ID. Use ",(0,r.kt)("inlineCode",{parentName:"p"},"%{short}I")," format string to\nget the short form."))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%l"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"No")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the remote logname of the user\n(not supported yet, always write ",(0,r.kt)("inlineCode",{parentName:"p"},"-"),")"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%u"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"No")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the name of the authenticated remote user\n(not supported yet, always write ",(0,r.kt)("inlineCode",{parentName:"p"},"-"),")"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%t"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"No")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the date, time and time zone that the request\nwas received, by default in ",(0,r.kt)("inlineCode",{parentName:"p"},"strftime")," format\n%d/%b/%Y:%H:%M:%S %z.\n(for example, ",(0,r.kt)("inlineCode",{parentName:"p"},"10/Oct/2000:13:55:36 -0700"),")\nRefer to\n","[Customizing timestamp format][#customizing-timestamp-format]","\nfor more information."))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%r"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the request line from the client\n(for example, ",(0,r.kt)("inlineCode",{parentName:"p"},"GET /path h2"),")"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%s"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"No")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the HTTP status code returned to the client"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%b"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the size of the object returned to the client,\nmeasured in bytes"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%{HEADER_NAME}i"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the value of the specified HTTP request header\nname"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%{HEADER_NAME}o"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the value of the specified HTTP response header\nname"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%{ATTRIBUTE_NAME}j"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the value of the specified attribute name"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%{REQUEST_LOG_NAME}L"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the value of the specified variable of the\n",(0,r.kt)("a",{parentName:"p",href:"type://RequestLog:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RequestLog.html"},"type://RequestLog"),". Refer to\n",(0,r.kt)("a",{parentName:"p",href:"#retrieving-values-from-requestlog"},"Retrieving values from RequestLog"),"\nfor more information."))))),(0,r.kt)("p",null,"Some tokens can have a condition of the response status code and the log message can be omitted with\nthe condition."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("div",{style:{width:"25rem"}},"Example of a condition")),(0,r.kt)("th",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"th"},"Description")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%200b"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Write the size of the object returned to the\nclient only if the response code is ",(0,r.kt)("inlineCode",{parentName:"p"},"200"),"."))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%200,304{User-Agent}i"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Write ",(0,r.kt)("inlineCode",{parentName:"p"},"User-Agent")," header value only if the\nresponse code is ",(0,r.kt)("inlineCode",{parentName:"p"},"200")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"304"),"."))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"%!200,304{com.example.armeria.Attribute#KEY}j"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Write the value of the specified attribute\nonly if the response code is neither ",(0,r.kt)("inlineCode",{parentName:"p"},"200"),"\nnor ",(0,r.kt)("inlineCode",{parentName:"p"},"304"),"."))))),(0,r.kt)("h3",{id:"retrieving-values-from-requestlog",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h3",href:"#retrieving-values-from-requestlog","aria-label":"retrieving values from requestlog permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Retrieving values from ",(0,r.kt)("inlineCode",{parentName:"h3"},"RequestLog")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"type://RequestLog:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RequestLog.html"},"type://RequestLog")," holds information about the request, so a user may want to write these values to his or\nher access log file. To write them in a simple way, ",(0,r.kt)("inlineCode",{parentName:"p"},"%{variable}L")," token is provided with the following\nsupported variable:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("div",{style:{width:"13rem"}},"Name")),(0,r.kt)("th",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"th"},"Description")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"method"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the HTTP method value of the request"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"path"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the absolute path part of the HTTP request URI"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"query"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the query part of the HTTP request URI"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"requestStartTimeMillis"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the time when the processing of the request started,\nin milliseconds since the epoch"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"requestDurationMillis"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the duration that was taken to consume or produce the request\ncompletely, in milliseconds"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"requestDurationNanos"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the duration that was taken to consume or produce the request\ncompletely, in nanoseconds"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"requestLength"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the length of the request content"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"requestCause"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the cause of request processing failure. The class name of the\ncause and the detail message of it will be contained if exists."))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"requestContentPreview"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the preview of the request content"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"responseStartTimeMillis"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the time when the processing of the response started,\nin milliseconds since the epoch"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"responseDurationMillis"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the duration that was taken to consume or produce the response\ncompletely, in milliseconds"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"responseDurationNanos"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the duration that was taken to consume or produce the response\ncompletely, in nanoseconds"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"responseLength"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the length of the response content"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"responseCause"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the cause of response processing failure. The class name of the\ncause and the detail message of it will be contained if exists."))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"responseContentPreview"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the preview of the response content"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"totalDurationMillis"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the amount of time taken since the request processing started and\nuntil the response processing ended, in milliseconds"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"totalDurationNanos"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the amount of time taken since the request processing started and\nuntil the response processing ended, in nanoseconds"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"sessionProtocol"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the session protocol of the request.\ne.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"h1"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"h2"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"h1c")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"h2c")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"serializationFormat"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the serialization format of the request.\ne.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"tbinary"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"ttext"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"tcompact"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"tjson")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"none")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"scheme"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the scheme value printed as ",(0,r.kt)("inlineCode",{parentName:"p"},"serializationFormat+sessionProtocol")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"host"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the host name of the request"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"status"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the status code and its reason phrase of the response.\ne.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"200 OK")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"statusCode"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"the status code of the response. e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"200")))))),(0,r.kt)("h3",{id:"customizing-timestamp-format",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h3",href:"#customizing-timestamp-format","aria-label":"customizing timestamp format permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Customizing timestamp format"),(0,r.kt)("p",null,"You can specify a new date/time format for the ",(0,r.kt)("inlineCode",{parentName:"p"},"%t")," token with\n",(0,r.kt)("a",{parentName:"p",href:"https://docs.oracle.com/javase/10/docs/api/java/time/format/DateTimeFormatter.html"},"DateTimeFormatter"),".\nYou can use one of the following formatters which is provided by JDK as a variable of the ",(0,r.kt)("inlineCode",{parentName:"p"},"%t")," token,\ne.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"%{BASIC_ISO_DATE}t"),". If you want to use your own pattern, you can specify it as the variable,\ne.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"%{yyyy MM dd}t"),"."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"th"},"Formatter")),(0,r.kt)("th",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"th"},"Description")),(0,r.kt)("th",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"th"},"Example")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"BASIC_ISO_DATE"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Basic ISO date")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"20111203")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_LOCAL_DATE"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"ISO Local Date")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"2011-12-03")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_OFFSET_DATE"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"ISO Date with offset")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"2011-12-03+01:00")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_DATE"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"ISO Date with or without offset")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"2011-12-03+01:00"),"; ",(0,r.kt)("inlineCode",{parentName:"p"},"2011-12-03")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_LOCAL_TIME"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Time without offset")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"10:15:30")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_OFFSET_TIME"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Time with offset")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"10:15:30+01:00")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_TIME"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Time with or without offset")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"10:15:30+01:00"),"; ",(0,r.kt)("inlineCode",{parentName:"p"},"10:15:30")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_LOCAL_DATE_TIME"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"ISO Local Date and Time")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"2011-12-03T10:15:30")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_OFFSET_DATE_TIME"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Date Time with Offset")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"2011-12-03T10:15:30+01:00")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_ZONED_DATE_TIME"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Zoned Date Time")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"2011-12-03T10:15:30+01:00[Europe/Paris]")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_DATE_TIME"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Date and time with ZoneId")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"2011-12-03T10:15:30+01:00[Europe/Paris]")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_ORDINAL_DATE"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Year and day of year")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"2012-337")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_WEEK_DATE"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Year and Week")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"2012-W48-6")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"ISO_INSTANT"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"Date and Time of an Instant")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"2011-12-03T10:15:30Z")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"RFC_1123_DATE_TIME"))),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},"RFC 1123 / RFC 822")),(0,r.kt)("td",{parentName:"tr",colspan:1,rowspan:1},(0,r.kt)("p",{parentName:"td"},(0,r.kt)("inlineCode",{parentName:"p"},"Tue, 3 Jun 2008 11:05:30 GMT")))))),(0,r.kt)("h2",{id:"customizing-an-access-log-writer",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h2",href:"#customizing-an-access-log-writer","aria-label":"customizing an access log writer permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Customizing an access log writer"),(0,r.kt)("p",null,"You can specify your own log writer which implements a ",(0,r.kt)("inlineCode",{parentName:"p"},"Consumer")," of ",(0,r.kt)("a",{parentName:"p",href:"type://RequestLog:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/common/logging/RequestLog.html"},"type://RequestLog"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"ServerBuilder sb = Server.builder();\nsb.accessLogWriter(requestLog -> {\n    // Write your access log with the given RequestLog instance.\n    ...\n}, true);\n")),(0,r.kt)("h2",{id:"customizing-an-access-logger",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h2",href:"#customizing-an-access-logger","aria-label":"customizing an access logger permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Customizing an access logger"),(0,r.kt)("p",null,"Armeria uses an SLF4J logger whose name is based on a reversed domain name of each virtual host by\ndefault, e.g."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"com.linecorp.armeria.logging.access.com.example")," for ",(0,r.kt)("inlineCode",{parentName:"li"},"*.example.com")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"com.linecorp.armeria.logging.access.com.linecorp")," for ",(0,r.kt)("inlineCode",{parentName:"li"},"*.linecorp.com"))),(0,r.kt)("p",null,"Alternatively, you can specify your own mapper or logger for a ",(0,r.kt)("a",{parentName:"p",href:"type://VirtualHost:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/VirtualHost.html"},"type://VirtualHost"),", e.g."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'ServerBuilder sb = Server.builder();\n\n// Using the specific logger name.\nsb.accessLogger("com.example.my.access.logs");\n...\n\n// Using your own logger.\nLogger logger = LoggerFactory.getLogger("com.example2.my.access.logs");\nsb.accessLogger(Logger);\n...\n\n// Using the mapper which sets an access logger with the given VirtualHost instance.\nsb.accessLogger(virtualHost -> {\n    // Return the logger.\n    // Do not return null. Otherwise, it will raise an IllegalStateException.\n    return LoggerFactory.getLogger("com.example.my.access.logs." + virtualHost.defaultHostname());\n});\n...\n')),(0,r.kt)("p",null,"You can also specify your own logger for the specific ",(0,r.kt)("a",{parentName:"p",href:"type://VirtualHost:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/VirtualHost.html"},"type://VirtualHost"),". In this case, the mapper or logger\nyou set for a specific ",(0,r.kt)("a",{parentName:"p",href:"type://VirtualHost:https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/VirtualHost.html"},"type://VirtualHost")," will override the access logger set via\n",(0,r.kt)("a",{parentName:"p",href:"type://ServerBuilder#accessLogger(Logger):https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/com/linecorp/armeria/server/ServerBuilder.html#accessLogger(org.slf4j.Logger)"},"type://ServerBuilder#accessLogger(Logger)"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'// Using the specific logger name.\nsb.virtualHost("*.example.com")\n  .accessLogger("com.example.my.access.logs")\n  .and()\n...\n\n// Using your own logger.\nLogger logger = LoggerFactory.getLogger("com.example2.my.access.logs");\nsb.virtualHost("*.example2.com")\n  .accessLogger(Logger)\n  .and()\n...\n\n// Using the mapper which sets an access logger with the given VirtualHost instance.\nsb.virtualHost("*.example3.com")\n  .accessLogger(virtualHost -> {\n    // Return the logger.\n    // Do not return null. Otherwise, it will raise an IllegalStateException.\n    return LoggerFactory.getLogger("com.example.my.access.logs." + virtualHost.defaultHostname());\n  })\n...\n')))}c.isMDXComponent=!0},28819:function(e,t,a){a.d(t,{Z:function(){return s}});var n=a(25444),r=a(67294),o=JSON.parse('{"root":["index","setup"],"Useful links":{"Tutorials":"/tutorials","Community articles":"/community/articles","API documentation":"https://javadoc.io/doc/com.linecorp.armeria/armeria-javadoc/latest/index.html","Release notes":"/release-notes"},"Server":["server-basics","server-decorator","server-grpc","server-thrift","server-graphql","server-docservice","server-annotated-service","server-http-file","server-servlet","server-access-log","server-cors","server-sse","server-service-registration","server-multipart"],"Client":["client-http","client-thrift","client-grpc","client-factory","client-decorator","client-retrofit","client-custom-http-headers","client-timeouts","client-retry","client-circuit-breaker","client-service-discovery"],"Advanced":["advanced-logging","advanced-structured-logging","advanced-custom-attributes","advanced-streaming-backpressure","advanced-structured-logging-kafka","advanced-metrics","advanced-unit-testing","advanced-production-checklist","advanced-zipkin","advanced-saml","advanced-spring-webflux-integration","advanced-dropwizard-integration","advanced-scala","advanced-scalapb","advanced-client-interoperability"]}'),p=a(46731),s=function(e){var t=(0,n.useStaticQuery)("1217743243").allMdx.nodes;return r.createElement(p.Z,Object.assign({},e,{candidateMdxNodes:t,index:o,prefix:"docs",pageTitleSuffix:"Armeria documentation"}))}}}]);
//# sourceMappingURL=component---src-pages-docs-server-access-log-mdx-87ffd9c7d59c89ef8635.js.map